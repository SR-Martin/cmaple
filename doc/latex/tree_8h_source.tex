\doxysection{tree.\+h}
\hypertarget{tree_8h_source}{}\label{tree_8h_source}\index{tree/tree.h@{tree/tree.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ "{}../alignment/alignment.h"{}}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#include\ "{}../model/model.h"{}}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}updatingnode.h"{}}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#ifdef\ \_OPENMP}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <omp.h>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{namespace\ }cmaple\ \{}
\DoxyCodeLine{00012\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}\ \{}
\DoxyCodeLine{00013\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00017\ \ \ \textcolor{keyword}{enum}\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}}\ \{}
\DoxyCodeLine{00018\ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43a782a94a0336018d3a43f5e71e76e0bc6}{FAST\_TREE\_SEARCH}},\ \ \ }
\DoxyCodeLine{00019\ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43ad597e07c0182b56b0bc3d67b8fdaf0c1}{NORMAL\_TREE\_SEARCH}},\ }
\DoxyCodeLine{00021\ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43af65759e421e111ae8b476ab74b390ff8}{ACCURATE\_TREE\_SEARCH}},\ }
\DoxyCodeLine{00022\ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43a5c358c56b2d42131093b6b5386d1d8f5}{UNKNOWN\_TREE\_SEARCH}},\ \ \ \ \ \ \ }
\DoxyCodeLine{00023\ \ \ \};}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00028\ \ \ \textcolor{keyword}{enum}\ \mbox{\hyperlink{classcmaple_1_1_tree_a750c5e7c53559fbcc421020bad665376}{TreeType}}\ \{}
\DoxyCodeLine{00029\ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_a750c5e7c53559fbcc421020bad665376aed3efab1c9a9364074e767a772c132da}{BIN\_TREE}},\ \ \ \ \ }
\DoxyCodeLine{00030\ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_a750c5e7c53559fbcc421020bad665376a0156cc734ae126b57d1a6ceeb22bd9e9}{MUL\_TREE}},\ \ \ \ \ }
\DoxyCodeLine{00031\ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_a750c5e7c53559fbcc421020bad665376af211a6a48af98121a51064677ec6d851}{UNKNOWN\_TREE}},\ }
\DoxyCodeLine{00032\ \ \ \};}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ BEGIN\ OF\ PUBLIC\ APIs\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00035\ \ \ \textcolor{comment}{//\ //}}
\DoxyCodeLine{00061\ \textcolor{comment}{}\ \ \mbox{\hyperlink{classcmaple_1_1_tree_ac8b9c0385a290c3d535434ae843338ce}{Tree}}(\mbox{\hyperlink{classcmaple_1_1_alignment}{Alignment}}*\ aln,}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_model}{Model}}*\ model,}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ std::istream\&\ tree\_stream,}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ fixed\_blengths\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ std::unique\_ptr<cmaple::Params>\&\&\ params\ =\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00094\ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_af71b78fbf62c78e5630ac76f3fc319dc}{Tree}}(\mbox{\hyperlink{classcmaple_1_1_alignment}{Alignment}}*\ aln,}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_model}{Model}}*\ model,}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ tree\_filename\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ fixed\_blengths\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ std::unique\_ptr<cmaple::Params>\&\&\ params\ =\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00102\ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_ae05ee284fd0e9edba07708ec914eb045}{\string~Tree}}();}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00119\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcmaple_1_1_tree_af8c288e5a4ae4277615cb24268dca2f2}{load}}(std::istream\&\ tree\_stream,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ fixed\_blengths\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00137\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcmaple_1_1_tree_a1b2479eb26d00469ee1040dd9bee18e5}{load}}(\textcolor{keyword}{const}\ std::string\&\ tree\_filename,}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ fixed\_blengths\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00148\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcmaple_1_1_tree_ab932b3742c6e18d51554f72432c18151}{changeAln}}(\mbox{\hyperlink{classcmaple_1_1_alignment}{Alignment}}*\ aln);}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00157\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcmaple_1_1_tree_aa4f982f45f38226193cd584bbe7e93ef}{changeModel}}(\mbox{\hyperlink{classcmaple_1_1_model}{Model}}*\ model);}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00172\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcmaple_1_1_tree_a072d5393798650a838dc7f4b067f7232}{doPlacement}}(std::ostream\&\ out\_stream\ =\ std::cout);}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00184\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcmaple_1_1_tree_a2c9dfd1f20162021c5431ebe29d57ef8}{applySPR}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}}\ tree\_search\_type,}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ shallow\_tree\_search,\ std::ostream\&\ out\_stream\ =\ std::cout);}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00194\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcmaple_1_1_tree_afc947148cb44b753d7799b4df5fa83f8}{optimizeBranch}}(std::ostream\&\ out\_stream\ =\ std::cout);}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00224\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcmaple_1_1_tree_aaf42c58dd4db66c040386df9053f8ba9}{autoProceedMAPLE}}(}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}}\ tree\_search\_type\ =\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43ad597e07c0182b56b0bc3d67b8fdaf0c1}{NORMAL\_TREE\_SEARCH}},}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ shallow\_tree\_search\ =\ \textcolor{keyword}{false},\ std::ostream\&\ out\_stream\ =\ std::cout);}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00236\ \ \ RealNumType\ \mbox{\hyperlink{classcmaple_1_1_tree_a987c92b41faa1303b5b0c8393c0704db}{computeLh}}();}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00260\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcmaple_1_1_tree_a415d4e23f522c7ecb1f8363e27f6bafa}{computeBranchSupport}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_threads\ =\ 1,}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_replicates\ =\ 1000,}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ epsilon\ =\ 0.1,}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ allow\_replacing\_ML\_tree\ =\ \textcolor{keyword}{true},}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::ostream\&\ out\_stream\ =\ std::cout);}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00277\ \ \ std::string\ \mbox{\hyperlink{classcmaple_1_1_tree_a8d1492f8a3291bd70af3a879b535f880}{exportNewick}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classcmaple_1_1_tree_a750c5e7c53559fbcc421020bad665376}{TreeType}}\ tree\_type\ =\ \mbox{\hyperlink{classcmaple_1_1_tree_a750c5e7c53559fbcc421020bad665376aed3efab1c9a9364074e767a772c132da}{BIN\_TREE}},}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ show\_branch\_supports\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ END\ OF\ PUBLIC\ APIs\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00281\ \ \ \textcolor{comment}{//\ //}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00287\ \ \ \textcolor{keywordtype}{bool}\ fixed\_blengths\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00292\ \ \ cmaple::RealNumType\ default\_blength,\ min\_blength,\ max\_blength,}
\DoxyCodeLine{00293\ \ \ \ \ \ \ min\_blength\_mid,\ min\_blength\_sensitivity,\ half\_max\_blength,}
\DoxyCodeLine{00294\ \ \ \ \ \ \ half\_min\_blength\_mid,\ double\_min\_blength;}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00299\ \ \ \textcolor{comment}{//\ std::optional<cmaple::Params>\ params;}}
\DoxyCodeLine{00300\ \ \ std::unique\_ptr<cmaple::Params>\ params\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00305\ \ \ \mbox{\hyperlink{classcmaple_1_1_alignment}{Alignment}}*\ aln\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00310\ \ \ \mbox{\hyperlink{classcmaple_1_1_model_base}{ModelBase}}*\ model\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00315\ \ \ cmaple::RealNumType*\ cumulative\_rate\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00320\ \ \ std::vector<std::vector<cmaple::PositionType>>\ cumulative\_base;}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00325\ \ \ std::vector<PhyloNode>\ nodes;}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00330\ \ \ std::vector<NodeLh>\ node\_lhs;}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00335\ \ \ cmaple::NumSeqsType\ root\_vector\_index;}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00342\ \ \ std::vector<std::string>\ seq\_names;}
\DoxyCodeLine{00343\ }
\DoxyCodeLine{00348\ \ \ std::vector<bool>\ sequence\_added;}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00357\ \ \ \textcolor{keywordtype}{void}\ makeTreeInOutConsistent();}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00364\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}}\ parseTreeSearchType(}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ tree\_search\_type);}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00372\ \ \ \textcolor{keyword}{static}\ std::string\ getTreeSearchStr(\textcolor{keyword}{const}\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}}\ tree\_search\_type);}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00379\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classcmaple_1_1_tree_a750c5e7c53559fbcc421020bad665376}{TreeType}}\ parseTreeType(\textcolor{keyword}{const}\ std::string\&\ tree\_type\_str);}
\DoxyCodeLine{00380\ \ \ \ \ }
\DoxyCodeLine{00383\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00387\ \ \ \textcolor{keyword}{typedef}\ void\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*LoadTreePtrType)(std::istream\&,\ const\ bool);}
\DoxyCodeLine{00388\ \ \ LoadTreePtrType\ loadTreePtr;}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00393\ \ \ \textcolor{keyword}{typedef}\ void\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*ChangeModelPtrType)(\mbox{\hyperlink{classcmaple_1_1_model}{Model}}*);}
\DoxyCodeLine{00394\ \ \ ChangeModelPtrType\ changeModelPtr;}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00399\ \ \ \textcolor{keyword}{typedef}\ void\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*ChangeAlnPtrType)(\mbox{\hyperlink{classcmaple_1_1_alignment}{Alignment}}*);}
\DoxyCodeLine{00400\ \ \ ChangeAlnPtrType\ changeAlnPtr;}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00405\ \ \ \textcolor{keyword}{typedef}\ void\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*DoInferencePtrType)(const\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}},}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ bool,\ std::ostream\&);}
\DoxyCodeLine{00407\ \ \ DoInferencePtrType\ doInferencePtr;}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00412\ \ \ \textcolor{keyword}{typedef}\ void\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*DoPlacementPtrType)(std::ostream\&);}
\DoxyCodeLine{00413\ \ \ DoPlacementPtrType\ doPlacementPtr;}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00418\ \ \ \textcolor{keyword}{typedef}\ void\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*ApplySPRPtrType)(const\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}},}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ bool,\ std::ostream\&);}
\DoxyCodeLine{00420\ \ \ ApplySPRPtrType\ applySPRPtr;}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00425\ \ \ \textcolor{keyword}{typedef}\ void\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*OptimizeBranchPtrType)(std::ostream\&);}
\DoxyCodeLine{00426\ \ \ OptimizeBranchPtrType\ optimizeBranchPtr;}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00431\ \ \ \textcolor{keyword}{typedef}\ RealNumType\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*computeLhPtrType)();}
\DoxyCodeLine{00432\ \ \ computeLhPtrType\ computeLhPtr;}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00437\ \ \ \textcolor{keyword}{typedef}\ void\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*computeBranchSupportPtrType)(const\ int,}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ int,}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ double,}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ bool,\ std::ostream\&);}
\DoxyCodeLine{00441\ \ \ computeBranchSupportPtrType\ computeBranchSupportPtr;}
\DoxyCodeLine{00442\ }
\DoxyCodeLine{00443\ \ \ \textcolor{keyword}{typedef}\ void\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*MakeTreeInOutConsistentPtrType)();}
\DoxyCodeLine{00444\ \ \ MakeTreeInOutConsistentPtrType\ makeTreeInOutConsistentPtr;}
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00451\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00452\ \ \ \textcolor{keywordtype}{void}\ loadTreeTemplate(std::istream\&\ tree\_stream,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ fixed\_blengths);}
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00456\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00457\ \ \ \textcolor{keywordtype}{void}\ changeAlnTemplate(\mbox{\hyperlink{classcmaple_1_1_alignment}{Alignment}}*\ aln);}
\DoxyCodeLine{00458\ }
\DoxyCodeLine{00461\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00462\ \ \ \textcolor{keywordtype}{void}\ changeModelTemplate(\mbox{\hyperlink{classcmaple_1_1_model}{Model}}*\ model);}
\DoxyCodeLine{00463\ }
\DoxyCodeLine{00466\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00467\ \ \ \textcolor{keywordtype}{void}\ doInferenceTemplate(\textcolor{keyword}{const}\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}}\ tree\_search\_type,}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ shallow\_tree\_search,\ std::ostream\&\ out\_stream);}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00472\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00473\ \ \ \textcolor{keywordtype}{void}\ doPlacementTemplate(std::ostream\&\ out\_stream);}
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00477\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00478\ \ \ \textcolor{keywordtype}{void}\ applySPRTemplate(\textcolor{keyword}{const}\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}}\ tree\_search\_type,}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ shallow\_tree\_search,\ std::ostream\&\ out\_stream);}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00483\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00484\ \ \ \textcolor{keywordtype}{void}\ optimizeBranchTemplate(std::ostream\&\ out\_stream);}
\DoxyCodeLine{00485\ }
\DoxyCodeLine{00488\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00489\ \ \ RealNumType\ computeLhTemplate();}
\DoxyCodeLine{00490\ }
\DoxyCodeLine{00493\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00494\ \ \ \textcolor{keywordtype}{void}\ computeBranchSupportTemplate(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_threads,}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_replicates,}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ epsilon,}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ allow\_replacing\_ML\_tree,}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::ostream\&\ out\_stream);}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00502\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00503\ \ \ \textcolor{keywordtype}{void}\ makeTreeInOutConsistentTemplate();}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00509\ \ \ \textcolor{keywordtype}{void}\ setupFuncPtrs();}
\DoxyCodeLine{00510\ }
\DoxyCodeLine{00514\ \ \ \textcolor{keywordtype}{void}\ setupBlengthThresh();}
\DoxyCodeLine{00515\ }
\DoxyCodeLine{00528\ \ \ \textcolor{keywordtype}{void}\ initTree(\mbox{\hyperlink{classcmaple_1_1_alignment}{Alignment}}*\ aln,}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_model}{Model}}*\ model,}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<cmaple::Params>\&\&\ params);}
\DoxyCodeLine{00531\ }
\DoxyCodeLine{00536\ \ \ \textcolor{keywordtype}{void}\ computeCumulativeRate();}
\DoxyCodeLine{00537\ }
\DoxyCodeLine{00542\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00543\ \ \ \textcolor{keywordtype}{void}\ optimizeTreeTopology(\textcolor{keywordtype}{bool}\ short\_range\_search\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00544\ }
\DoxyCodeLine{00551\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00552\ \ \ \textcolor{keywordtype}{void}\ refreshAllNonLowerLhs();}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00560\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00561\ \ \ cmaple::RealNumType\ improveSubTree(\textcolor{keyword}{const}\ cmaple::Index\ index,}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ short\_range\_search);}
\DoxyCodeLine{00564\ }
\DoxyCodeLine{00569\ \ \ cmaple::RealNumType\ calculateDerivative(}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<cmaple::RealNumType>\&\ coefficient\_vec,}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ delta\_t);}
\DoxyCodeLine{00572\ }
\DoxyCodeLine{00576\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00577\ \ \ \textcolor{keywordtype}{void}\ examineSamplePlacementMidBranch(}
\DoxyCodeLine{00578\ \ \ \ \ \ \ cmaple::Index\&\ selected\_node\_index,}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ mid\_branch\_lh,}
\DoxyCodeLine{00580\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_lh\_diff,}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ is\_mid\_branch,}
\DoxyCodeLine{00582\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff\_mid\_branch,}
\DoxyCodeLine{00583\ \ \ \ \ \ \ TraversingNode\&\ current\_extended\_node,}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample\_regions);}
\DoxyCodeLine{00585\ }
\DoxyCodeLine{00589\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00590\ \ \ \textcolor{keywordtype}{void}\ examineSamplePlacementAtNode(}
\DoxyCodeLine{00591\ \ \ \ \ \ \ cmaple::Index\&\ selected\_node\_index,}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ total\_lh,}
\DoxyCodeLine{00593\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_lh\_diff,}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ is\_mid\_branch,}
\DoxyCodeLine{00595\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff\_at\_node,}
\DoxyCodeLine{00596\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff\_mid\_branch,}
\DoxyCodeLine{00597\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_up\_lh\_diff,}
\DoxyCodeLine{00598\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{00599\ \ \ \ \ \ \ cmaple::Index\&\ best\_child\_index,}
\DoxyCodeLine{00600\ \ \ \ \ \ \ TraversingNode\&\ current\_extended\_node,}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample\_regions);}
\DoxyCodeLine{00602\ }
\DoxyCodeLine{00608\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00609\ \ \ \textcolor{keywordtype}{void}\ finetuneSamplePlacementAtNode(}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \textcolor{keyword}{const}\ PhyloNode\&\ selected\_node,}
\DoxyCodeLine{00611\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{00612\ \ \ \ \ \ \ cmaple::Index\&\ best\_child\_index,}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample\_regions);}
\DoxyCodeLine{00614\ }
\DoxyCodeLine{00620\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00621\ \ \ \textcolor{keywordtype}{void}\ addStartingNodes(\textcolor{keyword}{const}\ cmaple::Index\&\ node\_index,}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\&\ other\_child\_node\_index,}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_lh\_diff,}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::stack<std::unique\_ptr<UpdatingNode>>\&\ node\_stack);}
\DoxyCodeLine{00626\ }
\DoxyCodeLine{00632\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00633\ \ \ \textcolor{keywordtype}{bool}\ examineSubtreePlacementMidBranch(}
\DoxyCodeLine{00634\ \ \ \ \ \ \ cmaple::Index\&\ best\_node\_index,}
\DoxyCodeLine{00635\ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{00636\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_lh\_diff,}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ is\_mid\_branch,}
\DoxyCodeLine{00638\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff\_at\_node,}
\DoxyCodeLine{00639\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff\_mid\_branch,}
\DoxyCodeLine{00640\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_up\_lh\_diff,}
\DoxyCodeLine{00641\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{00642\ \ \ \ \ \ \ std::unique\_ptr<UpdatingNode>\&\ updating\_node,}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ threshold\_prob,}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ removed\_blength,}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ top\_node\_index,}
\DoxyCodeLine{00647\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ bottom\_regions);}
\DoxyCodeLine{00648\ }
\DoxyCodeLine{00654\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00655\ \ \ \textcolor{keywordtype}{bool}\ examineSubTreePlacementAtNode(}
\DoxyCodeLine{00656\ \ \ \ \ \ \ cmaple::Index\&\ best\_node\_index,}
\DoxyCodeLine{00657\ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{00658\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_lh\_diff,}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ is\_mid\_branch,}
\DoxyCodeLine{00660\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff\_at\_node,}
\DoxyCodeLine{00661\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff\_mid\_branch,}
\DoxyCodeLine{00662\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_up\_lh\_diff,}
\DoxyCodeLine{00663\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{00664\ \ \ \ \ \ \ std::unique\_ptr<UpdatingNode>\&\ updating\_node,}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ threshold\_prob,}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ removed\_blength,}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ top\_node\_index);}
\DoxyCodeLine{00669\ }
\DoxyCodeLine{00675\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00676\ \ \ \textcolor{keywordtype}{void}\ addChildSeekSubtreePlacement(}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ child\_1\_index,}
\DoxyCodeLine{00678\ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{00679\ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ lh\_diff\_at\_node,}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<UpdatingNode>\&\ updating\_node,}
\DoxyCodeLine{00682\ \ \ \ \ \ \ std::stack<std::unique\_ptr<UpdatingNode>>\&\ node\_stack,}
\DoxyCodeLine{00683\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ threshold\_prob);}
\DoxyCodeLine{00684\ }
\DoxyCodeLine{00691\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00692\ \ \ \textcolor{keywordtype}{bool}\ addNeighborsSeekSubtreePlacement(}
\DoxyCodeLine{00693\ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ other\_child\_index,}
\DoxyCodeLine{00695\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\&\ bottom\_regions,}
\DoxyCodeLine{00696\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ lh\_diff\_at\_node,}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<UpdatingNode>\&\ updating\_node,}
\DoxyCodeLine{00698\ \ \ \ \ \ \ std::stack<std::unique\_ptr<UpdatingNode>>\&\ node\_stack,}
\DoxyCodeLine{00699\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ threshold\_prob);}
\DoxyCodeLine{00700\ }
\DoxyCodeLine{00707\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{const}\ cmaple::StateType\ num\_states,}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*calculatePlacementCost)(}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ cmaple::RealNumType)>}
\DoxyCodeLine{00712\ \ \ bool\ tryShorterBranch(}
\DoxyCodeLine{00713\ \ \ \ \ \ \ const\ cmaple::RealNumType\ current\_blength,}
\DoxyCodeLine{00714\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_child\_regions,}
\DoxyCodeLine{00715\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00716\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions,}
\DoxyCodeLine{00717\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00718\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_split\_lh,}
\DoxyCodeLine{00719\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_branch\_length\_split,}
\DoxyCodeLine{00720\ \ \ \ \ \ \ const\ cmaple::RealNumType\ new\_branch\_length,}
\DoxyCodeLine{00721\ \ \ \ \ \ \ const\ bool\ try\_first\_branch);}
\DoxyCodeLine{00722\ }
\DoxyCodeLine{00728\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00729\ \ \ \textcolor{keywordtype}{void}\ tryShorterBranchAtRoot(\textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_parent\_regions,}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_root\_blength,}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_parent\_lh,}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ fixed\_blength);}
\DoxyCodeLine{00735\ }
\DoxyCodeLine{00740\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00741\ \ \ \textcolor{keywordtype}{bool}\ tryShorterNewBranchAtRoot(}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00744\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_parent\_regions,}
\DoxyCodeLine{00745\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_length,}
\DoxyCodeLine{00746\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_parent\_lh,}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ fixed\_blength);}
\DoxyCodeLine{00748\ }
\DoxyCodeLine{00755\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00756\ \ \ \textcolor{keywordtype}{bool}\ tryLongerNewBranchAtRoot(}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00759\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_parent\_regions,}
\DoxyCodeLine{00760\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_length,}
\DoxyCodeLine{00761\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_parent\_lh,}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ fixed\_blength);}
\DoxyCodeLine{00763\ }
\DoxyCodeLine{00769\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00770\ \ \ \textcolor{keywordtype}{void}\ estimateLengthNewBranchAtRoot(}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00772\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00773\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_parent\_regions,}
\DoxyCodeLine{00774\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_length,}
\DoxyCodeLine{00775\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_parent\_lh,}
\DoxyCodeLine{00776\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ fixed\_blength,}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ short\_blength\_thresh,}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ optional\_check);}
\DoxyCodeLine{00779\ }
\DoxyCodeLine{00784\ \ \ \textcolor{keyword}{template}\ <cmaple::RealNumType\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*calculatePlacementCost)(}
\DoxyCodeLine{00785\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00786\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00787\ \ \ \ \ \ \ const\ cmaple::RealNumType)>}
\DoxyCodeLine{00788\ \ \ bool\ tryShorterNewBranch(}
\DoxyCodeLine{00789\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ best\_child\_regions,}
\DoxyCodeLine{00790\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00791\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_blength,}
\DoxyCodeLine{00792\ \ \ \ \ \ \ cmaple::RealNumType\&\ new\_branch\_lh,}
\DoxyCodeLine{00793\ \ \ \ \ \ \ const\ cmaple::RealNumType\ short\_blength\_thresh);}
\DoxyCodeLine{00794\ }
\DoxyCodeLine{00799\ \ \ \textcolor{keyword}{template}\ <cmaple::RealNumType\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*calculatePlacementCost)(}
\DoxyCodeLine{00800\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00801\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00802\ \ \ \ \ \ \ const\ cmaple::RealNumType)>}
\DoxyCodeLine{00803\ \ \ void\ tryLongerNewBranch(const\ std::unique\_ptr<SeqRegions>\&\ best\_child\_regions,}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_blength,}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ new\_branch\_lh,}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ cmaple::RealNumType\ long\_blength\_thresh);}
\DoxyCodeLine{00808\ }
\DoxyCodeLine{00812\ \ \ \textcolor{keyword}{template}\ <cmaple::RealNumType\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*calculatePlacementCost)(}
\DoxyCodeLine{00813\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00814\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00815\ \ \ \ \ \ \ const\ cmaple::RealNumType)>}
\DoxyCodeLine{00816\ \ \ void\ estimateLengthNewBranch(}
\DoxyCodeLine{00817\ \ \ \ \ \ \ const\ cmaple::RealNumType\ best\_split\_lh,}
\DoxyCodeLine{00818\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ best\_child\_regions,}
\DoxyCodeLine{00819\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00820\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_blength,}
\DoxyCodeLine{00821\ \ \ \ \ \ \ const\ cmaple::RealNumType\ long\_blength\_thresh,}
\DoxyCodeLine{00822\ \ \ \ \ \ \ const\ cmaple::RealNumType\ short\_blength\_thresh,}
\DoxyCodeLine{00823\ \ \ \ \ \ \ const\ bool\ optional\_check);}
\DoxyCodeLine{00824\ }
\DoxyCodeLine{00830\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00831\ \ \ \textcolor{keywordtype}{void}\ connectNewSample2Branch(}
\DoxyCodeLine{00832\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{00834\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ sibling\_node\_index,}
\DoxyCodeLine{00835\ \ \ \ \ \ \ PhyloNode\&\ sibling\_node,}
\DoxyCodeLine{00836\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ top\_distance,}
\DoxyCodeLine{00837\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ down\_distance,}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_blength,}
\DoxyCodeLine{00839\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_child\_regions,}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions);}
\DoxyCodeLine{00841\ }
\DoxyCodeLine{00847\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00848\ \ \ \textcolor{keywordtype}{void}\ connectNewSample2Root(std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00849\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ sibling\_node\_index,}
\DoxyCodeLine{00851\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling\_node,}
\DoxyCodeLine{00852\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_root\_blength,}
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_length2,}
\DoxyCodeLine{00854\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_parent\_regions);}
\DoxyCodeLine{00855\ }
\DoxyCodeLine{00861\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00862\ \ \ \textcolor{keywordtype}{void}\ placeSubTreeAtNode(\textcolor{keyword}{const}\ cmaple::Index\ selected\_node\_index,}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ subtree\_index,}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ subtree,}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ new\_branch\_length,}
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ new\_lh);}
\DoxyCodeLine{00868\ }
\DoxyCodeLine{00874\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00875\ \ \ \textcolor{keywordtype}{void}\ placeSubTreeMidBranch(\textcolor{keyword}{const}\ cmaple::Index\ selected\_node\_index,}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ subtree\_index,}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ subtree,}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ new\_branch\_length,}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ new\_lh);}
\DoxyCodeLine{00881\ }
\DoxyCodeLine{00887\ \ \ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::StateType\ num\_states,}
\DoxyCodeLine{00889\ \ \ \ \ \ \ void\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*updateRegionsSubTree)(PhyloNode\&,}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&,}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&,}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\&,}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&)>}
\DoxyCodeLine{00897\ \ \ void\ connectSubTree2Branch(}
\DoxyCodeLine{00898\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00899\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00900\ \ \ \ \ \ \ const\ cmaple::Index\ subtree\_index,}
\DoxyCodeLine{00901\ \ \ \ \ \ \ PhyloNode\&\ subtree,}
\DoxyCodeLine{00902\ \ \ \ \ \ \ const\ cmaple::Index\ sibling\_node\_index,}
\DoxyCodeLine{00903\ \ \ \ \ \ \ PhyloNode\&\ sibling\_node,}
\DoxyCodeLine{00904\ \ \ \ \ \ \ const\ cmaple::RealNumType\ top\_distance,}
\DoxyCodeLine{00905\ \ \ \ \ \ \ const\ cmaple::RealNumType\ down\_distance,}
\DoxyCodeLine{00906\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_blength,}
\DoxyCodeLine{00907\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\&\ best\_child\_regions,}
\DoxyCodeLine{00908\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions);}
\DoxyCodeLine{00909\ }
\DoxyCodeLine{00915\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00916\ \ \ \textcolor{keywordtype}{void}\ connectSubTree2Root(\textcolor{keyword}{const}\ cmaple::Index\ subtree\_index,}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ subtree,}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ sibling\_node\_index,}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling\_node,}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_root\_blength,}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_length2,}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\&\ best\_parent\_regions);}
\DoxyCodeLine{00925\ }
\DoxyCodeLine{00933\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00934\ \ \ \textcolor{keywordtype}{void}\ updateRegionsPlaceSubTree(}
\DoxyCodeLine{00935\ \ \ \ \ \ \ PhyloNode\&\ subtree,}
\DoxyCodeLine{00936\ \ \ \ \ \ \ PhyloNode\&\ sibling\_node,}
\DoxyCodeLine{00937\ \ \ \ \ \ \ PhyloNode\&\ internal,}
\DoxyCodeLine{00938\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\&\ best\_child\_regions,}
\DoxyCodeLine{00939\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00940\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions,}
\DoxyCodeLine{00941\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00942\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_blength);}
\DoxyCodeLine{00943\ }
\DoxyCodeLine{00951\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00952\ \ \ \textcolor{keywordtype}{void}\ updateRegionsPlaceSubTreeAbove(}
\DoxyCodeLine{00953\ \ \ \ \ \ \ PhyloNode\&\ subtree,}
\DoxyCodeLine{00954\ \ \ \ \ \ \ PhyloNode\&\ sibling\_node,}
\DoxyCodeLine{00955\ \ \ \ \ \ \ PhyloNode\&\ internal,}
\DoxyCodeLine{00956\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\&\ best\_child\_regions,}
\DoxyCodeLine{00957\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00958\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions,}
\DoxyCodeLine{00959\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00960\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_blength);}
\DoxyCodeLine{00961\ }
\DoxyCodeLine{00967\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00968\ \ \ \textcolor{keywordtype}{void}\ handlePolytomyPlaceSubTree(}
\DoxyCodeLine{00969\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ selected\_node\_index,}
\DoxyCodeLine{00970\ \ \ \ \ \ \ PhyloNode\&\ selected\_node,}
\DoxyCodeLine{00971\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00972\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ new\_branch\_length,}
\DoxyCodeLine{00973\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{00974\ \ \ \ \ \ \ cmaple::Index\&\ best\_child\_index,}
\DoxyCodeLine{00975\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_child\_blength\_split,}
\DoxyCodeLine{00976\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_child\_regions);}
\DoxyCodeLine{00977\ }
\DoxyCodeLine{00983\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00984\ \ \ \textcolor{keywordtype}{void}\ updateMidBranchLh(}
\DoxyCodeLine{00985\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{00986\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{00987\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_upper\_regions,}
\DoxyCodeLine{00988\ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack,}
\DoxyCodeLine{00989\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ update\_blength);}
\DoxyCodeLine{00990\ }
\DoxyCodeLine{00997\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00998\ \ \ std::unique\_ptr<SeqRegions>\ computeUpperLeftRightRegions(}
\DoxyCodeLine{00999\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01000\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01001\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::MiniIndex\ next\_node\_mini,}
\DoxyCodeLine{01002\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_upper\_regions,}
\DoxyCodeLine{01003\ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack,}
\DoxyCodeLine{01004\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ update\_blength);}
\DoxyCodeLine{01005\ }
\DoxyCodeLine{01010\ \ \ \textcolor{keywordtype}{bool}\ updateNewPartialIfDifferent(}
\DoxyCodeLine{01011\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01012\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::MiniIndex\ next\_node\_mini,}
\DoxyCodeLine{01013\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions,}
\DoxyCodeLine{01014\ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack,}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\ seq\_length);}
\DoxyCodeLine{01016\ }
\DoxyCodeLine{01023\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01024\ \ \ \textcolor{keywordtype}{void}\ \textcolor{keyword}{inline}\ handleNullNewRegions(\textcolor{keyword}{const}\ cmaple::Index\ index,}
\DoxyCodeLine{01025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ do\_update\_zeroblength,}
\DoxyCodeLine{01027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack,}
\DoxyCodeLine{01028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ update\_blength,}
\DoxyCodeLine{01029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ err\_msg)\ \{}
\DoxyCodeLine{01030\ \ \ \ \ \textcolor{keywordflow}{if}\ (do\_update\_zeroblength)\ \{}
\DoxyCodeLine{01031\ \ \ \ \ \ \ updateZeroBlength<num\_states>(index,\ node,\ node\_stack);}
\DoxyCodeLine{01032\ \ \ \ \ \ \ update\_blength\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01033\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01034\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::logic\_error(err\_msg);}
\DoxyCodeLine{01035\ \ \ \}}
\DoxyCodeLine{01036\ }
\DoxyCodeLine{01043\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01044\ \ \ \textcolor{keywordtype}{void}\ updatePartialLhFromParent(}
\DoxyCodeLine{01045\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ index,}
\DoxyCodeLine{01046\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01047\ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack,}
\DoxyCodeLine{01048\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_upper\_regions,}
\DoxyCodeLine{01049\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\ seq\_length);}
\DoxyCodeLine{01050\ }
\DoxyCodeLine{01057\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01058\ \ \ \textcolor{keywordtype}{void}\ updatePartialLhFromChildren(}
\DoxyCodeLine{01059\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ index,}
\DoxyCodeLine{01060\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01061\ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack,}
\DoxyCodeLine{01062\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_upper\_regions,}
\DoxyCodeLine{01063\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_non\_root,}
\DoxyCodeLine{01064\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\ seq\_length);}
\DoxyCodeLine{01065\ }
\DoxyCodeLine{01071\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01072\ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ computeMidBranchRegions(}
\DoxyCodeLine{01073\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01074\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ regions\_2\_update,}
\DoxyCodeLine{01075\ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegions\&\ parent\_upper\_lr\_lh)\ \{}
\DoxyCodeLine{01076\ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ lower\_lh\ =\ node.getPartialLh(cmaple::TOP);}
\DoxyCodeLine{01077\ \ \ \ \ cmaple::RealNumType\ half\_branch\_length\ =\ node.getUpperLength()\ *\ 0.5;}
\DoxyCodeLine{01078\ \ \ \ \ parent\_upper\_lr\_lh.mergeUpperLower<num\_states>(}
\DoxyCodeLine{01079\ \ \ \ \ \ \ \ \ regions\_2\_update,\ half\_branch\_length,\ *lower\_lh,\ half\_branch\_length,}
\DoxyCodeLine{01080\ \ \ \ \ \ \ \ \ aln,\ model,\ params-\/>threshold\_prob);}
\DoxyCodeLine{01081\ \ \ \}}
\DoxyCodeLine{01082\ }
\DoxyCodeLine{01088\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01089\ \ \ \textcolor{keywordtype}{void}\ refreshNonLowerLhsFromParent(cmaple::Index\&\ node\_index,}
\DoxyCodeLine{01090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::Index\&\ last\_node\_index);}
\DoxyCodeLine{01091\ }
\DoxyCodeLine{01097\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01098\ \ \ \textcolor{keywordtype}{void}\ refreshUpperLR(\textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_index,}
\DoxyCodeLine{01101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ replaced\_regions,}
\DoxyCodeLine{01102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegions\&\ parent\_upper\_lr\_lh);}
\DoxyCodeLine{01103\ }
\DoxyCodeLine{01107\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01108\ \ \ \textcolor{keywordtype}{void}\ estimateBlength\_R\_O(\textcolor{keyword}{const}\ SeqRegion\&\ seq1\_region,}
\DoxyCodeLine{01109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegion\&\ seq2\_region,}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ total\_blength,}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\ end\_pos,}
\DoxyCodeLine{01112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ coefficient,}
\DoxyCodeLine{01113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ coefficient\_vec);}
\DoxyCodeLine{01114\ }
\DoxyCodeLine{01118\ \ \ \textcolor{keywordtype}{void}\ estimateBlength\_R\_ACGT(}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegion\&\ seq1\_region,}
\DoxyCodeLine{01120\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::StateType\ seq2\_state,}
\DoxyCodeLine{01121\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ total\_blength,}
\DoxyCodeLine{01122\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\ end\_pos,}
\DoxyCodeLine{01123\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ coefficient\_vec);}
\DoxyCodeLine{01124\ }
\DoxyCodeLine{01129\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01130\ \ \ \textcolor{keywordtype}{void}\ estimateBlength\_O\_X(\textcolor{keyword}{const}\ SeqRegion\&\ seq1\_region,}
\DoxyCodeLine{01131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegion\&\ seq2\_region,}
\DoxyCodeLine{01132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ total\_blength,}
\DoxyCodeLine{01133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\ end\_pos,}
\DoxyCodeLine{01134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ coefficient,}
\DoxyCodeLine{01135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ coefficient\_vec);}
\DoxyCodeLine{01136\ }
\DoxyCodeLine{01140\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01141\ \ \ \textcolor{keywordtype}{void}\ estimateBlength\_ACGT\_O(}
\DoxyCodeLine{01142\ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegion\&\ seq1\_region,}
\DoxyCodeLine{01143\ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegion\&\ seq2\_region,}
\DoxyCodeLine{01144\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ total\_blength,}
\DoxyCodeLine{01145\ \ \ \ \ \ \ cmaple::RealNumType\&\ coefficient,}
\DoxyCodeLine{01146\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ coefficient\_vec);}
\DoxyCodeLine{01147\ }
\DoxyCodeLine{01152\ \ \ \textcolor{keywordtype}{void}\ estimateBlength\_ACGT\_RACGT(}
\DoxyCodeLine{01153\ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegion\&\ seq1\_region,}
\DoxyCodeLine{01154\ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegion\&\ seq2\_region,}
\DoxyCodeLine{01155\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ total\_blength,}
\DoxyCodeLine{01156\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\ end\_pos,}
\DoxyCodeLine{01157\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ coefficient\_vec);}
\DoxyCodeLine{01158\ }
\DoxyCodeLine{01162\ \ \ cmaple::RealNumType\ estimateBlengthFromCoeffs(}
\DoxyCodeLine{01163\ \ \ \ \ \ \ cmaple::RealNumType\&\ coefficient,}
\DoxyCodeLine{01164\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<cmaple::RealNumType>\ coefficient\_vec);}
\DoxyCodeLine{01165\ }
\DoxyCodeLine{01171\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01172\ \ \ \textcolor{keywordtype}{void}\ handleBlengthChanged(PhyloNode\&\ node,}
\DoxyCodeLine{01173\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_blength);}
\DoxyCodeLine{01175\ }
\DoxyCodeLine{01179\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01180\ \ \ \textcolor{keywordtype}{void}\ optimizeBlengthBeforeSeekingSPR(}
\DoxyCodeLine{01181\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01182\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_blength,}
\DoxyCodeLine{01183\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_lh,}
\DoxyCodeLine{01184\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ blength\_changed,}
\DoxyCodeLine{01185\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_upper\_lr\_lh,}
\DoxyCodeLine{01186\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_lh);}
\DoxyCodeLine{01187\ }
\DoxyCodeLine{01193\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01194\ \ \ \textcolor{keywordtype}{void}\ checkAndApplySPR(\textcolor{keyword}{const}\ cmaple::RealNumType\ best\_lh\_diff,}
\DoxyCodeLine{01195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_blength,}
\DoxyCodeLine{01196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_lh,}
\DoxyCodeLine{01197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ best\_node\_index,}
\DoxyCodeLine{01200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_node\_index,}
\DoxyCodeLine{01201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_mid\_node,}
\DoxyCodeLine{01202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ total\_improvement,}
\DoxyCodeLine{01203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ topology\_updated);}
\DoxyCodeLine{01204\ }
\DoxyCodeLine{01208\ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ createAnInternalNode()\ \{\ nodes.emplace\_back(InternalNode());\ \}}
\DoxyCodeLine{01209\ }
\DoxyCodeLine{01213\ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ createALeafNode(\textcolor{keyword}{const}\ cmaple::NumSeqsType\ new\_seq\_name\_index)\ \{}
\DoxyCodeLine{01214\ \ \ \ \ nodes.emplace\_back(LeafNode(}
\DoxyCodeLine{01215\ \ \ \ \ \ \ \ \ new\_seq\_name\_index));\ \ \textcolor{comment}{//(PhyloNode(std::move(LeafNode(new\_seq\_name\_index))));}}
\DoxyCodeLine{01216\ \ \ \}}
\DoxyCodeLine{01217\ }
\DoxyCodeLine{01221\ \ \ std::unique\_ptr<SeqRegions>\&\ getPartialLhAtNode(\textcolor{keyword}{const}\ cmaple::Index\ index);}
\DoxyCodeLine{01222\ }
\DoxyCodeLine{01228\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01229\ \ \ \textcolor{keywordtype}{bool}\ calculateNNILh(std::stack<cmaple::Index>\&\ node\_stack\_aLRT,}
\DoxyCodeLine{01230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff,}
\DoxyCodeLine{01231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index,}
\DoxyCodeLine{01237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_at\_root,}
\DoxyCodeLine{01238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ allow\_replacing\_ML\_tree);}
\DoxyCodeLine{01239\ }
\DoxyCodeLine{01245\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01246\ \ \ \textcolor{keywordtype}{bool}\ calculateNNILhRoot(std::stack<cmaple::Index>\&\ node\_stack\_aLRT,}
\DoxyCodeLine{01247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff,}
\DoxyCodeLine{01248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ parent\_new\_lower\_lh,}
\DoxyCodeLine{01249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ child\_2\_new\_blength,}
\DoxyCodeLine{01250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index,}
\DoxyCodeLine{01256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_at\_root,}
\DoxyCodeLine{01257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ allow\_replacing\_ML\_tree);}
\DoxyCodeLine{01258\ }
\DoxyCodeLine{01265\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01266\ \ \ \textcolor{keywordtype}{bool}\ calculateNNILhNonRoot(std::stack<cmaple::Index>\&\ node\_stack\_aLRT,}
\DoxyCodeLine{01267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff,}
\DoxyCodeLine{01268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ parent\_new\_lower\_lh,}
\DoxyCodeLine{01269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ child\_2\_new\_blength,}
\DoxyCodeLine{01270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index,}
\DoxyCodeLine{01276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_at\_root,}
\DoxyCodeLine{01277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ allow\_replacing\_ML\_tree);}
\DoxyCodeLine{01278\ }
\DoxyCodeLine{01284\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01285\ \ \ \textcolor{keywordtype}{void}\ replaceMLTreebyNNIRoot(std::stack<cmaple::Index>\&\ node\_stack\_aLRT,}
\DoxyCodeLine{01286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff,}
\DoxyCodeLine{01287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_at\_root,}
\DoxyCodeLine{01293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ child\_1\_best\_blength,}
\DoxyCodeLine{01294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ child\_2\_best\_blength,}
\DoxyCodeLine{01295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ sibling\_best\_blength,}
\DoxyCodeLine{01296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ parent\_best\_blength);}
\DoxyCodeLine{01297\ }
\DoxyCodeLine{01304\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01305\ \ \ \textcolor{keywordtype}{void}\ replaceMLTreebyNNINonRoot(}
\DoxyCodeLine{01306\ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack\_aLRT,}
\DoxyCodeLine{01307\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff,}
\DoxyCodeLine{01308\ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01309\ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01310\ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01311\ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01312\ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01313\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_at\_root,}
\DoxyCodeLine{01314\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ child\_1\_best\_blength,}
\DoxyCodeLine{01315\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ child\_2\_best\_blength,}
\DoxyCodeLine{01316\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ sibling\_best\_blength,}
\DoxyCodeLine{01317\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ parent\_best\_blength,}
\DoxyCodeLine{01318\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ new\_parent\_best\_blength);}
\DoxyCodeLine{01319\ }
\DoxyCodeLine{01327\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01328\ \ \ \textcolor{keywordtype}{void}\ updateUpperLR(std::stack<cmaple::Index>\&\ node\_stack,}
\DoxyCodeLine{01329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack\_aLRT);}
\DoxyCodeLine{01330\ }
\DoxyCodeLine{01335\ \ \ \textcolor{keywordtype}{void}\ recompute\_aLRT\_GrandChildren(PhyloNode\&\ parent,}
\DoxyCodeLine{01336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack\_aLRT);}
\DoxyCodeLine{01337\ }
\DoxyCodeLine{01345\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01346\ \ \ \textcolor{keywordtype}{void}\ calculate\_aRLT(\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ allow\_replacing\_ML\_tree);}
\DoxyCodeLine{01347\ }
\DoxyCodeLine{01353\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01354\ \ \ cmaple::RealNumType\ calculateSiteLhs(}
\DoxyCodeLine{01355\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_contributions,}
\DoxyCodeLine{01356\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_root);}
\DoxyCodeLine{01357\ }
\DoxyCodeLine{01363\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01364\ \ \ \textcolor{keywordtype}{void}\ calculate\_aRLT\_SH(}
\DoxyCodeLine{01365\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_contributions,}
\DoxyCodeLine{01366\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_root,}
\DoxyCodeLine{01367\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ LT1);}
\DoxyCodeLine{01368\ }
\DoxyCodeLine{01374\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01375\ \ \ cmaple::PositionType\ count\_aRLT\_SH\_branch(}
\DoxyCodeLine{01376\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_contributions,}
\DoxyCodeLine{01377\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_root,}
\DoxyCodeLine{01378\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01379\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ LT1);}
\DoxyCodeLine{01380\ }
\DoxyCodeLine{01387\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01388\ \ \ \textcolor{keywordtype}{void}\ calSiteLhDiffRoot(std::vector<cmaple::RealNumType>\&\ site\_lh\_diff,}
\DoxyCodeLine{01389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_root\_diff,}
\DoxyCodeLine{01390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<cmaple::RealNumType>\&\ site\_lh\_root,}
\DoxyCodeLine{01391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ parent\_new\_lower\_lh,}
\DoxyCodeLine{01392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ child\_2\_new\_blength,}
\DoxyCodeLine{01393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index);}
\DoxyCodeLine{01399\ }
\DoxyCodeLine{01406\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01407\ \ \ \textcolor{keywordtype}{void}\ calSiteLhDiffNonRoot(}
\DoxyCodeLine{01408\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_diff,}
\DoxyCodeLine{01409\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_root\_diff,}
\DoxyCodeLine{01410\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<cmaple::RealNumType>\&\ site\_lh\_root,}
\DoxyCodeLine{01411\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ parent\_new\_lower\_lh,}
\DoxyCodeLine{01412\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ child\_2\_new\_blength,}
\DoxyCodeLine{01413\ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01414\ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01415\ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01416\ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01417\ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01418\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index);}
\DoxyCodeLine{01419\ }
\DoxyCodeLine{01425\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01426\ \ \ \textcolor{keywordtype}{void}\ calSiteLhDiff(std::vector<cmaple::RealNumType>\&\ site\_lh\_diff,}
\DoxyCodeLine{01427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_root\_diff,}
\DoxyCodeLine{01428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<cmaple::RealNumType>\&\ site\_lh\_root,}
\DoxyCodeLine{01429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index);}
\DoxyCodeLine{01435\ }
\DoxyCodeLine{01439\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ readNextChar(std::istream\&\ in,}
\DoxyCodeLine{01440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::PositionType\&\ in\_line,}
\DoxyCodeLine{01441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::PositionType\&\ in\_column,}
\DoxyCodeLine{01442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\&\ current\_ch\ =\ 0)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01443\ }
\DoxyCodeLine{01450\ \ \ cmaple::NumSeqsType\ parseFile(}
\DoxyCodeLine{01451\ \ \ \ \ \ \ std::istream\&\ infile,}
\DoxyCodeLine{01452\ \ \ \ \ \ \ \textcolor{keywordtype}{char}\&\ ch,}
\DoxyCodeLine{01453\ \ \ \ \ \ \ cmaple::RealNumType\&\ branch\_len,}
\DoxyCodeLine{01454\ \ \ \ \ \ \ cmaple::PositionType\&\ in\_line,}
\DoxyCodeLine{01455\ \ \ \ \ \ \ cmaple::PositionType\&\ in\_column,}
\DoxyCodeLine{01456\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::map<std::string,\ cmaple::NumSeqsType>\&\ map\_seqname\_index,}
\DoxyCodeLine{01457\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ missing\_blengths);}
\DoxyCodeLine{01458\ }
\DoxyCodeLine{01463\ \ \ \textcolor{keywordtype}{void}\ collapseAllZeroLeave();}
\DoxyCodeLine{01464\ }
\DoxyCodeLine{01469\ \ \ \textcolor{keywordtype}{void}\ collapseOneZeroLeaf(PhyloNode\&\ node,}
\DoxyCodeLine{01470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::Index\&\ node\_index,}
\DoxyCodeLine{01471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ neighbor\_1,}
\DoxyCodeLine{01472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_1\_index,}
\DoxyCodeLine{01473\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ neighbor\_2);}
\DoxyCodeLine{01474\ }
\DoxyCodeLine{01478\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01479\ \ \ \textcolor{keywordtype}{void}\ updatePesudoCountModel(PhyloNode\&\ node,}
\DoxyCodeLine{01480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01481\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index);}
\DoxyCodeLine{01482\ }
\DoxyCodeLine{01488\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01489\ \ \ \textcolor{keywordtype}{void}\ expandTreeByOneLessInfoSeq(PhyloNode\&\ node,}
\DoxyCodeLine{01490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01491\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index);}
\DoxyCodeLine{01492\ }
\DoxyCodeLine{01501\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01502\ \ \ \textcolor{keywordtype}{void}\ updateBlengthReplaceMLTree(std::stack<cmaple::Index>\&\ node\_stack\_aLRT,}
\DoxyCodeLine{01503\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff,}
\DoxyCodeLine{01504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_blength);}
\DoxyCodeLine{01507\ }
\DoxyCodeLine{01515\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01516\ \ \ \textcolor{keywordtype}{void}\ addLessInfoSeqReplacingMLTree(std::stack<cmaple::Index>\&\ node\_stack\_aLRT,}
\DoxyCodeLine{01517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff,}
\DoxyCodeLine{01518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index);}
\DoxyCodeLine{01521\ }
\DoxyCodeLine{01527\ \ \ std::string\ exportNodeString(\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ binary,}
\DoxyCodeLine{01528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::NumSeqsType\ node\_vec\_index,}
\DoxyCodeLine{01529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ show\_branch\_supports);}
\DoxyCodeLine{01530\ }
\DoxyCodeLine{01541\ \ \ \textcolor{keywordtype}{bool}\ readTree(std::istream\&\ tree\_stream);}
\DoxyCodeLine{01542\ }
\DoxyCodeLine{01548\ \ \ \textcolor{keywordtype}{bool}\ isComplete();}
\DoxyCodeLine{01549\ }
\DoxyCodeLine{01554\ \ \ \textcolor{keywordtype}{void}\ updateModelByAln();}
\DoxyCodeLine{01555\ }
\DoxyCodeLine{01561\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01562\ \ \ \textcolor{keywordtype}{void}\ updateModelLhAfterLoading();}
\DoxyCodeLine{01563\ }
\DoxyCodeLine{01567\ \ \ std::map<std::string,\ NumSeqsType>\ initMapSeqNameIndex();}
\DoxyCodeLine{01568\ }
\DoxyCodeLine{01575\ \ \ \textcolor{keywordtype}{void}\ remarkExistingSeqs();}
\DoxyCodeLine{01576\ }
\DoxyCodeLine{01586\ \ \ NumSeqsType\ markAnExistingSeq(}
\DoxyCodeLine{01587\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ seq\_name,}
\DoxyCodeLine{01588\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::map<std::string,\ NumSeqsType>\&\ map\_name\_index);}
\DoxyCodeLine{01589\ }
\DoxyCodeLine{01593\ \ \ \textcolor{keywordtype}{void}\ resetSeqAdded();}
\DoxyCodeLine{01594\ }
\DoxyCodeLine{01601\ \ \ \textcolor{keywordtype}{void}\ attachAlnModel(Alignment*\ aln,\ ModelBase*\ model);}
\DoxyCodeLine{01602\ }
\DoxyCodeLine{01608\ \ \ std::string\ \mbox{\hyperlink{classcmaple_1_1_tree_a8d1492f8a3291bd70af3a879b535f880}{exportNewick}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ binary,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ show\_branch\_supports);}
\DoxyCodeLine{01609\ }
\DoxyCodeLine{01614\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01615\ \ \ \textcolor{keywordtype}{void}\ updateZeroBlength(\textcolor{keyword}{const}\ cmaple::Index\ index,}
\DoxyCodeLine{01616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack);}
\DoxyCodeLine{01618\ }
\DoxyCodeLine{01626\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01627\ \ \ \textcolor{keywordtype}{void}\ updatePartialLh(std::stack<cmaple::Index>\&\ node\_stack);}
\DoxyCodeLine{01628\ }
\DoxyCodeLine{01635\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01636\ \ \ \textcolor{keywordtype}{void}\ seekSamplePlacement(\textcolor{keyword}{const}\ cmaple::Index\ start\_node\_index,}
\DoxyCodeLine{01637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{01638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample\_regions,}
\DoxyCodeLine{01639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::Index\&\ selected\_node\_index,}
\DoxyCodeLine{01640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_lh\_diff,}
\DoxyCodeLine{01641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ is\_mid\_branch,}
\DoxyCodeLine{01642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_up\_lh\_diff,}
\DoxyCodeLine{01643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{01644\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::Index\&\ best\_child\_index);}
\DoxyCodeLine{01645\ }
\DoxyCodeLine{01652\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01653\ \ \ \textcolor{keywordtype}{void}\ seekSubTreePlacement(}
\DoxyCodeLine{01654\ \ \ \ \ \ \ cmaple::Index\&\ best\_node\_index,}
\DoxyCodeLine{01655\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_lh\_diff,}
\DoxyCodeLine{01656\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ is\_mid\_branch,}
\DoxyCodeLine{01657\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_up\_lh\_diff,}
\DoxyCodeLine{01658\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{01659\ \ \ \ \ \ \ cmaple::Index\&\ best\_child\_index,}
\DoxyCodeLine{01660\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ short\_range\_search,}
\DoxyCodeLine{01661\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ child\_node\_index,}
\DoxyCodeLine{01662\ \ \ \ \ \ \ cmaple::RealNumType\&}
\DoxyCodeLine{01663\ \ \ \ \ \ \ \ \ \ \ removed\_blength);\ \ \textcolor{comment}{//,\ bool\ search\_subtree\_placement\ =\ true,}}
\DoxyCodeLine{01664\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ SeqRegions*\ sample\_regions\ =\ NULL);}}
\DoxyCodeLine{01665\ }
\DoxyCodeLine{01671\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01672\ \ \ \textcolor{keywordtype}{void}\ placeNewSampleMidBranch(\textcolor{keyword}{const}\ cmaple::Index\&\ selected\_node\_index,}
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{01674\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{01675\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_lh\_diff);}
\DoxyCodeLine{01676\ }
\DoxyCodeLine{01682\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01683\ \ \ \textcolor{keywordtype}{void}\ placeNewSampleAtNode(\textcolor{keyword}{const}\ cmaple::Index\ selected\_node\_index,}
\DoxyCodeLine{01684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{01685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{01686\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_lh\_diff,}
\DoxyCodeLine{01687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_up\_lh\_diff,}
\DoxyCodeLine{01688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_down\_lh\_diff,}
\DoxyCodeLine{01689\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ best\_child\_index);}
\DoxyCodeLine{01690\ }
\DoxyCodeLine{01697\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01698\ \ \ \textcolor{keywordtype}{void}\ applyOneSPR(\textcolor{keyword}{const}\ cmaple::Index\ subtree\_index,}
\DoxyCodeLine{01699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ subtree,}
\DoxyCodeLine{01700\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ best\_node\_index,}
\DoxyCodeLine{01701\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_mid\_branch,}
\DoxyCodeLine{01702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ branch\_length,}
\DoxyCodeLine{01703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_lh\_diff);}
\DoxyCodeLine{01704\ }
\DoxyCodeLine{01711\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01712\ \ \ \textcolor{keywordtype}{void}\ refreshAllLhs(\textcolor{keywordtype}{bool}\ avoid\_using\_upper\_lr\_lhs\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{01713\ }
\DoxyCodeLine{01719\ \ \ \textcolor{keywordtype}{void}\ resetSPRFlags(\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ update\_outdated,}
\DoxyCodeLine{01720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ n\_outdated);}
\DoxyCodeLine{01721\ }
\DoxyCodeLine{01728\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01729\ \ \ cmaple::RealNumType\ improveEntireTree(\textcolor{keywordtype}{bool}\ short\_range\_search);}
\DoxyCodeLine{01730\ }
\DoxyCodeLine{01737\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01738\ \ \ cmaple::PositionType\ optimizeBranchIter();}
\DoxyCodeLine{01739\ }
\DoxyCodeLine{01744\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01745\ \ \ cmaple::RealNumType\ estimateBranchLength(}
\DoxyCodeLine{01746\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_regions,}
\DoxyCodeLine{01747\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ child\_regions);}
\DoxyCodeLine{01748\ }
\DoxyCodeLine{01753\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01754\ \ \ cmaple::RealNumType\ estimateBranchLengthWithCheck(}
\DoxyCodeLine{01755\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_lr\_regions,}
\DoxyCodeLine{01756\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{01757\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ current\_blength);}
\DoxyCodeLine{01758\ }
\DoxyCodeLine{01763\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01764\ \ \ cmaple::RealNumType\ calculateSamplePlacementCost(}
\DoxyCodeLine{01765\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_regions,}
\DoxyCodeLine{01766\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ child\_regions,}
\DoxyCodeLine{01767\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ blength);}
\DoxyCodeLine{01768\ }
\DoxyCodeLine{01773\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01774\ \ \ cmaple::RealNumType\ calculateSubTreePlacementCost(}
\DoxyCodeLine{01775\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_regions,}
\DoxyCodeLine{01776\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ child\_regions,}
\DoxyCodeLine{01777\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ blength);}
\DoxyCodeLine{01778\ }
\DoxyCodeLine{01784\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01785\ \ \ \textcolor{keywordtype}{void}\ updateLowerLh(cmaple::RealNumType\&\ total\_lh,}
\DoxyCodeLine{01786\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ new\_lower\_lh,}
\DoxyCodeLine{01787\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01788\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_lh\_1,}
\DoxyCodeLine{01789\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_lh\_2,}
\DoxyCodeLine{01790\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_1\_index,}
\DoxyCodeLine{01791\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ neighbor\_1,}
\DoxyCodeLine{01792\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_2\_index,}
\DoxyCodeLine{01793\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ neighbor\_2,}
\DoxyCodeLine{01794\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\&\ seq\_length);}
\DoxyCodeLine{01795\ }
\DoxyCodeLine{01803\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01804\ \ \ \textcolor{keywordtype}{void}\ updateLowerLhAvoidUsingUpperLRLh(}
\DoxyCodeLine{01805\ \ \ \ \ \ \ cmaple::RealNumType\&\ total\_lh,}
\DoxyCodeLine{01806\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ new\_lower\_lh,}
\DoxyCodeLine{01807\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01808\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_lh\_1,}
\DoxyCodeLine{01809\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_lh\_2,}
\DoxyCodeLine{01810\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_1\_index,}
\DoxyCodeLine{01811\ \ \ \ \ \ \ PhyloNode\&\ neighbor\_1,}
\DoxyCodeLine{01812\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_2\_index,}
\DoxyCodeLine{01813\ \ \ \ \ \ \ PhyloNode\&\ neighbor\_2,}
\DoxyCodeLine{01814\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\&\ seq\_length);}
\DoxyCodeLine{01815\ }
\DoxyCodeLine{01821\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01822\ \ \ \textcolor{keywordtype}{void}\ computeLhContribution(cmaple::RealNumType\&\ total\_lh,}
\DoxyCodeLine{01823\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ new\_lower\_lh,}
\DoxyCodeLine{01824\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01825\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_lh\_1,}
\DoxyCodeLine{01826\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_lh\_2,}
\DoxyCodeLine{01827\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_1\_index,}
\DoxyCodeLine{01828\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ neighbor\_1,}
\DoxyCodeLine{01829\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_2\_index,}
\DoxyCodeLine{01830\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ neighbor\_2,}
\DoxyCodeLine{01831\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\&\ seq\_length);}
\DoxyCodeLine{01832\ }
\DoxyCodeLine{01836\ \ \ \textcolor{keyword}{template}\ <void\ (Tree::*task)(cmaple::RealNumType\&,}
\DoxyCodeLine{01837\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{01838\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&,}
\DoxyCodeLine{01839\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{01840\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{01841\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ cmaple::Index,}
\DoxyCodeLine{01842\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&,}
\DoxyCodeLine{01843\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ cmaple::Index,}
\DoxyCodeLine{01844\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&,}
\DoxyCodeLine{01845\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ cmaple::PositionType\&)>}
\DoxyCodeLine{01846\ \ \ cmaple::RealNumType\ performDFS();}
\DoxyCodeLine{01847\ }
\DoxyCodeLine{01852\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01853\ \ \ \textcolor{keywordtype}{void}\ updateModelParams();}
\DoxyCodeLine{01854\ }
\DoxyCodeLine{01858\ \ \ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{01859\ \ \ \ \ \ \ void\ (Tree::*task)(PhyloNode\&,\ const\ cmaple::Index,\ const\ cmaple::Index)>}
\DoxyCodeLine{01860\ \ \ void\ performDFSAtLeave();}
\DoxyCodeLine{01861\ \ \ \ }
\DoxyCodeLine{01865\ \ \ \textcolor{keywordtype}{bool}\ keepTraversing(\textcolor{keyword}{const}\ RealNumType\&\ best\_lh\_diff,}
\DoxyCodeLine{01866\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ RealNumType\&\ lh\_diff\_at\_node,}
\DoxyCodeLine{01867\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\&\ strict\_stop\_seeking\_placement\_subtree,}
\DoxyCodeLine{01868\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<UpdatingNode>\&\ updating\_node,}
\DoxyCodeLine{01869\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\&\ failure\_limit\_subtree,}
\DoxyCodeLine{01870\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ RealNumType\&\ thresh\_log\_lh\_subtree,}
\DoxyCodeLine{01871\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ able2traverse\ =\ \textcolor{keyword}{true});}
\DoxyCodeLine{01872\ }
\DoxyCodeLine{01873\ \ \ \textcolor{comment}{//\ NHANLT:\ Debug\ aLRT}}
\DoxyCodeLine{01874\ \ \ \textcolor{comment}{//\ void\ log\_current(std::stack<cmaple::Index>\&\ node\_stack\_aLRT);}}
\DoxyCodeLine{01875\ \};}
\DoxyCodeLine{01876\ }
\DoxyCodeLine{01885\ std::ostream\&\ \mbox{\hyperlink{group__cmaple_gabf49c77ec0934b4d8750f61dd3ac6d71}{operator<<}}(std::ostream\&\ out\_stream,\ \mbox{\hyperlink{classcmaple_1_1_tree}{cmaple::Tree}}\&\ tree);}
\DoxyCodeLine{01886\ }
\DoxyCodeLine{01889\ std::istream\&\ \mbox{\hyperlink{group__cmaple_ga9f041909a438d7173dc9f15dcf20762d}{operator>>}}(std::istream\&\ in\_stream,\ \mbox{\hyperlink{classcmaple_1_1_tree}{cmaple::Tree}}\&\ tree);}
\DoxyCodeLine{01890\ }
\DoxyCodeLine{01894\ \textcolor{keyword}{template}\ <const\ StateType\ num\_states>}
\DoxyCodeLine{01895\ \textcolor{keywordtype}{void}\ cmaple::Tree::refreshAllLhs(\textcolor{keywordtype}{bool}\ avoid\_using\_upper\_lr\_lhs)\ \{}
\DoxyCodeLine{01896\ \ \ assert(aln);}
\DoxyCodeLine{01897\ \ \ assert(model);}
\DoxyCodeLine{01898\ \ \ assert(cumulative\_rate);}
\DoxyCodeLine{01899\ \ \ \ \ }
\DoxyCodeLine{01900\ \ \ \textcolor{comment}{//\ 1.\ update\ all\ the\ lower\ lhs\ along\ the\ tree}}
\DoxyCodeLine{01901\ \ \ \textcolor{keywordflow}{if}\ (avoid\_using\_upper\_lr\_lhs)\ \{}
\DoxyCodeLine{01902\ \ \ \ \ performDFS<\&cmaple::Tree::updateLowerLhAvoidUsingUpperLRLh<num\_states>>();}
\DoxyCodeLine{01903\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01904\ \ \ \ \ performDFS<\&cmaple::Tree::updateLowerLh<num\_states>>();}
\DoxyCodeLine{01905\ \ \ \}}
\DoxyCodeLine{01906\ }
\DoxyCodeLine{01907\ \ \ \textcolor{comment}{//\ 2.\ update\ all\ the\ non-\/lower\ lhs\ along\ the\ tree}}
\DoxyCodeLine{01908\ \ \ refreshAllNonLowerLhs<num\_states>();}
\DoxyCodeLine{01909\ \}}
\DoxyCodeLine{01910\ }
\DoxyCodeLine{01911\ \textcolor{keyword}{template}\ <const\ StateType\ num\_states>}
\DoxyCodeLine{01912\ RealNumType\ cmaple::Tree::improveEntireTree(\textcolor{keywordtype}{bool}\ short\_range\_search)\ \{}
\DoxyCodeLine{01913\ \ \ assert(aln);}
\DoxyCodeLine{01914\ \ \ assert(model);}
\DoxyCodeLine{01915\ \ \ assert(cumulative\_rate);}
\DoxyCodeLine{01916\ \ \ assert(nodes.size()\ >\ 0);}
\DoxyCodeLine{01917\ \ \ \ \ }
\DoxyCodeLine{01918\ \ \ \textcolor{comment}{//\ start\ from\ the\ root}}
\DoxyCodeLine{01919\ \ \ std::stack<Index>\ node\_stack;}
\DoxyCodeLine{01920\ \ \ node\_stack.push(Index(root\_vector\_index,\ TOP));}
\DoxyCodeLine{01921\ }
\DoxyCodeLine{01922\ \ \ \textcolor{comment}{//\ dummy\ variables}}
\DoxyCodeLine{01923\ \ \ RealNumType\ total\_improvement\ =\ 0;}
\DoxyCodeLine{01924\ \ \ PositionType\ num\_nodes\ =\ 0;}
\DoxyCodeLine{01925\ \ \ PositionType\ count\_node\_1K\ =\ 0;}
\DoxyCodeLine{01926\ }
\DoxyCodeLine{01927\ \ \ \textcolor{comment}{//\ traverse\ downward\ the\ tree}}
\DoxyCodeLine{01928\ \ \ \textcolor{keywordflow}{while}\ (!node\_stack.empty())\ \{}
\DoxyCodeLine{01929\ \ \ \ \ \textcolor{comment}{//\ pick\ the\ top\ node\ from\ the\ stack}}
\DoxyCodeLine{01930\ \ \ \ \ Index\ index\ =\ node\_stack.top();}
\DoxyCodeLine{01931\ \ \ \ \ node\_stack.pop();}
\DoxyCodeLine{01932\ \ \ \ \ PhyloNode\&\ node\ =\ nodes[index.getVectorIndex()];}
\DoxyCodeLine{01933\ \ \ \ \ \textcolor{comment}{//\ MiniIndex\ mini\_index\ =\ index.getMiniIndex();}}
\DoxyCodeLine{01934\ }
\DoxyCodeLine{01935\ \ \ \ \ \textcolor{comment}{//\ add\ all\ children\ of\ the\ current\ nodes\ to\ the\ stack\ for\ further\ traversing}}
\DoxyCodeLine{01936\ \ \ \ \ \textcolor{comment}{//\ later}}
\DoxyCodeLine{01937\ \ \ \ \ \textcolor{comment}{/*for\ (Index\ neighbor\_index:node.getNeighborIndexes(mini\_index))}}
\DoxyCodeLine{01938\ \textcolor{comment}{\ \ \ \ \ \ \ \ node\_stack.push(neighbor\_index);*/}}
\DoxyCodeLine{01939\ \ \ \ \ assert(index.getMiniIndex()\ ==\ TOP);}
\DoxyCodeLine{01940\ \ \ \ \ \textcolor{keywordflow}{if}\ (node.isInternal())\ \{}
\DoxyCodeLine{01941\ \ \ \ \ \ \ node\_stack.push(node.getNeighborIndex(RIGHT));}
\DoxyCodeLine{01942\ \ \ \ \ \ \ node\_stack.push(node.getNeighborIndex(LEFT));}
\DoxyCodeLine{01943\ \ \ \ \ \}}
\DoxyCodeLine{01944\ }
\DoxyCodeLine{01945\ \ \ \ \ \textcolor{comment}{//\ only\ process\ outdated\ node\ to\ avoid\ traversing\ the\ same\ part\ of\ the\ tree}}
\DoxyCodeLine{01946\ \ \ \ \ \textcolor{comment}{//\ multiple\ times}}
\DoxyCodeLine{01947\ \ \ \ \ \textcolor{keywordflow}{if}\ (node.isOutdated()\ \&\&\ node.getSPRCount()\ <=\ 5)\ \{}
\DoxyCodeLine{01948\ \ \ \ \ \ \ node.setOutdated(\textcolor{keyword}{false});}
\DoxyCodeLine{01949\ }
\DoxyCodeLine{01950\ \ \ \ \ \ \ \textcolor{comment}{//\ if\ checkEachSPR:}}
\DoxyCodeLine{01951\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ root=node}}
\DoxyCodeLine{01952\ \ \ \ \ \ \ \textcolor{comment}{//\ \ while\ root.up!=None:}}
\DoxyCodeLine{01953\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ root=root.up}}
\DoxyCodeLine{01954\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \#print("{}Pre-\/SPR\ tree:\ "{}+createBinaryNewick(root))}}
\DoxyCodeLine{01955\ \ \ \ \ \ \ \textcolor{comment}{//\ \ oldTreeLK=calculateTreeLikelihood(root,mutMatrix,checkCorrectness=True)}}
\DoxyCodeLine{01956\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \#print("{}Pre-\/SPR\ tree\ likelihood:\ "{}+str(oldTreeLK))}}
\DoxyCodeLine{01957\ \ \ \ \ \ \ \textcolor{comment}{//\ reCalculateAllGenomeLists(root,mutMatrix,\ checkExistingAreCorrect=True)}}
\DoxyCodeLine{01958\ }
\DoxyCodeLine{01959\ \ \ \ \ \ \ \textcolor{comment}{//\ do\ SPR\ moves\ to\ improve\ the\ tree}}
\DoxyCodeLine{01960\ \ \ \ \ \ \ RealNumType\ improvement\ =}
\DoxyCodeLine{01961\ \ \ \ \ \ \ \ \ \ \ improveSubTree<num\_states>(index,\ node,\ short\_range\_search);}
\DoxyCodeLine{01962\ }
\DoxyCodeLine{01963\ \ \ \ \ \ \ \textcolor{comment}{//\ if\ checkEachSPR:}}
\DoxyCodeLine{01964\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \#print("{}\ apparent\ improvement\ "{}+str(improvement))}}
\DoxyCodeLine{01965\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ root=node}}
\DoxyCodeLine{01966\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ while\ root.up!=None:}}
\DoxyCodeLine{01967\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ root=root.up}}
\DoxyCodeLine{01968\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \#print("{}Post-\/SPR\ tree:\ "{}+createBinaryNewick(root))}}
\DoxyCodeLine{01969\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ newTreeLK=calculateTreeLikelihood(root,mutMatrix)}}
\DoxyCodeLine{01970\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ reCalculateAllGenomeLists(root,mutMatrix,}}
\DoxyCodeLine{01971\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ checkExistingAreCorrect=True)}}
\DoxyCodeLine{01972\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \#print("{}Post-\/SPR\ tree\ likelihood:\ "{}+str(newTreeLK))}}
\DoxyCodeLine{01973\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ if\ newTreeLK-\/oldTreeLK\ <\ improvement-\/1.0:}}
\DoxyCodeLine{01974\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ print("{}In\ startTopologyUpdates,\ LK\ score\ of\ improvement}}
\DoxyCodeLine{01975\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}+str(newTreeLK)+"{}\ -\/\ "{}+str(oldTreeLK)+"{}\ =}}
\DoxyCodeLine{01976\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}+str(newTreeLK-\/oldTreeLK)+"{}\ is\ less\ than\ //what\ is}}
\DoxyCodeLine{01977\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ supposd\ to\ be\ "{}+str(improvement))}}
\DoxyCodeLine{01978\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ exit()}}
\DoxyCodeLine{01979\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01980\ }
\DoxyCodeLine{01981\ \ \ \ \ \ \ \textcolor{comment}{//\ update\ total\_improvement}}
\DoxyCodeLine{01982\ \ \ \ \ \ \ total\_improvement\ +=\ improvement;}
\DoxyCodeLine{01983\ }
\DoxyCodeLine{01984\ \ \ \ \ \ \ \textcolor{comment}{//\ NHANLT:\ LOGS\ FOR\ DEBUGGING}}
\DoxyCodeLine{01985\ \ \ \ \ \ \ \textcolor{comment}{/*if\ (params-\/>debug\ \&\&\ improvement\ >\ 0)}}
\DoxyCodeLine{01986\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ std::cout\ <<\ num\_nodes\ <<\ "{}:\ "{}\ <<\ std::setprecision(20)\ <<}}
\DoxyCodeLine{01987\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ total\_improvement\ <<\ std::endl;*/}}
\DoxyCodeLine{01988\ }
\DoxyCodeLine{01989\ \ \ \ \ \ \ \textcolor{comment}{//\ Show\ log\ every\ 1000\ nodes}}
\DoxyCodeLine{01990\ \ \ \ \ \ \ ++num\_nodes;}
\DoxyCodeLine{01991\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cmaple::verbose\_mode\ >=\ cmaple::VB\_MED\ \&\&\ num\_nodes\ -\/\ count\_node\_1K\ >=\ 1000)\ \{}
\DoxyCodeLine{01992\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Processed\ topology\ for\ "{}}\ <<\ convertIntToString(num\_nodes)}
\DoxyCodeLine{01993\ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ nodes."{}}\ <<\ std::endl;}
\DoxyCodeLine{01994\ \ \ \ \ \ \ \ \ count\_node\_1K\ =\ num\_nodes;}
\DoxyCodeLine{01995\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01996\ \ \ \ \ \}}
\DoxyCodeLine{01997\ \ \ \}}
\DoxyCodeLine{01998\ }
\DoxyCodeLine{01999\ \ \ \textcolor{keywordflow}{return}\ total\_improvement;}
\DoxyCodeLine{02000\ \}}
\DoxyCodeLine{02001\ }
\DoxyCodeLine{02002\ \textcolor{keyword}{template}\ <const\ StateType\ num\_states>}
\DoxyCodeLine{02003\ \textcolor{keywordtype}{void}\ cmaple::Tree::updateModelParams()\ \{}
\DoxyCodeLine{02004\ \ \ assert(aln);}
\DoxyCodeLine{02005\ \ \ assert(model);}
\DoxyCodeLine{02006\ \ \ \ \ }
\DoxyCodeLine{02007\ \ \ \textcolor{comment}{//\ perform\ a\ DFS\ -\/>\ at\ each\ leaf,\ update\ the\ pesudoCount\ of\ the\ model\ based\ on}}
\DoxyCodeLine{02008\ \ \ \textcolor{comment}{//\ the\ sequence\ of\ that\ leaf}}
\DoxyCodeLine{02009\ \ \ performDFSAtLeave<\&cmaple::Tree::updatePesudoCountModel<num\_states>>();}
\DoxyCodeLine{02010\ }
\DoxyCodeLine{02011\ \ \ \textcolor{comment}{//\ update\ model\ params\ based\ on\ the\ pseudo\ count}}
\DoxyCodeLine{02012\ \ \ \textcolor{keywordflow}{if}\ (model-\/>updateMutationMatEmpirical())\ \{}
\DoxyCodeLine{02013\ \ \ \ \ computeCumulativeRate();}
\DoxyCodeLine{02014\ \ \ \}}
\DoxyCodeLine{02015\ \}}
\DoxyCodeLine{02016\ }
\DoxyCodeLine{02017\ \textcolor{keyword}{template}\ <const\ StateType\ num\_states>}
\DoxyCodeLine{02018\ \textcolor{keywordtype}{void}\ cmaple::Tree::seekSamplePlacement(}
\DoxyCodeLine{02019\ \ \ \ \ \textcolor{keyword}{const}\ Index\ start\_node\_index,}
\DoxyCodeLine{02020\ \ \ \ \ \textcolor{keyword}{const}\ NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{02021\ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample\_regions,}
\DoxyCodeLine{02022\ \ \ \ \ Index\&\ selected\_node\_index,}
\DoxyCodeLine{02023\ \ \ \ \ RealNumType\&\ best\_lh\_diff,}
\DoxyCodeLine{02024\ \ \ \ \ \textcolor{keywordtype}{bool}\&\ is\_mid\_branch,}
\DoxyCodeLine{02025\ \ \ \ \ RealNumType\&\ best\_up\_lh\_diff,}
\DoxyCodeLine{02026\ \ \ \ \ RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{02027\ \ \ \ \ Index\&\ best\_child\_index)\ \{}
\DoxyCodeLine{02028\ \ \ assert(sample\_regions\ \&\&\ sample\_regions-\/>size()\ >\ 0);}
\DoxyCodeLine{02029\ \ \ assert(seq\_name\_index\ >=\ 0);}
\DoxyCodeLine{02030\ \ \ assert(aln);}
\DoxyCodeLine{02031\ \ \ assert(model);}
\DoxyCodeLine{02032\ \ \ assert(cumulative\_rate);}
\DoxyCodeLine{02033\ \ \ \ \ }
\DoxyCodeLine{02034\ \ \ \textcolor{comment}{//\ init\ variables}}
\DoxyCodeLine{02035\ \ \ \textcolor{comment}{//\ output\ variables}}
\DoxyCodeLine{02036\ \ \ selected\_node\_index\ =\ start\_node\_index;}
\DoxyCodeLine{02037\ \ \ \textcolor{comment}{//\ dummy\ variables}}
\DoxyCodeLine{02038\ \ \ RealNumType\ lh\_diff\_mid\_branch\ =\ 0;}
\DoxyCodeLine{02039\ \ \ RealNumType\ lh\_diff\_at\_node\ =\ 0;}
\DoxyCodeLine{02040\ \ \ PositionType\ seq\_length\ =\ \textcolor{keyword}{static\_cast<}PositionType\textcolor{keyword}{>}(aln-\/>ref\_seq.size());}
\DoxyCodeLine{02041\ \ \ \textcolor{comment}{//\ stack\ of\ nodes\ to\ examine\ positions}}
\DoxyCodeLine{02042\ \ \ std::stack<TraversingNode>\ extended\_node\_stack;}
\DoxyCodeLine{02043\ \ \ extended\_node\_stack.push(TraversingNode(start\_node\_index,\ 0,\ MIN\_NEGATIVE));}
\DoxyCodeLine{02044\ }
\DoxyCodeLine{02045\ \ \ \textcolor{comment}{//\ recursively\ examine\ positions\ for\ placing\ the\ new\ sample}}
\DoxyCodeLine{02046\ \ \ \textcolor{keywordflow}{while}\ (!extended\_node\_stack.empty())\ \{}
\DoxyCodeLine{02047\ \ \ \ \ TraversingNode\ current\_extended\_node\ =\ std::move(extended\_node\_stack.top());}
\DoxyCodeLine{02048\ \ \ \ \ extended\_node\_stack.pop();}
\DoxyCodeLine{02049\ \ \ \ \ \textcolor{keyword}{const}\ NumSeqsType\ current\_node\_vec\ =}
\DoxyCodeLine{02050\ \ \ \ \ \ \ \ \ current\_extended\_node.getIndex().getVectorIndex();}
\DoxyCodeLine{02051\ \ \ \ \ PhyloNode\&\ current\_node\ =\ nodes[current\_node\_vec];}
\DoxyCodeLine{02052\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\&\ is\_internal\ =\ current\_node.isInternal();}
\DoxyCodeLine{02053\ }
\DoxyCodeLine{02054\ \ \ \ \ \textcolor{comment}{//\ NHANLT:\ debug}}
\DoxyCodeLine{02055\ \ \ \ \ \textcolor{comment}{//\ if\ (current\_node-\/>next\ \&\&\ ((current\_node-\/>next-\/>neighbor\ \&\&}}
\DoxyCodeLine{02056\ \ \ \ \ \textcolor{comment}{//\ current\_node-\/>next-\/>neighbor-\/>seq\_name\ ==\ "{}25"{})}}
\DoxyCodeLine{02057\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ (current\_node-\/>next-\/>next-\/>neighbor\ \&\&}}
\DoxyCodeLine{02058\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ current\_node-\/>next-\/>next-\/>neighbor-\/>seq\_name\ ==}}
\DoxyCodeLine{02059\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}25"{})))}}
\DoxyCodeLine{02060\ \ \ \ \ \textcolor{comment}{//\ cout\ <<\ "{}fdsfsd"{};}}
\DoxyCodeLine{02061\ }
\DoxyCodeLine{02062\ \ \ \ \ \textcolor{comment}{//\ if\ the\ current\ node\ is\ a\ leaf\ AND\ the\ new\ sample/sequence\ is\ strictly}}
\DoxyCodeLine{02063\ \ \ \ \ \textcolor{comment}{//\ less\ informative\ than\ the\ current\ node}}
\DoxyCodeLine{02064\ \ \ \ \ \textcolor{comment}{//\ -\/>\ add\ the\ new\ sequence\ into\ the\ list\ of\ minor\ sequences\ of\ the\ current}}
\DoxyCodeLine{02065\ \ \ \ \ \textcolor{comment}{//\ node\ +\ stop\ seeking\ the\ placement}}
\DoxyCodeLine{02066\ \ \ \ \ \textcolor{keywordflow}{if}\ ((!is\_internal)\ \&\&}
\DoxyCodeLine{02067\ \ \ \ \ \ \ \ \ (current\_node.getPartialLh(TOP)-\/>compareWithSample(}
\DoxyCodeLine{02068\ \ \ \ \ \ \ \ \ \ \ \ \ \ *sample\_regions,\ seq\_length,\ aln)\ ==\ 1))\ \{}
\DoxyCodeLine{02069\ \ \ \ \ \ \ current\_node.addLessInfoSeqs(seq\_name\_index);}
\DoxyCodeLine{02070\ \ \ \ \ \ \ selected\_node\_index\ =\ Index();}
\DoxyCodeLine{02071\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02072\ \ \ \ \ \}}
\DoxyCodeLine{02073\ }
\DoxyCodeLine{02074\ \ \ \ \ \textcolor{keyword}{const}\ RealNumType\ current\_node\_blength\ =\ current\_node.getUpperLength();}
\DoxyCodeLine{02075\ }
\DoxyCodeLine{02076\ \ \ \ \ \textcolor{comment}{//\ 1.\ try\ first\ placing\ as\ a\ descendant\ of\ the\ mid-\/branch\ point\ of\ the}}
\DoxyCodeLine{02077\ \ \ \ \ \textcolor{comment}{//\ branch\ above\ the\ current\ node}}
\DoxyCodeLine{02078\ \ \ \ \ \textcolor{keywordflow}{if}\ (root\_vector\_index\ !=\ current\_node\_vec\ \&\&\ current\_node\_blength\ >\ 0)\ \{}
\DoxyCodeLine{02079\ \ \ \ \ \ \ examineSamplePlacementMidBranch<num\_states>(}
\DoxyCodeLine{02080\ \ \ \ \ \ \ \ \ \ \ selected\_node\_index,\ current\_node.getMidBranchLh(),\ best\_lh\_diff,}
\DoxyCodeLine{02081\ \ \ \ \ \ \ \ \ \ \ is\_mid\_branch,\ lh\_diff\_mid\_branch,\ current\_extended\_node,}
\DoxyCodeLine{02082\ \ \ \ \ \ \ \ \ \ \ sample\_regions);}
\DoxyCodeLine{02083\ \ \ \ \ \}}
\DoxyCodeLine{02084\ \ \ \ \ \textcolor{comment}{//\ otherwise,\ don't\ consider\ mid-\/branch\ point}}
\DoxyCodeLine{02085\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02086\ \ \ \ \ \ \ lh\_diff\_mid\_branch\ =\ MIN\_NEGATIVE;}
\DoxyCodeLine{02087\ \ \ \ \ \}}
\DoxyCodeLine{02088\ }
\DoxyCodeLine{02089\ \ \ \ \ \textcolor{comment}{//\ 2.\ try\ to\ place\ as\ descendant\ of\ the\ current\ node\ (this\ is\ skipped\ if\ the}}
\DoxyCodeLine{02090\ \ \ \ \ \textcolor{comment}{//\ node\ has\ top\ branch\ length\ 0\ and\ so\ is\ part\ of\ a\ polytomy).}}
\DoxyCodeLine{02091\ \ \ \ \ \textcolor{keywordflow}{if}\ (root\_vector\_index\ ==\ current\_node\_vec\ ||\ current\_node\_blength\ >\ 0)\ \{}
\DoxyCodeLine{02092\ \ \ \ \ \ \ examineSamplePlacementAtNode<num\_states>(}
\DoxyCodeLine{02093\ \ \ \ \ \ \ \ \ \ \ selected\_node\_index,\ current\_node.getTotalLh(),\ best\_lh\_diff,}
\DoxyCodeLine{02094\ \ \ \ \ \ \ \ \ \ \ is\_mid\_branch,\ lh\_diff\_at\_node,\ lh\_diff\_mid\_branch,\ best\_up\_lh\_diff,}
\DoxyCodeLine{02095\ \ \ \ \ \ \ \ \ \ \ best\_down\_lh\_diff,\ best\_child\_index,\ current\_extended\_node,}
\DoxyCodeLine{02096\ \ \ \ \ \ \ \ \ \ \ sample\_regions);}
\DoxyCodeLine{02097\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02098\ \ \ \ \ \ \ lh\_diff\_at\_node\ =\ current\_extended\_node.getLhDiff();}
\DoxyCodeLine{02099\ \ \ \ \ \}}
\DoxyCodeLine{02100\ }
\DoxyCodeLine{02101\ \ \ \ \ \textcolor{comment}{//\ keep\ trying\ to\ place\ at\ children\ nodes,\ unless\ the\ number\ of\ attempts\ has}}
\DoxyCodeLine{02102\ \ \ \ \ \textcolor{comment}{//\ reaches\ the\ failure\ limit}}
\DoxyCodeLine{02103\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{short}\ \textcolor{keywordtype}{int}\ failure\_count\ =\ current\_extended\_node.getFailureCount();}
\DoxyCodeLine{02104\ \ \ \ \ \textcolor{keywordflow}{if}\ ((params-\/>strict\_stop\_seeking\_placement\_sample\ \&\&}
\DoxyCodeLine{02105\ \ \ \ \ \ \ \ \ \ failure\_count\ <=\ params-\/>failure\_limit\_sample\ \&\&}
\DoxyCodeLine{02106\ \ \ \ \ \ \ \ \ \ lh\_diff\_at\_node\ >\ (best\_lh\_diff\ -\/\ params-\/>thresh\_log\_lh\_sample))\ ||}
\DoxyCodeLine{02107\ \ \ \ \ \ \ \ \ (!params-\/>strict\_stop\_seeking\_placement\_sample\ \&\&}
\DoxyCodeLine{02108\ \ \ \ \ \ \ \ \ \ (failure\_count\ <=\ params-\/>failure\_limit\_sample\ ||}
\DoxyCodeLine{02109\ \ \ \ \ \ \ \ \ \ \ lh\_diff\_at\_node\ >\ (best\_lh\_diff\ -\/\ params-\/>thresh\_log\_lh\_sample))))\ \{}
\DoxyCodeLine{02110\ \ \ \ \ \ \ \textcolor{comment}{/*for\ (Index\ neighbor\_index:current\_node.getNeighborIndexes(TOP))}}
\DoxyCodeLine{02111\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ extended\_node\_stack.push(TraversingNode(neighbor\_index,}}
\DoxyCodeLine{02112\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ current\_extended\_node.getFailureCount(),\ lh\_diff\_at\_node));*/}}
\DoxyCodeLine{02113\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_internal)\ \{}
\DoxyCodeLine{02114\ \ \ \ \ \ \ \ \ extended\_node\_stack.push(}
\DoxyCodeLine{02115\ \ \ \ \ \ \ \ \ \ \ \ \ TraversingNode(current\_node.getNeighborIndex(RIGHT),\ failure\_count,}
\DoxyCodeLine{02116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lh\_diff\_at\_node));}
\DoxyCodeLine{02117\ \ \ \ \ \ \ \ \ extended\_node\_stack.push(}
\DoxyCodeLine{02118\ \ \ \ \ \ \ \ \ \ \ \ \ TraversingNode(current\_node.getNeighborIndex(LEFT),\ failure\_count,}
\DoxyCodeLine{02119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lh\_diff\_at\_node));}
\DoxyCodeLine{02120\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02121\ \ \ \ \ \}}
\DoxyCodeLine{02122\ \ \ \}}
\DoxyCodeLine{02123\ }
\DoxyCodeLine{02124\ \ \ \textcolor{comment}{//\ exploration\ of\ the\ tree\ is\ finished,\ and\ we\ are\ left\ with\ the\ node\ found\ so}}
\DoxyCodeLine{02125\ \ \ \textcolor{comment}{//\ far\ with\ the\ best\ appending\ likelihood\ cost.\ Now\ we\ explore\ placement\ just}}
\DoxyCodeLine{02126\ \ \ \textcolor{comment}{//\ below\ this\ node\ for\ more\ fine-\/grained\ placement\ within\ its\ descendant}}
\DoxyCodeLine{02127\ \ \ \textcolor{comment}{//\ branches.}}
\DoxyCodeLine{02128\ \ \ best\_down\_lh\_diff\ =\ MIN\_NEGATIVE;}
\DoxyCodeLine{02129\ \ \ best\_child\_index\ =\ Index();}
\DoxyCodeLine{02130\ }
\DoxyCodeLine{02131\ \ \ \textcolor{comment}{//\ if\ best\ position\ so\ far\ is\ the\ descendant\ of\ a\ node\ -\/>\ explore\ further\ at}}
\DoxyCodeLine{02132\ \ \ \textcolor{comment}{//\ its\ children}}
\DoxyCodeLine{02133\ \ \ \textcolor{keywordflow}{if}\ (!is\_mid\_branch)\ \{}
\DoxyCodeLine{02134\ \ \ \ \ finetuneSamplePlacementAtNode<num\_states>(}
\DoxyCodeLine{02135\ \ \ \ \ \ \ \ \ nodes[selected\_node\_index.getVectorIndex()],\ best\_down\_lh\_diff,}
\DoxyCodeLine{02136\ \ \ \ \ \ \ \ \ best\_child\_index,\ sample\_regions);}
\DoxyCodeLine{02137\ \ \ \}}
\DoxyCodeLine{02138\ \}}
\DoxyCodeLine{02139\ }
\DoxyCodeLine{02140\ \textcolor{keyword}{template}\ <const\ StateType\ num\_states>}
\DoxyCodeLine{02141\ \textcolor{keywordtype}{void}\ cmaple::Tree::placeNewSampleAtNode(\textcolor{keyword}{const}\ Index\ selected\_node\_index,}
\DoxyCodeLine{02142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{02143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{02144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ RealNumType\ best\_lh\_diff,}
\DoxyCodeLine{02145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ RealNumType\ best\_up\_lh\_diff,}
\DoxyCodeLine{02146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ RealNumType\ best\_down\_lh\_diff,}
\DoxyCodeLine{02147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Index\ best\_child\_index)\ \{}
\DoxyCodeLine{02148\ \ \ \textcolor{comment}{//\ dummy\ variables}}
\DoxyCodeLine{02149\ \ \ RealNumType\ best\_child\_lh\ =\ MIN\_NEGATIVE;}
\DoxyCodeLine{02150\ \ \ RealNumType\ best\_child\_blength\_split\ =\ 0;}
\DoxyCodeLine{02151\ \ \ RealNumType\ best\_parent\_lh;}
\DoxyCodeLine{02152\ \ \ RealNumType\ best\_parent\_blength\_split\ =\ 0;}
\DoxyCodeLine{02153\ \ \ RealNumType\ best\_root\_blength\ =\ -\/1;}
\DoxyCodeLine{02154\ \ \ \textcolor{keyword}{const}\ RealNumType\ threshold\_prob\ =\ params-\/>threshold\_prob;}
\DoxyCodeLine{02155\ \ \ std::unique\_ptr<SeqRegions>\ best\_parent\_regions\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02156\ \ \ std::unique\_ptr<SeqRegions>\ best\_child\_regions\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02157\ }
\DoxyCodeLine{02158\ \ \ assert(selected\_node\_index.getMiniIndex()\ ==\ TOP);}
\DoxyCodeLine{02159\ \ \ assert(sample\ \&\&\ sample-\/>size()\ >\ 0);}
\DoxyCodeLine{02160\ \ \ assert(seq\_name\_index\ >=\ 0);}
\DoxyCodeLine{02161\ \ \ assert(aln);}
\DoxyCodeLine{02162\ \ \ assert(model);}
\DoxyCodeLine{02163\ \ \ assert(cumulative\_rate);}
\DoxyCodeLine{02164\ \ \ \ \ }
\DoxyCodeLine{02165\ \ \ \textcolor{keyword}{const}\ NumSeqsType\ selected\_node\_vec\_index\ =}
\DoxyCodeLine{02166\ \ \ \ \ \ \ selected\_node\_index.getVectorIndex();}
\DoxyCodeLine{02167\ \ \ PhyloNode\&\ selected\_node\ =\ nodes[selected\_node\_vec\_index];}
\DoxyCodeLine{02168\ }
\DoxyCodeLine{02169\ \ \ \textcolor{comment}{//\ place\ the\ new\ sample\ as\ a\ descendant\ of\ an\ existing\ node}}
\DoxyCodeLine{02170\ \ \ \textcolor{keywordflow}{if}\ (best\_child\_index.getMiniIndex()\ !=\ UNDEFINED)\ \{}
\DoxyCodeLine{02171\ \ \ \ \ PhyloNode\&\ best\_child\ =\ nodes[best\_child\_index.getVectorIndex()];}
\DoxyCodeLine{02172\ \ \ \ \ best\_child\_lh\ =\ best\_down\_lh\_diff;}
\DoxyCodeLine{02173\ \ \ \ \ assert(best\_child\_index.getMiniIndex()\ ==\ TOP);}
\DoxyCodeLine{02174\ \ \ \ \ best\_child\_blength\_split\ =}
\DoxyCodeLine{02175\ \ \ \ \ \ \ \ \ 0.5\ *\ best\_child.getUpperLength();\ \ \textcolor{comment}{//\ best\_child-\/>length;}}
\DoxyCodeLine{02176\ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions\ =}
\DoxyCodeLine{02177\ \ \ \ \ \ \ \ \ getPartialLhAtNode(best\_child.getNeighborIndex(}
\DoxyCodeLine{02178\ \ \ \ \ \ \ \ \ \ \ \ \ TOP));\ \ \textcolor{comment}{//\ best\_child-\/>neighbor-\/>getPartialLhAtNode(aln,}}
\DoxyCodeLine{02179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ model,\ threshold\_prob);}}
\DoxyCodeLine{02180\ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions\ =\ best\_child.getPartialLh(}
\DoxyCodeLine{02181\ \ \ \ \ \ \ \ \ TOP);\ \ \textcolor{comment}{//\ -\/>getPartialLhAtNode(aln,\ model,\ threshold\_prob);}}
\DoxyCodeLine{02182\ \ \ \ \ \textcolor{comment}{//\ best\_child\_regions\ =\ new\ SeqRegions(best\_child-\/>mid\_branch\_lh);}}
\DoxyCodeLine{02183\ \ \ \ \ \textcolor{comment}{//\ SeqRegions\ best\_child\_mid\_clone\ =}}
\DoxyCodeLine{02184\ \ \ \ \ \textcolor{comment}{//\ SeqRegions(best\_child.getMidBranchLh());}}
\DoxyCodeLine{02185\ \ \ \ \ best\_child\_regions\ =}
\DoxyCodeLine{02186\ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr};\ \ \textcolor{comment}{//\ cmaple::make\_unique<SeqRegions>(std::move(best\_child\_mid\_clone));}}
\DoxyCodeLine{02187\ }
\DoxyCodeLine{02188\ \ \ \ \ \textcolor{comment}{//\ try\ a\ shorter\ split}}
\DoxyCodeLine{02189\ \ \ \ \ \textcolor{comment}{//\ tryShorterBranch<\&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(best\_child-\/>length,}}
\DoxyCodeLine{02190\ \ \ \ \ \textcolor{comment}{//\ best\_child\_regions,\ sample,\ upper\_left\_right\_regions,\ lower\_regions,}}
\DoxyCodeLine{02191\ \ \ \ \ \textcolor{comment}{//\ best\_child\_lh,\ best\_child\_blength\_split,\ default\_blength,\ true);}}
\DoxyCodeLine{02192\ \ \ \ \ tryShorterBranch<num\_states,}
\DoxyCodeLine{02193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(}
\DoxyCodeLine{02194\ \ \ \ \ \ \ \ \ best\_child.getUpperLength(),\ best\_child\_regions,\ sample,}
\DoxyCodeLine{02195\ \ \ \ \ \ \ \ \ upper\_left\_right\_regions,\ lower\_regions,\ best\_child\_lh,}
\DoxyCodeLine{02196\ \ \ \ \ \ \ \ \ best\_child\_blength\_split,\ default\_blength,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02197\ }
\DoxyCodeLine{02198\ \ \ \ \ \textcolor{comment}{//\ Delay\ cloning\ SeqRegions}}
\DoxyCodeLine{02199\ \ \ \ \ \textcolor{keywordflow}{if}\ (!best\_child\_regions)\ \{}
\DoxyCodeLine{02200\ \ \ \ \ \ \ best\_child\_regions\ =}
\DoxyCodeLine{02201\ \ \ \ \ \ \ \ \ \ \ cmaple::make\_unique<SeqRegions>(SeqRegions(best\_child.getMidBranchLh()));}
\DoxyCodeLine{02202\ \ \ \ \ \}}
\DoxyCodeLine{02203\ \ \ \}}
\DoxyCodeLine{02204\ }
\DoxyCodeLine{02205\ \ \ \textcolor{comment}{//\ if\ node\ is\ root,\ try\ to\ place\ as\ sibling\ of\ the\ current\ root.}}
\DoxyCodeLine{02206\ \ \ RealNumType\ old\_root\_lh\ =\ MIN\_NEGATIVE;}
\DoxyCodeLine{02207\ \ \ \textcolor{keywordflow}{if}\ (root\_vector\_index\ ==\ selected\_node\_vec\_index)\ \{}
\DoxyCodeLine{02208\ \ \ \ \ \textcolor{comment}{/*old\_root\_lh\ =\ selected\_node-\/>getPartialLhAtNode(aln,\ model,}}
\DoxyCodeLine{02209\ \textcolor{comment}{\ \ \ \ threshold\_prob)-\/>computeAbsoluteLhAtRoot(num\_states,\ model);\ SeqRegions*}}
\DoxyCodeLine{02210\ \textcolor{comment}{\ \ \ \ lower\_regions\ =\ selected\_node-\/>getPartialLhAtNode(aln,\ model,}}
\DoxyCodeLine{02211\ \textcolor{comment}{\ \ \ \ threshold\_prob);*/}}
\DoxyCodeLine{02212\ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions\ =}
\DoxyCodeLine{02213\ \ \ \ \ \ \ \ \ selected\_node.getPartialLh(TOP);}
\DoxyCodeLine{02214\ \ \ \ \ old\_root\_lh\ =\ lower\_regions-\/>computeAbsoluteLhAtRoot<num\_states>(}
\DoxyCodeLine{02215\ \ \ \ \ \ \ \ \ model,\ cumulative\_base);}
\DoxyCodeLine{02216\ }
\DoxyCodeLine{02217\ \ \ \ \ \textcolor{comment}{//\ merge\ 2\ lower\ vector\ into\ one}}
\DoxyCodeLine{02218\ \ \ \ \ RealNumType\ new\_root\_lh\ =\ lower\_regions-\/>mergeTwoLowers<num\_states>(}
\DoxyCodeLine{02219\ \ \ \ \ \ \ \ \ best\_parent\_regions,\ default\_blength,\ *sample,\ default\_blength,\ aln,}
\DoxyCodeLine{02220\ \ \ \ \ \ \ \ \ model,\ cumulative\_rate,\ threshold\_prob,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02221\ }
\DoxyCodeLine{02222\ \ \ \ \ new\_root\_lh\ +=\ best\_parent\_regions-\/>computeAbsoluteLhAtRoot<num\_states>(}
\DoxyCodeLine{02223\ \ \ \ \ \ \ \ \ model,\ cumulative\_base);}
\DoxyCodeLine{02224\ \ \ \ \ best\_parent\_lh\ =\ new\_root\_lh;}
\DoxyCodeLine{02225\ }
\DoxyCodeLine{02226\ \ \ \ \ \textcolor{comment}{//\ try\ shorter\ branch\ lengths}}
\DoxyCodeLine{02227\ \ \ \ \ best\_root\_blength\ =\ default\_blength;}
\DoxyCodeLine{02228\ \ \ \ \ tryShorterBranchAtRoot<num\_states>(sample,\ lower\_regions,}
\DoxyCodeLine{02229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ best\_parent\_regions,\ best\_root\_blength,}
\DoxyCodeLine{02230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ best\_parent\_lh,\ default\_blength);}
\DoxyCodeLine{02231\ }
\DoxyCodeLine{02232\ \ \ \ \ \textcolor{comment}{//\ update\ best\_parent\_lh\ (taking\ into\ account\ old\_root\_lh)}}
\DoxyCodeLine{02233\ \ \ \ \ best\_parent\_lh\ -\/=\ old\_root\_lh;}
\DoxyCodeLine{02234\ \ \ \}}
\DoxyCodeLine{02235\ \ \ \textcolor{comment}{//\ selected\_node\ is\ not\ root}}
\DoxyCodeLine{02236\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02237\ \ \ \ \ best\_parent\_lh\ =\ best\_up\_lh\_diff;}
\DoxyCodeLine{02238\ \ \ \ \ best\_parent\_blength\_split\ =}
\DoxyCodeLine{02239\ \ \ \ \ \ \ \ \ 0.5\ *\ selected\_node.getUpperLength();\ \ \textcolor{comment}{//\ selected\_node-\/>length;}}
\DoxyCodeLine{02240\ \ \ \ \ \textcolor{comment}{/*SeqRegions*\ upper\_left\_right\_regions\ =}}
\DoxyCodeLine{02241\ \textcolor{comment}{\ \ \ \ selected\_node-\/>neighbor-\/>getPartialLhAtNode(aln,\ model,\ threshold\_prob);}}
\DoxyCodeLine{02242\ \textcolor{comment}{\ \ \ \ SeqRegions*\ lower\_regions\ =\ selected\_node-\/>getPartialLhAtNode(aln,\ model,}}
\DoxyCodeLine{02243\ \textcolor{comment}{\ \ \ \ threshold\_prob);\ best\_parent\_regions\ =\ new}}
\DoxyCodeLine{02244\ \textcolor{comment}{\ \ \ \ SeqRegions(selected\_node-\/>mid\_branch\_lh);*/}}
\DoxyCodeLine{02245\ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions\ =}
\DoxyCodeLine{02246\ \ \ \ \ \ \ \ \ getPartialLhAtNode(selected\_node.getNeighborIndex(TOP));}
\DoxyCodeLine{02247\ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions\ =}
\DoxyCodeLine{02248\ \ \ \ \ \ \ \ \ selected\_node.getPartialLh(TOP);}
\DoxyCodeLine{02249\ \ \ \ \ \textcolor{comment}{//\ SeqRegions\ seq\_regions\_clone\ =}}
\DoxyCodeLine{02250\ \ \ \ \ \textcolor{comment}{//\ SeqRegions(selected\_node.getMidBranchLh());}}
\DoxyCodeLine{02251\ \ \ \ \ best\_parent\_regions\ =}
\DoxyCodeLine{02252\ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr};\ \ \textcolor{comment}{//\ cmaple::make\_unique<SeqRegions>(std::move(seq\_regions\_clone));}}
\DoxyCodeLine{02253\ }
\DoxyCodeLine{02254\ \ \ \ \ \textcolor{comment}{//\ try\ a\ shorter\ split}}
\DoxyCodeLine{02255\ \ \ \ \ \textcolor{comment}{//\ tryShorterBranch<\&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(selected\_node-\/>length,}}
\DoxyCodeLine{02256\ \ \ \ \ \textcolor{comment}{//\ best\_parent\_regions,\ sample,\ upper\_left\_right\_regions,\ lower\_regions,}}
\DoxyCodeLine{02257\ \ \ \ \ \textcolor{comment}{//\ best\_parent\_lh,\ best\_parent\_blength\_split,\ default\_blength,\ false);}}
\DoxyCodeLine{02258\ \ \ \ \ tryShorterBranch<num\_states,}
\DoxyCodeLine{02259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(}
\DoxyCodeLine{02260\ \ \ \ \ \ \ \ \ selected\_node.getUpperLength(),\ best\_parent\_regions,\ sample,}
\DoxyCodeLine{02261\ \ \ \ \ \ \ \ \ upper\_left\_right\_regions,\ lower\_regions,\ best\_parent\_lh,}
\DoxyCodeLine{02262\ \ \ \ \ \ \ \ \ best\_parent\_blength\_split,\ default\_blength,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02263\ }
\DoxyCodeLine{02264\ \ \ \ \ \textcolor{comment}{//\ Delay\ cloning\ SeqRegions}}
\DoxyCodeLine{02265\ \ \ \ \ \textcolor{keywordflow}{if}\ (!best\_parent\_regions)\ \{}
\DoxyCodeLine{02266\ \ \ \ \ \ \ best\_parent\_regions\ =\ cmaple::make\_unique<SeqRegions>(}
\DoxyCodeLine{02267\ \ \ \ \ \ \ \ \ \ \ SeqRegions(selected\_node.getMidBranchLh()));}
\DoxyCodeLine{02268\ \ \ \ \ \}}
\DoxyCodeLine{02269\ \ \ \}}
\DoxyCodeLine{02270\ }
\DoxyCodeLine{02271\ \ \ \textcolor{comment}{//\ if\ the\ best\ placement\ is\ below\ the\ selected\_node\ =>\ add\ an\ internal\ node}}
\DoxyCodeLine{02272\ \ \ \textcolor{comment}{//\ below\ the\ selected\_node}}
\DoxyCodeLine{02273\ \ \ \textcolor{keywordflow}{if}\ (best\_child\_lh\ >=\ best\_parent\_lh\ \&\&\ best\_child\_lh\ >=\ best\_lh\_diff)\ \{}
\DoxyCodeLine{02274\ \ \ \ \ assert(best\_child\_index.getMiniIndex()\ ==\ TOP);}
\DoxyCodeLine{02275\ \ \ \ \ PhyloNode\&\ best\_child\ =\ nodes[best\_child\_index.getVectorIndex()];}
\DoxyCodeLine{02276\ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions\ =}
\DoxyCodeLine{02277\ \ \ \ \ \ \ \ \ getPartialLhAtNode(best\_child.getNeighborIndex(}
\DoxyCodeLine{02278\ \ \ \ \ \ \ \ \ \ \ \ \ TOP));\ \ \textcolor{comment}{//\ best\_child-\/>neighbor-\/>getPartialLhAtNode(aln,}}
\DoxyCodeLine{02279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ model,\ threshold\_prob);}}
\DoxyCodeLine{02280\ }
\DoxyCodeLine{02281\ \ \ \ \ \textcolor{comment}{//\ Estimate\ the\ length\ for\ the\ new\ branch}}
\DoxyCodeLine{02282\ \ \ \ \ RealNumType\ best\_length\ =\ default\_blength;}
\DoxyCodeLine{02283\ \ \ \ \ estimateLengthNewBranch<}
\DoxyCodeLine{02284\ \ \ \ \ \ \ \ \ \&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(}
\DoxyCodeLine{02285\ \ \ \ \ \ \ \ \ best\_child\_lh,\ best\_child\_regions,\ sample,\ best\_length,\ max\_blength,}
\DoxyCodeLine{02286\ \ \ \ \ \ \ \ \ min\_blength,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02287\ }
\DoxyCodeLine{02288\ \ \ \ \ \textcolor{comment}{//\ create\ new\ internal\ node\ and\ append\ child\ to\ it}}
\DoxyCodeLine{02289\ \ \ \ \ \textcolor{comment}{//\ connectNewSample2Branch(sample,\ seq\_name\_index,\ best\_child,}}
\DoxyCodeLine{02290\ \ \ \ \ \textcolor{comment}{//\ best\_child\_blength\_split,\ best\_child-\/>length\ -\/\ best\_child\_blength\_split,}}
\DoxyCodeLine{02291\ \ \ \ \ \textcolor{comment}{//\ best\_length,\ best\_child\_regions,\ upper\_left\_right\_regions);}}
\DoxyCodeLine{02292\ \ \ \ \ connectNewSample2Branch<num\_states>(}
\DoxyCodeLine{02293\ \ \ \ \ \ \ \ \ sample,\ seq\_name\_index,\ best\_child\_index,\ best\_child,}
\DoxyCodeLine{02294\ \ \ \ \ \ \ \ \ best\_child\_blength\_split,}
\DoxyCodeLine{02295\ \ \ \ \ \ \ \ \ best\_child.getUpperLength()\ -\/\ best\_child\_blength\_split,\ best\_length,}
\DoxyCodeLine{02296\ \ \ \ \ \ \ \ \ best\_child\_regions,\ upper\_left\_right\_regions);}
\DoxyCodeLine{02297\ \ \ \}}
\DoxyCodeLine{02298\ \ \ \textcolor{comment}{//\ otherwise,\ add\ new\ parent\ to\ the\ selected\_node}}
\DoxyCodeLine{02299\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02300\ \ \ \ \ \textcolor{comment}{//\ new\ parent\ is\ actually\ part\ of\ a\ polytomy\ since\ best\ placement\ is\ exactly}}
\DoxyCodeLine{02301\ \ \ \ \ \textcolor{comment}{//\ at\ the\ node}}
\DoxyCodeLine{02302\ \ \ \ \ \textcolor{keywordflow}{if}\ (best\_lh\_diff\ >=\ best\_parent\_lh)\ \{}
\DoxyCodeLine{02303\ \ \ \ \ \ \ best\_root\_blength\ =\ -\/1;}
\DoxyCodeLine{02304\ \ \ \ \ \ \ best\_parent\_blength\_split\ =\ -\/1;}
\DoxyCodeLine{02305\ \ \ \ \ \ \ best\_parent\_lh\ =\ best\_lh\_diff;}
\DoxyCodeLine{02306\ \ \ \ \ \ \ \textcolor{comment}{/*if\ (best\_parent\_regions)\ delete\ best\_parent\_regions;}}
\DoxyCodeLine{02307\ \textcolor{comment}{\ \ \ \ \ \ best\_parent\_regions\ =\ NULL;*/}}
\DoxyCodeLine{02308\ \ \ \ \ \ \ best\_parent\_regions\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02309\ }
\DoxyCodeLine{02310\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (root\_vector\_index\ ==\ selected\_node\_vec\_index)\ \{}
\DoxyCodeLine{02311\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ selected\_node-\/>getPartialLhAtNode(aln,\ model,}}
\DoxyCodeLine{02312\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ threshold\_prob)-\/>mergeTwoLowers<num\_states>(best\_parent\_regions,}}
\DoxyCodeLine{02313\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ -\/1,\ *sample,\ default\_blength,\ aln,\ model,\ threshold\_prob);}}
\DoxyCodeLine{02314\ \ \ \ \ \ \ \ \ selected\_node.getPartialLh(TOP)-\/>mergeTwoLowers<num\_states>(}
\DoxyCodeLine{02315\ \ \ \ \ \ \ \ \ \ \ \ \ best\_parent\_regions,\ -\/1,\ *sample,\ default\_blength,\ aln,\ model,}
\DoxyCodeLine{02316\ \ \ \ \ \ \ \ \ \ \ \ \ cumulative\_rate,\ threshold\_prob);}
\DoxyCodeLine{02317\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02318\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ best\_parent\_regions\ =\ new\ SeqRegions(selected\_node-\/>total\_lh);}}
\DoxyCodeLine{02319\ \ \ \ \ \ \ \ \ SeqRegions\ seq\_regions\_clone\ =\ SeqRegions(selected\_node.getTotalLh());}
\DoxyCodeLine{02320\ \ \ \ \ \ \ \ \ best\_parent\_regions\ =}
\DoxyCodeLine{02321\ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::make\_unique<SeqRegions>(std::move(seq\_regions\_clone));}
\DoxyCodeLine{02322\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02323\ \ \ \ \ \}}
\DoxyCodeLine{02324\ }
\DoxyCodeLine{02325\ \ \ \ \ \textcolor{comment}{//\ add\ parent\ to\ the\ root}}
\DoxyCodeLine{02326\ \ \ \ \ \textcolor{keywordflow}{if}\ (root\_vector\_index\ ==\ selected\_node\_vec\_index)\ \{}
\DoxyCodeLine{02327\ \ \ \ \ \ \ \textcolor{comment}{//\ now\ try\ different\ lengths\ for\ right\ branch}}
\DoxyCodeLine{02328\ \ \ \ \ \ \ best\_parent\_lh\ +=\ old\_root\_lh;}
\DoxyCodeLine{02329\ \ \ \ \ \ \ RealNumType\ best\_length2\ =\ default\_blength;}
\DoxyCodeLine{02330\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions\ =}
\DoxyCodeLine{02331\ \ \ \ \ \ \ \ \ \ \ selected\_node.getPartialLh(}
\DoxyCodeLine{02332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TOP);\ \ \textcolor{comment}{//\ -\/>getPartialLhAtNode(aln,\ model,\ threshold\_prob);}}
\DoxyCodeLine{02333\ }
\DoxyCodeLine{02334\ \ \ \ \ \ \ estimateLengthNewBranchAtRoot<num\_states>(}
\DoxyCodeLine{02335\ \ \ \ \ \ \ \ \ \ \ sample,\ lower\_regions,\ best\_parent\_regions,\ best\_length2,}
\DoxyCodeLine{02336\ \ \ \ \ \ \ \ \ \ \ best\_parent\_lh,\ best\_root\_blength,\ min\_blength,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02337\ }
\DoxyCodeLine{02338\ \ \ \ \ \ \ \textcolor{comment}{//\ update\ best\_parent\_lh\ (taking\ into\ account\ old\_root\_lh)}}
\DoxyCodeLine{02339\ \ \ \ \ \ \ best\_parent\_lh\ -\/=\ old\_root\_lh;}
\DoxyCodeLine{02340\ }
\DoxyCodeLine{02341\ \ \ \ \ \ \ \textcolor{comment}{//\ add\ new\ sample\ to\ a\ new\ root}}
\DoxyCodeLine{02342\ \ \ \ \ \ \ connectNewSample2Root<num\_states>(}
\DoxyCodeLine{02343\ \ \ \ \ \ \ \ \ \ \ sample,\ seq\_name\_index,\ selected\_node\_index,\ selected\_node,}
\DoxyCodeLine{02344\ \ \ \ \ \ \ \ \ \ \ best\_root\_blength,\ best\_length2,\ best\_parent\_regions);}
\DoxyCodeLine{02345\ \ \ \ \ \}}
\DoxyCodeLine{02346\ \ \ \ \ \textcolor{comment}{//\ add\ parent\ to\ non-\/root\ node}}
\DoxyCodeLine{02347\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02348\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions\ =}
\DoxyCodeLine{02349\ \ \ \ \ \ \ \ \ \ \ getPartialLhAtNode(selected\_node.getNeighborIndex(}
\DoxyCodeLine{02350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TOP));\ \ \textcolor{comment}{//\ selected\_node-\/>neighbor-\/>getPartialLhAtNode(aln,}}
\DoxyCodeLine{02351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ model,\ threshold\_prob);}}
\DoxyCodeLine{02352\ }
\DoxyCodeLine{02353\ \ \ \ \ \ \ \textcolor{comment}{//\ now\ try\ different\ lengths\ for\ the\ new\ branch}}
\DoxyCodeLine{02354\ \ \ \ \ \ \ RealNumType\ best\_length\ =\ default\_blength;}
\DoxyCodeLine{02355\ \ \ \ \ \ \ estimateLengthNewBranch<}
\DoxyCodeLine{02356\ \ \ \ \ \ \ \ \ \ \ \&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(}
\DoxyCodeLine{02357\ \ \ \ \ \ \ \ \ \ \ best\_parent\_lh,\ best\_parent\_regions,\ sample,\ best\_length,\ max\_blength,}
\DoxyCodeLine{02358\ \ \ \ \ \ \ \ \ \ \ min\_blength,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02359\ }
\DoxyCodeLine{02360\ \ \ \ \ \ \ \textcolor{comment}{//\ now\ create\ new\ internal\ node\ and\ append\ child\ to\ it}}
\DoxyCodeLine{02361\ \ \ \ \ \ \ RealNumType\ down\_distance\ =\ best\_parent\_blength\_split;}
\DoxyCodeLine{02362\ \ \ \ \ \ \ RealNumType\ top\_distance\ =}
\DoxyCodeLine{02363\ \ \ \ \ \ \ \ \ \ \ selected\_node.getUpperLength()\ -\/}
\DoxyCodeLine{02364\ \ \ \ \ \ \ \ \ \ \ down\_distance;\ \ \textcolor{comment}{//\ selected\_node-\/>length\ -\/\ down\_distance;}}
\DoxyCodeLine{02365\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (best\_parent\_blength\_split\ <\ 0)\ \{}
\DoxyCodeLine{02366\ \ \ \ \ \ \ \ \ down\_distance\ =\ -\/1;}
\DoxyCodeLine{02367\ \ \ \ \ \ \ \ \ top\_distance\ =}
\DoxyCodeLine{02368\ \ \ \ \ \ \ \ \ \ \ \ \ selected\_node.getUpperLength();\ \ \textcolor{comment}{//\ selected\_node-\/>length;}}
\DoxyCodeLine{02369\ }
\DoxyCodeLine{02370\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*if\ (selected\_node-\/>total\_lh)\ delete\ selected\_node-\/>total\_lh;}}
\DoxyCodeLine{02371\ \textcolor{comment}{\ \ \ \ \ \ \ \ selected\_node-\/>total\_lh\ =\ NULL;}}
\DoxyCodeLine{02372\ \textcolor{comment}{}}
\DoxyCodeLine{02373\ \textcolor{comment}{\ \ \ \ \ \ \ \ if\ (selected\_node-\/>mid\_branch\_lh)\ delete\ selected\_node-\/>mid\_branch\_lh;}}
\DoxyCodeLine{02374\ \textcolor{comment}{\ \ \ \ \ \ \ \ selected\_node-\/>mid\_branch\_lh\ =\ NULL;*/}}
\DoxyCodeLine{02375\ \ \ \ \ \ \ \ \ selected\_node.setTotalLh(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{02376\ \ \ \ \ \ \ \ \ selected\_node.setMidBranchLh(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{02377\ }
\DoxyCodeLine{02378\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ node.furtherMidNodes=None}}
\DoxyCodeLine{02379\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02380\ \ \ \ \ \ \ connectNewSample2Branch<num\_states>(}
\DoxyCodeLine{02381\ \ \ \ \ \ \ \ \ \ \ sample,\ seq\_name\_index,\ selected\_node\_index,\ selected\_node,}
\DoxyCodeLine{02382\ \ \ \ \ \ \ \ \ \ \ top\_distance,\ down\_distance,\ best\_length,\ best\_parent\_regions,}
\DoxyCodeLine{02383\ \ \ \ \ \ \ \ \ \ \ upper\_left\_right\_regions);}
\DoxyCodeLine{02384\ \ \ \ \ \}}
\DoxyCodeLine{02385\ \ \ \}}
\DoxyCodeLine{02386\ }
\DoxyCodeLine{02387\ \ \ \textcolor{comment}{//\ delete\ best\_parent\_regions\ and\ best\_child\_regions}}
\DoxyCodeLine{02388\ \ \ \textcolor{comment}{/*if\ (best\_parent\_regions)}}
\DoxyCodeLine{02389\ \textcolor{comment}{\ \ \ \ \ \ delete\ best\_parent\_regions;}}
\DoxyCodeLine{02390\ \textcolor{comment}{\ \ if\ (best\_child\_regions)}}
\DoxyCodeLine{02391\ \textcolor{comment}{\ \ \ \ \ \ delete\ best\_child\_regions;*/}}
\DoxyCodeLine{02392\ \}}
\DoxyCodeLine{02393\ }
\DoxyCodeLine{02394\ \textcolor{keyword}{template}\ <const\ StateType\ num\_states>}
\DoxyCodeLine{02395\ \textcolor{keywordtype}{void}\ cmaple::Tree::placeNewSampleMidBranch(\textcolor{keyword}{const}\ Index\&\ selected\_node\_index,}
\DoxyCodeLine{02396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{02397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{02398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ RealNumType\ best\_lh\_diff)\ \{}
\DoxyCodeLine{02399\ \ \ \textcolor{comment}{//\ dummy\ variables}}
\DoxyCodeLine{02400\ \ \ \textcolor{comment}{//\ const\ RealNumType\ threshold\_prob\ =\ params-\/>threshold\_prob;}}
\DoxyCodeLine{02401\ \ \ std::unique\_ptr<SeqRegions>\ best\_child\_regions\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02402\ }
\DoxyCodeLine{02403\ \ \ \textcolor{comment}{//\ selected\_node-\/>neighbor-\/>getPartialLhAtNode(aln,\ model,\ threshold\_prob);}}
\DoxyCodeLine{02404\ \ \ \textcolor{comment}{//\ const\ MiniIndex\ seleted\_node\_mini\_index\ =}}
\DoxyCodeLine{02405\ \ \ \textcolor{comment}{//\ selected\_node\_index.getMiniIndex();}}
\DoxyCodeLine{02406\ \ \ assert(selected\_node\_index.getMiniIndex()\ ==\ TOP);}
\DoxyCodeLine{02407\ \ \ assert(sample\ \&\&\ sample-\/>size()\ >\ 0);}
\DoxyCodeLine{02408\ \ \ assert(seq\_name\_index\ >=\ 0);}
\DoxyCodeLine{02409\ \ \ assert(aln);}
\DoxyCodeLine{02410\ \ \ assert(model);}
\DoxyCodeLine{02411\ \ \ assert(cumulative\_rate);}
\DoxyCodeLine{02412\ \ \ \ \ }
\DoxyCodeLine{02413\ \ \ PhyloNode\&\ selected\_node\ =\ nodes[selected\_node\_index.getVectorIndex()];}
\DoxyCodeLine{02414\ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions\ =}
\DoxyCodeLine{02415\ \ \ \ \ \ \ getPartialLhAtNode(selected\_node.getNeighborIndex(TOP));}
\DoxyCodeLine{02416\ \ \ RealNumType\ best\_split\_lh\ =\ best\_lh\_diff;}
\DoxyCodeLine{02417\ \ \ \textcolor{keyword}{const}\ RealNumType\ selected\_node\_blength\ =\ selected\_node.getUpperLength();}
\DoxyCodeLine{02418\ \ \ RealNumType\ best\_branch\_length\_split\ =\ 0.5\ *\ selected\_node\_blength;}
\DoxyCodeLine{02419\ \ \ best\_child\_regions\ =}
\DoxyCodeLine{02420\ \ \ \ \ \ \ \textcolor{keyword}{nullptr};\ \ \textcolor{comment}{//\ cmaple::make\_unique<SeqRegions>(SeqRegions(selected\_node.getMidBranchLh()));}}
\DoxyCodeLine{02421\ \ \ \textcolor{comment}{//\ selected\_node-\/>getPartialLhAtNode(aln,\ model,\ threshold\_prob);}}
\DoxyCodeLine{02422\ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions\ =}
\DoxyCodeLine{02423\ \ \ \ \ \ \ selected\_node.getPartialLh(TOP);}
\DoxyCodeLine{02424\ }
\DoxyCodeLine{02425\ \ \ \textcolor{comment}{//\ try\ different\ positions\ on\ the\ existing\ branch}}
\DoxyCodeLine{02426\ \ \ \textcolor{keywordtype}{bool}\ found\_new\_split\ =}
\DoxyCodeLine{02427\ \ \ \ \ \ \ tryShorterBranch<num\_states,}
\DoxyCodeLine{02428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(}
\DoxyCodeLine{02429\ \ \ \ \ \ \ \ \ \ \ selected\_node\_blength,\ best\_child\_regions,\ sample,}
\DoxyCodeLine{02430\ \ \ \ \ \ \ \ \ \ \ upper\_left\_right\_regions,\ lower\_regions,\ best\_split\_lh,}
\DoxyCodeLine{02431\ \ \ \ \ \ \ \ \ \ \ best\_branch\_length\_split,\ default\_blength,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02432\ }
\DoxyCodeLine{02433\ \ \ \textcolor{keywordflow}{if}\ (!found\_new\_split)\ \{}
\DoxyCodeLine{02434\ \ \ \ \ \textcolor{comment}{//\ try\ on\ the\ second\ branch}}
\DoxyCodeLine{02435\ \ \ \ \ found\_new\_split\ =\ tryShorterBranch<}
\DoxyCodeLine{02436\ \ \ \ \ \ \ \ \ num\_states,\ \&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(}
\DoxyCodeLine{02437\ \ \ \ \ \ \ \ \ selected\_node\_blength,\ best\_child\_regions,\ sample,}
\DoxyCodeLine{02438\ \ \ \ \ \ \ \ \ upper\_left\_right\_regions,\ lower\_regions,\ best\_split\_lh,}
\DoxyCodeLine{02439\ \ \ \ \ \ \ \ \ best\_branch\_length\_split,\ default\_blength,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02440\ }
\DoxyCodeLine{02441\ \ \ \ \ \textcolor{keywordflow}{if}\ (found\_new\_split)\ \{}
\DoxyCodeLine{02442\ \ \ \ \ \ \ best\_branch\_length\_split\ =}
\DoxyCodeLine{02443\ \ \ \ \ \ \ \ \ \ \ selected\_node\_blength\ -\/\ best\_branch\_length\_split;}
\DoxyCodeLine{02444\ \ \ \ \ \}}
\DoxyCodeLine{02445\ \ \ \}}
\DoxyCodeLine{02446\ }
\DoxyCodeLine{02447\ \ \ \textcolor{comment}{//\ Delay\ cloning\ SeqRegions}}
\DoxyCodeLine{02448\ \ \ \textcolor{keywordflow}{if}\ (!best\_child\_regions)\ \{}
\DoxyCodeLine{02449\ \ \ \ \ best\_child\_regions\ =\ cmaple::make\_unique<SeqRegions>(}
\DoxyCodeLine{02450\ \ \ \ \ \ \ \ \ SeqRegions(selected\_node.getMidBranchLh()));}
\DoxyCodeLine{02451\ \ \ \}}
\DoxyCodeLine{02452\ }
\DoxyCodeLine{02453\ \ \ \textcolor{comment}{//\ now\ try\ different\ lengths\ for\ the\ new\ branch}}
\DoxyCodeLine{02454\ \ \ RealNumType\ best\_blength\ =\ default\_blength;}
\DoxyCodeLine{02455\ \ \ estimateLengthNewBranch<}
\DoxyCodeLine{02456\ \ \ \ \ \ \ \&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(}
\DoxyCodeLine{02457\ \ \ \ \ \ \ best\_split\_lh,\ best\_child\_regions,\ sample,\ best\_blength,\ max\_blength,}
\DoxyCodeLine{02458\ \ \ \ \ \ \ min\_blength,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02459\ }
\DoxyCodeLine{02460\ \ \ \textcolor{comment}{//\ create\ new\ internal\ node\ and\ append\ child\ to\ it}}
\DoxyCodeLine{02461\ \ \ connectNewSample2Branch<num\_states>(}
\DoxyCodeLine{02462\ \ \ \ \ \ \ sample,\ seq\_name\_index,\ selected\_node\_index,\ selected\_node,}
\DoxyCodeLine{02463\ \ \ \ \ \ \ best\_branch\_length\_split,}
\DoxyCodeLine{02464\ \ \ \ \ \ \ selected\_node\_blength\ -\/\ best\_branch\_length\_split,\ best\_blength,}
\DoxyCodeLine{02465\ \ \ \ \ \ \ best\_child\_regions,\ upper\_left\_right\_regions);}
\DoxyCodeLine{02466\ \}}
\DoxyCodeLine{02468\ \}\ \ \textcolor{comment}{//\ namespace\ cmaple}}

\end{DoxyCode}
