\doxysection{tree.\+h}
\hypertarget{tree_8h_source}{}\label{tree_8h_source}\index{tree/tree.h@{tree/tree.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ "{}../alignment/alignment.h"{}}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#include\ "{}../model/model.h"{}}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ "{}updatingnode.h"{}}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#ifdef\ \_OPENMP}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <omp.h>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{namespace\ }cmaple\ \{}
\DoxyCodeLine{00012\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}\ \{}
\DoxyCodeLine{00013\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00017\ \ \ \textcolor{keyword}{enum}\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}}\ \{}
\DoxyCodeLine{00018\ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43a782a94a0336018d3a43f5e71e76e0bc6}{FAST\_TREE\_SEARCH}},\ \ \ }
\DoxyCodeLine{00019\ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43ad597e07c0182b56b0bc3d67b8fdaf0c1}{NORMAL\_TREE\_SEARCH}},\ }
\DoxyCodeLine{00021\ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43ae452d25b3b1a6060c8f156d0a35566d2}{MORE\_ACCURATE\_TREE\_SEARCH}},\ }
\DoxyCodeLine{00022\ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43a5c358c56b2d42131093b6b5386d1d8f5}{UNKNOWN\_TREE\_SEARCH}},\ \ \ \ \ \ \ }
\DoxyCodeLine{00023\ \ \ \};}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00028\ \ \ \textcolor{keyword}{enum}\ \mbox{\hyperlink{classcmaple_1_1_tree_a750c5e7c53559fbcc421020bad665376}{TreeType}}\ \{}
\DoxyCodeLine{00029\ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_a750c5e7c53559fbcc421020bad665376aed3efab1c9a9364074e767a772c132da}{BIN\_TREE}},\ \ \ \ \ }
\DoxyCodeLine{00030\ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_a750c5e7c53559fbcc421020bad665376a0156cc734ae126b57d1a6ceeb22bd9e9}{MUL\_TREE}},\ \ \ \ \ }
\DoxyCodeLine{00031\ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_a750c5e7c53559fbcc421020bad665376af211a6a48af98121a51064677ec6d851}{UNKNOWN\_TREE}},\ }
\DoxyCodeLine{00032\ \ \ \};}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ BEGIN\ OF\ PUBLIC\ APIs\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00035\ \ \ \textcolor{comment}{//\ //}}
\DoxyCodeLine{00061\ \textcolor{comment}{}\ \ \mbox{\hyperlink{classcmaple_1_1_tree_ac8b9c0385a290c3d535434ae843338ce}{Tree}}(\mbox{\hyperlink{classcmaple_1_1_alignment}{Alignment}}*\ aln,}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_model}{Model}}*\ model,}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ std::istream\&\ tree\_stream,}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ fixed\_blengths\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ std::unique\_ptr<cmaple::Params>\&\&\ params\ =\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00094\ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_af71b78fbf62c78e5630ac76f3fc319dc}{Tree}}(\mbox{\hyperlink{classcmaple_1_1_alignment}{Alignment}}*\ aln,}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_model}{Model}}*\ model,}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ tree\_filename\ =\ \textcolor{stringliteral}{"{}"{}},}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ fixed\_blengths\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ std::unique\_ptr<cmaple::Params>\&\&\ params\ =\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00102\ \ \ \mbox{\hyperlink{classcmaple_1_1_tree_ae05ee284fd0e9edba07708ec914eb045}{\string~Tree}}();}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00119\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcmaple_1_1_tree_af8c288e5a4ae4277615cb24268dca2f2}{load}}(std::istream\&\ tree\_stream,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ fixed\_blengths\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00137\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcmaple_1_1_tree_a1b2479eb26d00469ee1040dd9bee18e5}{load}}(\textcolor{keyword}{const}\ std::string\&\ tree\_filename,}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ fixed\_blengths\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00148\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcmaple_1_1_tree_ab932b3742c6e18d51554f72432c18151}{changeAln}}(\mbox{\hyperlink{classcmaple_1_1_alignment}{Alignment}}*\ aln);}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00157\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classcmaple_1_1_tree_aa4f982f45f38226193cd584bbe7e93ef}{changeModel}}(\mbox{\hyperlink{classcmaple_1_1_model}{Model}}*\ model);}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00174\ \ \ std::string\ \mbox{\hyperlink{classcmaple_1_1_tree_a22c01b063bb2af96259d873b9c82ad8a}{doPlacement}}();}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00188\ \ \ std::string\ \mbox{\hyperlink{classcmaple_1_1_tree_a27aa5671934d696e91f6e5e4e2ab8608}{applySPR}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}}\ tree\_search\_type,}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ shallow\_tree\_search);}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00200\ \ \ std::string\ \mbox{\hyperlink{classcmaple_1_1_tree_abe5ff17922b8b186af5e08dabd4151a0}{optimizeBranch}}();}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00232\ \ \ std::string\ \mbox{\hyperlink{classcmaple_1_1_tree_a488a031a981471acb05dd6cd3dd7ed0c}{autoProceedMAPLE}}(}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}}\ tree\_search\_type\ =\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43ad597e07c0182b56b0bc3d67b8fdaf0c1}{NORMAL\_TREE\_SEARCH}},}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ shallow\_tree\_search\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00244\ \ \ RealNumType\ \mbox{\hyperlink{classcmaple_1_1_tree_a987c92b41faa1303b5b0c8393c0704db}{computeLh}}();}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00270\ \ \ std::string\ \mbox{\hyperlink{classcmaple_1_1_tree_a675f8a9a1704bfd3ed8f70d8c9408ab6}{computeBranchSupport}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_threads\ =\ 1,}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_replicates\ =\ 1000,}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ epsilon\ =\ 0.1,}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ allow\_replacing\_ML\_tree\ =\ \textcolor{keyword}{true});}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00286\ \ \ std::string\ \mbox{\hyperlink{classcmaple_1_1_tree_a8d1492f8a3291bd70af3a879b535f880}{exportNewick}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classcmaple_1_1_tree_a750c5e7c53559fbcc421020bad665376}{TreeType}}\ tree\_type\ =\ \mbox{\hyperlink{classcmaple_1_1_tree_a750c5e7c53559fbcc421020bad665376aed3efab1c9a9364074e767a772c132da}{BIN\_TREE}},}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ show\_branch\_supports\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/\ END\ OF\ PUBLIC\ APIs\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00290\ \ \ \textcolor{comment}{//\ //}}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00296\ \ \ \textcolor{keywordtype}{bool}\ fixed\_blengths\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00301\ \ \ cmaple::RealNumType\ default\_blength,\ min\_blength,\ max\_blength,}
\DoxyCodeLine{00302\ \ \ \ \ \ \ min\_blength\_mid,\ min\_blength\_sensitivity,\ half\_max\_blength,}
\DoxyCodeLine{00303\ \ \ \ \ \ \ half\_min\_blength\_mid,\ double\_min\_blength;}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00308\ \ \ \textcolor{comment}{//\ std::optional<cmaple::Params>\ params;}}
\DoxyCodeLine{00309\ \ \ std::unique\_ptr<cmaple::Params>\ params\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00314\ \ \ \mbox{\hyperlink{classcmaple_1_1_alignment}{Alignment}}*\ aln\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00319\ \ \ \mbox{\hyperlink{classcmaple_1_1_model_base}{ModelBase}}*\ model\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00324\ \ \ cmaple::RealNumType*\ cumulative\_rate\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00329\ \ \ std::vector<std::vector<cmaple::PositionType>>\ cumulative\_base;}
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00334\ \ \ std::vector<PhyloNode>\ nodes;}
\DoxyCodeLine{00335\ }
\DoxyCodeLine{00339\ \ \ std::vector<NodeLh>\ node\_lhs;}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00344\ \ \ cmaple::NumSeqsType\ root\_vector\_index;}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00351\ \ \ std::vector<std::string>\ seq\_names;}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00357\ \ \ std::vector<bool>\ sequence\_added;}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00366\ \ \ \textcolor{keywordtype}{void}\ makeTreeInOutConsistent();}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00373\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}}\ parseTreeSearchType(}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ tree\_search\_type);}
\DoxyCodeLine{00375\ }
\DoxyCodeLine{00381\ \ \ \textcolor{keyword}{static}\ std::string\ getTreeSearchStr(\textcolor{keyword}{const}\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}}\ tree\_search\_type);}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00388\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classcmaple_1_1_tree_a750c5e7c53559fbcc421020bad665376}{TreeType}}\ parseTreeType(\textcolor{keyword}{const}\ std::string\&\ tree\_type\_str);}
\DoxyCodeLine{00389\ \ \ \ \ }
\DoxyCodeLine{00392\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00396\ \ \ \textcolor{keyword}{typedef}\ void\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*LoadTreePtrType)(std::istream\&,\ const\ bool);}
\DoxyCodeLine{00397\ \ \ LoadTreePtrType\ loadTreePtr;}
\DoxyCodeLine{00398\ }
\DoxyCodeLine{00402\ \ \ \textcolor{keyword}{typedef}\ void\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*ChangeModelPtrType)(\mbox{\hyperlink{classcmaple_1_1_model}{Model}}*);}
\DoxyCodeLine{00403\ \ \ ChangeModelPtrType\ changeModelPtr;}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00408\ \ \ \textcolor{keyword}{typedef}\ void\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*ChangeAlnPtrType)(\mbox{\hyperlink{classcmaple_1_1_alignment}{Alignment}}*);}
\DoxyCodeLine{00409\ \ \ ChangeAlnPtrType\ changeAlnPtr;}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00414\ \ \ \textcolor{keyword}{typedef}\ std::string\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*DoInferencePtrType)(const\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}},}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ bool);}
\DoxyCodeLine{00416\ \ \ DoInferencePtrType\ doInferencePtr;}
\DoxyCodeLine{00417\ }
\DoxyCodeLine{00421\ \ \ \textcolor{keyword}{typedef}\ std::string\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*DoPlacementPtrType)();}
\DoxyCodeLine{00422\ \ \ DoPlacementPtrType\ doPlacementPtr;}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00427\ \ \ \textcolor{keyword}{typedef}\ std::string\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*ApplySPRPtrType)(const\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}},}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ bool);}
\DoxyCodeLine{00429\ \ \ ApplySPRPtrType\ applySPRPtr;}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00434\ \ \ \textcolor{keyword}{typedef}\ std::string\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*OptimizeBranchPtrType)();}
\DoxyCodeLine{00435\ \ \ OptimizeBranchPtrType\ optimizeBranchPtr;}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00440\ \ \ \textcolor{keyword}{typedef}\ RealNumType\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*computeLhPtrType)();}
\DoxyCodeLine{00441\ \ \ computeLhPtrType\ computeLhPtr;}
\DoxyCodeLine{00442\ }
\DoxyCodeLine{00446\ \ \ \textcolor{keyword}{typedef}\ std::string\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*computeBranchSupportPtrType)(const\ int,}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ int,}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ double,}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ bool);}
\DoxyCodeLine{00450\ \ \ computeBranchSupportPtrType\ computeBranchSupportPtr;}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00452\ \ \ \textcolor{keyword}{typedef}\ void\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*MakeTreeInOutConsistentPtrType)();}
\DoxyCodeLine{00453\ \ \ MakeTreeInOutConsistentPtrType\ makeTreeInOutConsistentPtr;}
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00460\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00461\ \ \ \textcolor{keywordtype}{void}\ loadTreeTemplate(std::istream\&\ tree\_stream,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ fixed\_blengths);}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00465\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00466\ \ \ \textcolor{keywordtype}{void}\ changeAlnTemplate(\mbox{\hyperlink{classcmaple_1_1_alignment}{Alignment}}*\ aln);}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00470\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00471\ \ \ \textcolor{keywordtype}{void}\ changeModelTemplate(\mbox{\hyperlink{classcmaple_1_1_model}{Model}}*\ model);}
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00475\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00476\ \ \ std::string\ doInferenceTemplate(\textcolor{keyword}{const}\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}}\ tree\_search\_type,}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ shallow\_tree\_search);}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00481\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00482\ \ \ std::string\ doPlacementTemplate();}
\DoxyCodeLine{00483\ }
\DoxyCodeLine{00486\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00487\ \ \ std::string\ applySPRTemplate(\textcolor{keyword}{const}\ \mbox{\hyperlink{classcmaple_1_1_tree_a39bd3bfce400c9222e8b77c584d26d43}{TreeSearchType}}\ tree\_search\_type,}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ shallow\_tree\_search);}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00492\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00493\ \ \ std::string\ optimizeBranchTemplate();}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00497\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00498\ \ \ RealNumType\ computeLhTemplate();}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00502\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00503\ \ \ std::string\ computeBranchSupportTemplate(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_threads,}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_replicates,}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ epsilon,}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ allow\_replacing\_ML\_tree);}
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00510\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00511\ \ \ \textcolor{keywordtype}{void}\ makeTreeInOutConsistentTemplate();}
\DoxyCodeLine{00512\ }
\DoxyCodeLine{00517\ \ \ \textcolor{keywordtype}{void}\ setupFuncPtrs();}
\DoxyCodeLine{00518\ }
\DoxyCodeLine{00522\ \ \ \textcolor{keywordtype}{void}\ setupBlengthThresh();}
\DoxyCodeLine{00523\ }
\DoxyCodeLine{00536\ \ \ \textcolor{keywordtype}{void}\ initTree(\mbox{\hyperlink{classcmaple_1_1_alignment}{Alignment}}*\ aln,}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classcmaple_1_1_model}{Model}}*\ model,}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<cmaple::Params>\&\&\ params);}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00544\ \ \ \textcolor{keywordtype}{void}\ computeCumulativeRate();}
\DoxyCodeLine{00545\ }
\DoxyCodeLine{00550\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00551\ \ \ \textcolor{keywordtype}{void}\ optimizeTreeTopology(\textcolor{keywordtype}{bool}\ short\_range\_search\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00552\ }
\DoxyCodeLine{00559\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00560\ \ \ \textcolor{keywordtype}{void}\ refreshAllNonLowerLhs();}
\DoxyCodeLine{00561\ }
\DoxyCodeLine{00568\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00569\ \ \ cmaple::RealNumType\ improveSubTree(\textcolor{keyword}{const}\ cmaple::Index\ index,}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ short\_range\_search);}
\DoxyCodeLine{00572\ }
\DoxyCodeLine{00577\ \ \ cmaple::RealNumType\ calculateDerivative(}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<cmaple::RealNumType>\&\ coefficient\_vec,}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ delta\_t);}
\DoxyCodeLine{00580\ }
\DoxyCodeLine{00584\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00585\ \ \ \textcolor{keywordtype}{void}\ examineSamplePlacementMidBranch(}
\DoxyCodeLine{00586\ \ \ \ \ \ \ cmaple::Index\&\ selected\_node\_index,}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ mid\_branch\_lh,}
\DoxyCodeLine{00588\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_lh\_diff,}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ is\_mid\_branch,}
\DoxyCodeLine{00590\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff\_mid\_branch,}
\DoxyCodeLine{00591\ \ \ \ \ \ \ TraversingNode\&\ current\_extended\_node,}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample\_regions);}
\DoxyCodeLine{00593\ }
\DoxyCodeLine{00597\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00598\ \ \ \textcolor{keywordtype}{void}\ examineSamplePlacementAtNode(}
\DoxyCodeLine{00599\ \ \ \ \ \ \ cmaple::Index\&\ selected\_node\_index,}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ total\_lh,}
\DoxyCodeLine{00601\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_lh\_diff,}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ is\_mid\_branch,}
\DoxyCodeLine{00603\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff\_at\_node,}
\DoxyCodeLine{00604\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff\_mid\_branch,}
\DoxyCodeLine{00605\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_up\_lh\_diff,}
\DoxyCodeLine{00606\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{00607\ \ \ \ \ \ \ cmaple::Index\&\ best\_child\_index,}
\DoxyCodeLine{00608\ \ \ \ \ \ \ TraversingNode\&\ current\_extended\_node,}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample\_regions);}
\DoxyCodeLine{00610\ }
\DoxyCodeLine{00616\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00617\ \ \ \textcolor{keywordtype}{void}\ finetuneSamplePlacementAtNode(}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \textcolor{keyword}{const}\ PhyloNode\&\ selected\_node,}
\DoxyCodeLine{00619\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{00620\ \ \ \ \ \ \ cmaple::Index\&\ best\_child\_index,}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample\_regions);}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00628\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00629\ \ \ \textcolor{keywordtype}{void}\ addStartingNodes(\textcolor{keyword}{const}\ cmaple::Index\&\ node\_index,}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\&\ other\_child\_node\_index,}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_lh\_diff,}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::stack<std::unique\_ptr<UpdatingNode>>\&\ node\_stack);}
\DoxyCodeLine{00634\ }
\DoxyCodeLine{00640\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00641\ \ \ \textcolor{keywordtype}{bool}\ examineSubtreePlacementMidBranch(}
\DoxyCodeLine{00642\ \ \ \ \ \ \ cmaple::Index\&\ best\_node\_index,}
\DoxyCodeLine{00643\ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{00644\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_lh\_diff,}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ is\_mid\_branch,}
\DoxyCodeLine{00646\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff\_at\_node,}
\DoxyCodeLine{00647\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff\_mid\_branch,}
\DoxyCodeLine{00648\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_up\_lh\_diff,}
\DoxyCodeLine{00649\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{00650\ \ \ \ \ \ \ std::unique\_ptr<UpdatingNode>\&\ updating\_node,}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ threshold\_prob,}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ removed\_blength,}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ top\_node\_index,}
\DoxyCodeLine{00655\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ bottom\_regions);}
\DoxyCodeLine{00656\ }
\DoxyCodeLine{00662\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00663\ \ \ \textcolor{keywordtype}{bool}\ examineSubTreePlacementAtNode(}
\DoxyCodeLine{00664\ \ \ \ \ \ \ cmaple::Index\&\ best\_node\_index,}
\DoxyCodeLine{00665\ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{00666\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_lh\_diff,}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ is\_mid\_branch,}
\DoxyCodeLine{00668\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff\_at\_node,}
\DoxyCodeLine{00669\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff\_mid\_branch,}
\DoxyCodeLine{00670\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_up\_lh\_diff,}
\DoxyCodeLine{00671\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{00672\ \ \ \ \ \ \ std::unique\_ptr<UpdatingNode>\&\ updating\_node,}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ threshold\_prob,}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ removed\_blength,}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ top\_node\_index);}
\DoxyCodeLine{00677\ }
\DoxyCodeLine{00683\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00684\ \ \ \textcolor{keywordtype}{void}\ addChildSeekSubtreePlacement(}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ child\_1\_index,}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ child\_2\_index,}
\DoxyCodeLine{00687\ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{00688\ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ lh\_diff\_at\_node,}
\DoxyCodeLine{00690\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<UpdatingNode>\&\ updating\_node,}
\DoxyCodeLine{00691\ \ \ \ \ \ \ std::stack<std::unique\_ptr<UpdatingNode>>\&\ node\_stack,}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ threshold\_prob);}
\DoxyCodeLine{00693\ }
\DoxyCodeLine{00700\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00701\ \ \ \textcolor{keywordtype}{bool}\ addNeighborsSeekSubtreePlacement(}
\DoxyCodeLine{00702\ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ other\_child\_index,}
\DoxyCodeLine{00704\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\&\ bottom\_regions,}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ lh\_diff\_at\_node,}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<UpdatingNode>\&\ updating\_node,}
\DoxyCodeLine{00707\ \ \ \ \ \ \ std::stack<std::unique\_ptr<UpdatingNode>>\&\ node\_stack,}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ threshold\_prob);}
\DoxyCodeLine{00709\ }
\DoxyCodeLine{00716\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{const}\ cmaple::StateType\ num\_states,}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*calculatePlacementCost)(}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ cmaple::RealNumType)>}
\DoxyCodeLine{00721\ \ \ bool\ tryShorterBranch(}
\DoxyCodeLine{00722\ \ \ \ \ \ \ const\ cmaple::RealNumType\ current\_blength,}
\DoxyCodeLine{00723\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_child\_regions,}
\DoxyCodeLine{00724\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00725\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions,}
\DoxyCodeLine{00726\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00727\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_split\_lh,}
\DoxyCodeLine{00728\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_branch\_length\_split,}
\DoxyCodeLine{00729\ \ \ \ \ \ \ const\ cmaple::RealNumType\ new\_branch\_length,}
\DoxyCodeLine{00730\ \ \ \ \ \ \ const\ bool\ try\_first\_branch);}
\DoxyCodeLine{00731\ }
\DoxyCodeLine{00737\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00738\ \ \ \textcolor{keywordtype}{void}\ tryShorterBranchAtRoot(\textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_parent\_regions,}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_root\_blength,}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_parent\_lh,}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ fixed\_blength);}
\DoxyCodeLine{00744\ }
\DoxyCodeLine{00749\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00750\ \ \ \textcolor{keywordtype}{bool}\ tryShorterNewBranchAtRoot(}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00753\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_parent\_regions,}
\DoxyCodeLine{00754\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_length,}
\DoxyCodeLine{00755\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_parent\_lh,}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ fixed\_blength);}
\DoxyCodeLine{00757\ }
\DoxyCodeLine{00764\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00765\ \ \ \textcolor{keywordtype}{bool}\ tryLongerNewBranchAtRoot(}
\DoxyCodeLine{00766\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00768\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_parent\_regions,}
\DoxyCodeLine{00769\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_length,}
\DoxyCodeLine{00770\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_parent\_lh,}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ fixed\_blength);}
\DoxyCodeLine{00772\ }
\DoxyCodeLine{00778\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00779\ \ \ \textcolor{keywordtype}{void}\ estimateLengthNewBranchAtRoot(}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00782\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_parent\_regions,}
\DoxyCodeLine{00783\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_length,}
\DoxyCodeLine{00784\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_parent\_lh,}
\DoxyCodeLine{00785\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ fixed\_blength,}
\DoxyCodeLine{00786\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ short\_blength\_thresh,}
\DoxyCodeLine{00787\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ optional\_check);}
\DoxyCodeLine{00788\ }
\DoxyCodeLine{00793\ \ \ \textcolor{keyword}{template}\ <cmaple::RealNumType\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*calculatePlacementCost)(}
\DoxyCodeLine{00794\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00795\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00796\ \ \ \ \ \ \ const\ cmaple::RealNumType)>}
\DoxyCodeLine{00797\ \ \ bool\ tryShorterNewBranch(}
\DoxyCodeLine{00798\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ best\_child\_regions,}
\DoxyCodeLine{00799\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00800\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_blength,}
\DoxyCodeLine{00801\ \ \ \ \ \ \ cmaple::RealNumType\&\ new\_branch\_lh,}
\DoxyCodeLine{00802\ \ \ \ \ \ \ const\ cmaple::RealNumType\ short\_blength\_thresh);}
\DoxyCodeLine{00803\ }
\DoxyCodeLine{00808\ \ \ \textcolor{keyword}{template}\ <cmaple::RealNumType\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*calculatePlacementCost)(}
\DoxyCodeLine{00809\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00810\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00811\ \ \ \ \ \ \ const\ cmaple::RealNumType)>}
\DoxyCodeLine{00812\ \ \ void\ tryLongerNewBranch(const\ std::unique\_ptr<SeqRegions>\&\ best\_child\_regions,}
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00814\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_blength,}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ new\_branch\_lh,}
\DoxyCodeLine{00816\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ cmaple::RealNumType\ long\_blength\_thresh);}
\DoxyCodeLine{00817\ }
\DoxyCodeLine{00821\ \ \ \textcolor{keyword}{template}\ <cmaple::RealNumType\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*calculatePlacementCost)(}
\DoxyCodeLine{00822\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00823\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00824\ \ \ \ \ \ \ const\ cmaple::RealNumType)>}
\DoxyCodeLine{00825\ \ \ void\ estimateLengthNewBranch(}
\DoxyCodeLine{00826\ \ \ \ \ \ \ const\ cmaple::RealNumType\ best\_split\_lh,}
\DoxyCodeLine{00827\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ best\_child\_regions,}
\DoxyCodeLine{00828\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00829\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_blength,}
\DoxyCodeLine{00830\ \ \ \ \ \ \ const\ cmaple::RealNumType\ long\_blength\_thresh,}
\DoxyCodeLine{00831\ \ \ \ \ \ \ const\ cmaple::RealNumType\ short\_blength\_thresh,}
\DoxyCodeLine{00832\ \ \ \ \ \ \ const\ bool\ optional\_check);}
\DoxyCodeLine{00833\ }
\DoxyCodeLine{00839\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00840\ \ \ \textcolor{keywordtype}{void}\ connectNewSample2Branch(}
\DoxyCodeLine{00841\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00842\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{00843\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ sibling\_node\_index,}
\DoxyCodeLine{00844\ \ \ \ \ \ \ PhyloNode\&\ sibling\_node,}
\DoxyCodeLine{00845\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ top\_distance,}
\DoxyCodeLine{00846\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ down\_distance,}
\DoxyCodeLine{00847\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_blength,}
\DoxyCodeLine{00848\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_child\_regions,}
\DoxyCodeLine{00849\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions);}
\DoxyCodeLine{00850\ }
\DoxyCodeLine{00856\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00857\ \ \ \textcolor{keywordtype}{void}\ connectNewSample2Root(std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ sibling\_node\_index,}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling\_node,}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_root\_blength,}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_length2,}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_parent\_regions);}
\DoxyCodeLine{00864\ }
\DoxyCodeLine{00870\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00871\ \ \ \textcolor{keywordtype}{void}\ placeSubTreeAtNode(\textcolor{keyword}{const}\ cmaple::Index\ selected\_node\_index,}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ subtree\_index,}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ subtree,}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ new\_branch\_length,}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ new\_lh);}
\DoxyCodeLine{00877\ }
\DoxyCodeLine{00883\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00884\ \ \ \textcolor{keywordtype}{void}\ placeSubTreeMidBranch(\textcolor{keyword}{const}\ cmaple::Index\ selected\_node\_index,}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ subtree\_index,}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ subtree,}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ new\_branch\_length,}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ new\_lh);}
\DoxyCodeLine{00890\ }
\DoxyCodeLine{00896\ \ \ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::StateType\ num\_states,}
\DoxyCodeLine{00898\ \ \ \ \ \ \ void\ (\mbox{\hyperlink{classcmaple_1_1_tree}{Tree}}::*updateRegionsSubTree)(PhyloNode\&,}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&,}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&,}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\&,}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&)>}
\DoxyCodeLine{00906\ \ \ void\ connectSubTree2Branch(}
\DoxyCodeLine{00907\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00908\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00909\ \ \ \ \ \ \ const\ cmaple::Index\ subtree\_index,}
\DoxyCodeLine{00910\ \ \ \ \ \ \ PhyloNode\&\ subtree,}
\DoxyCodeLine{00911\ \ \ \ \ \ \ const\ cmaple::Index\ sibling\_node\_index,}
\DoxyCodeLine{00912\ \ \ \ \ \ \ PhyloNode\&\ sibling\_node,}
\DoxyCodeLine{00913\ \ \ \ \ \ \ const\ cmaple::RealNumType\ top\_distance,}
\DoxyCodeLine{00914\ \ \ \ \ \ \ const\ cmaple::RealNumType\ down\_distance,}
\DoxyCodeLine{00915\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_blength,}
\DoxyCodeLine{00916\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\&\ best\_child\_regions,}
\DoxyCodeLine{00917\ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions);}
\DoxyCodeLine{00918\ }
\DoxyCodeLine{00924\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00925\ \ \ \textcolor{keywordtype}{void}\ connectSubTree2Root(\textcolor{keyword}{const}\ cmaple::Index\ subtree\_index,}
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ subtree,}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ sibling\_node\_index,}
\DoxyCodeLine{00930\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling\_node,}
\DoxyCodeLine{00931\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_root\_blength,}
\DoxyCodeLine{00932\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_length2,}
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\&\ best\_parent\_regions);}
\DoxyCodeLine{00934\ }
\DoxyCodeLine{00942\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00943\ \ \ \textcolor{keywordtype}{void}\ updateRegionsPlaceSubTree(}
\DoxyCodeLine{00944\ \ \ \ \ \ \ PhyloNode\&\ subtree,}
\DoxyCodeLine{00945\ \ \ \ \ \ \ PhyloNode\&\ sibling\_node,}
\DoxyCodeLine{00946\ \ \ \ \ \ \ PhyloNode\&\ internal,}
\DoxyCodeLine{00947\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\&\ best\_child\_regions,}
\DoxyCodeLine{00948\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00949\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions,}
\DoxyCodeLine{00950\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00951\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_blength);}
\DoxyCodeLine{00952\ }
\DoxyCodeLine{00960\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00961\ \ \ \textcolor{keywordtype}{void}\ updateRegionsPlaceSubTreeAbove(}
\DoxyCodeLine{00962\ \ \ \ \ \ \ PhyloNode\&\ subtree,}
\DoxyCodeLine{00963\ \ \ \ \ \ \ PhyloNode\&\ sibling\_node,}
\DoxyCodeLine{00964\ \ \ \ \ \ \ PhyloNode\&\ internal,}
\DoxyCodeLine{00965\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\&\ best\_child\_regions,}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions,}
\DoxyCodeLine{00968\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{00969\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_blength);}
\DoxyCodeLine{00970\ }
\DoxyCodeLine{00976\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00977\ \ \ \textcolor{keywordtype}{void}\ handlePolytomyPlaceSubTree(}
\DoxyCodeLine{00978\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ selected\_node\_index,}
\DoxyCodeLine{00979\ \ \ \ \ \ \ PhyloNode\&\ selected\_node,}
\DoxyCodeLine{00980\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ subtree\_regions,}
\DoxyCodeLine{00981\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ new\_branch\_length,}
\DoxyCodeLine{00982\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{00983\ \ \ \ \ \ \ cmaple::Index\&\ best\_child\_index,}
\DoxyCodeLine{00984\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_child\_blength\_split,}
\DoxyCodeLine{00985\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ best\_child\_regions);}
\DoxyCodeLine{00986\ }
\DoxyCodeLine{00992\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{00993\ \ \ \textcolor{keywordtype}{void}\ updateMidBranchLh(}
\DoxyCodeLine{00994\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{00995\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{00996\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_upper\_regions,}
\DoxyCodeLine{00997\ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack,}
\DoxyCodeLine{00998\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ update\_blength);}
\DoxyCodeLine{00999\ }
\DoxyCodeLine{01006\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01007\ \ \ std::unique\_ptr<SeqRegions>\ computeUpperLeftRightRegions(}
\DoxyCodeLine{01008\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01009\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01010\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::MiniIndex\ next\_node\_mini,}
\DoxyCodeLine{01011\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_upper\_regions,}
\DoxyCodeLine{01012\ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack,}
\DoxyCodeLine{01013\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ update\_blength);}
\DoxyCodeLine{01014\ }
\DoxyCodeLine{01019\ \ \ \textcolor{keywordtype}{bool}\ updateNewPartialIfDifferent(}
\DoxyCodeLine{01020\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::MiniIndex\ next\_node\_mini,}
\DoxyCodeLine{01022\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions,}
\DoxyCodeLine{01023\ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack,}
\DoxyCodeLine{01024\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\ seq\_length);}
\DoxyCodeLine{01025\ }
\DoxyCodeLine{01032\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01033\ \ \ \textcolor{keywordtype}{void}\ \textcolor{keyword}{inline}\ handleNullNewRegions(\textcolor{keyword}{const}\ cmaple::Index\ index,}
\DoxyCodeLine{01034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ do\_update\_zeroblength,}
\DoxyCodeLine{01036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack,}
\DoxyCodeLine{01037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ update\_blength,}
\DoxyCodeLine{01038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ err\_msg)\ \{}
\DoxyCodeLine{01039\ \ \ \ \ \textcolor{keywordflow}{if}\ (do\_update\_zeroblength)\ \{}
\DoxyCodeLine{01040\ \ \ \ \ \ \ updateZeroBlength<num\_states>(index,\ node,\ node\_stack);}
\DoxyCodeLine{01041\ \ \ \ \ \ \ update\_blength\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01042\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01043\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::logic\_error(err\_msg);}
\DoxyCodeLine{01044\ \ \ \}}
\DoxyCodeLine{01045\ }
\DoxyCodeLine{01052\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01053\ \ \ \textcolor{keywordtype}{void}\ updatePartialLhFromParent(}
\DoxyCodeLine{01054\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ index,}
\DoxyCodeLine{01055\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01056\ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack,}
\DoxyCodeLine{01057\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_upper\_regions,}
\DoxyCodeLine{01058\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\ seq\_length);}
\DoxyCodeLine{01059\ }
\DoxyCodeLine{01066\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01067\ \ \ \textcolor{keywordtype}{void}\ updatePartialLhFromChildren(}
\DoxyCodeLine{01068\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ index,}
\DoxyCodeLine{01069\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01070\ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack,}
\DoxyCodeLine{01071\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_upper\_regions,}
\DoxyCodeLine{01072\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_non\_root,}
\DoxyCodeLine{01073\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\ seq\_length);}
\DoxyCodeLine{01074\ }
\DoxyCodeLine{01080\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01081\ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ computeMidBranchRegions(}
\DoxyCodeLine{01082\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01083\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ regions\_2\_update,}
\DoxyCodeLine{01084\ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegions\&\ parent\_upper\_lr\_lh)\ \{}
\DoxyCodeLine{01085\ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ lower\_lh\ =\ node.getPartialLh(cmaple::TOP);}
\DoxyCodeLine{01086\ \ \ \ \ cmaple::RealNumType\ half\_branch\_length\ =\ node.getUpperLength()\ *\ 0.5;}
\DoxyCodeLine{01087\ \ \ \ \ parent\_upper\_lr\_lh.mergeUpperLower<num\_states>(}
\DoxyCodeLine{01088\ \ \ \ \ \ \ \ \ regions\_2\_update,\ half\_branch\_length,\ *lower\_lh,\ half\_branch\_length,}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \ \ aln,\ model,\ params-\/>threshold\_prob);}
\DoxyCodeLine{01090\ \ \ \}}
\DoxyCodeLine{01091\ }
\DoxyCodeLine{01097\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01098\ \ \ \textcolor{keywordtype}{void}\ refreshNonLowerLhsFromParent(cmaple::Index\&\ node\_index,}
\DoxyCodeLine{01099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::Index\&\ last\_node\_index);}
\DoxyCodeLine{01100\ }
\DoxyCodeLine{01106\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01107\ \ \ \textcolor{keywordtype}{void}\ refreshUpperLR(\textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_index,}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ replaced\_regions,}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegions\&\ parent\_upper\_lr\_lh);}
\DoxyCodeLine{01112\ }
\DoxyCodeLine{01116\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01117\ \ \ \textcolor{keywordtype}{void}\ estimateBlength\_R\_O(\textcolor{keyword}{const}\ SeqRegion\&\ seq1\_region,}
\DoxyCodeLine{01118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegion\&\ seq2\_region,}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ total\_blength,}
\DoxyCodeLine{01120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\ end\_pos,}
\DoxyCodeLine{01121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ coefficient,}
\DoxyCodeLine{01122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ coefficient\_vec);}
\DoxyCodeLine{01123\ }
\DoxyCodeLine{01127\ \ \ \textcolor{keywordtype}{void}\ estimateBlength\_R\_ACGT(}
\DoxyCodeLine{01128\ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegion\&\ seq1\_region,}
\DoxyCodeLine{01129\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::StateType\ seq2\_state,}
\DoxyCodeLine{01130\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ total\_blength,}
\DoxyCodeLine{01131\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\ end\_pos,}
\DoxyCodeLine{01132\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ coefficient\_vec);}
\DoxyCodeLine{01133\ }
\DoxyCodeLine{01138\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01139\ \ \ \textcolor{keywordtype}{void}\ estimateBlength\_O\_X(\textcolor{keyword}{const}\ SeqRegion\&\ seq1\_region,}
\DoxyCodeLine{01140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegion\&\ seq2\_region,}
\DoxyCodeLine{01141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ total\_blength,}
\DoxyCodeLine{01142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\ end\_pos,}
\DoxyCodeLine{01143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ coefficient,}
\DoxyCodeLine{01144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ coefficient\_vec);}
\DoxyCodeLine{01145\ }
\DoxyCodeLine{01149\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01150\ \ \ \textcolor{keywordtype}{void}\ estimateBlength\_ACGT\_O(}
\DoxyCodeLine{01151\ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegion\&\ seq1\_region,}
\DoxyCodeLine{01152\ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegion\&\ seq2\_region,}
\DoxyCodeLine{01153\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ total\_blength,}
\DoxyCodeLine{01154\ \ \ \ \ \ \ cmaple::RealNumType\&\ coefficient,}
\DoxyCodeLine{01155\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ coefficient\_vec);}
\DoxyCodeLine{01156\ }
\DoxyCodeLine{01161\ \ \ \textcolor{keywordtype}{void}\ estimateBlength\_ACGT\_RACGT(}
\DoxyCodeLine{01162\ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegion\&\ seq1\_region,}
\DoxyCodeLine{01163\ \ \ \ \ \ \ \textcolor{keyword}{const}\ SeqRegion\&\ seq2\_region,}
\DoxyCodeLine{01164\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ total\_blength,}
\DoxyCodeLine{01165\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\ end\_pos,}
\DoxyCodeLine{01166\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ coefficient\_vec);}
\DoxyCodeLine{01167\ }
\DoxyCodeLine{01171\ \ \ cmaple::RealNumType\ estimateBlengthFromCoeffs(}
\DoxyCodeLine{01172\ \ \ \ \ \ \ cmaple::RealNumType\&\ coefficient,}
\DoxyCodeLine{01173\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<cmaple::RealNumType>\ coefficient\_vec);}
\DoxyCodeLine{01174\ }
\DoxyCodeLine{01180\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01181\ \ \ \textcolor{keywordtype}{void}\ handleBlengthChanged(PhyloNode\&\ node,}
\DoxyCodeLine{01182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_blength);}
\DoxyCodeLine{01184\ }
\DoxyCodeLine{01188\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01189\ \ \ \textcolor{keywordtype}{void}\ optimizeBlengthBeforeSeekingSPR(}
\DoxyCodeLine{01190\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01191\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_blength,}
\DoxyCodeLine{01192\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_lh,}
\DoxyCodeLine{01193\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ blength\_changed,}
\DoxyCodeLine{01194\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_upper\_lr\_lh,}
\DoxyCodeLine{01195\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_lh);}
\DoxyCodeLine{01196\ }
\DoxyCodeLine{01202\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01203\ \ \ \textcolor{keywordtype}{void}\ checkAndApplySPR(\textcolor{keyword}{const}\ cmaple::RealNumType\ best\_lh\_diff,}
\DoxyCodeLine{01204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_blength,}
\DoxyCodeLine{01205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_lh,}
\DoxyCodeLine{01206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ best\_node\_index,}
\DoxyCodeLine{01209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_node\_index,}
\DoxyCodeLine{01210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_mid\_node,}
\DoxyCodeLine{01211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ total\_improvement,}
\DoxyCodeLine{01212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ topology\_updated);}
\DoxyCodeLine{01213\ }
\DoxyCodeLine{01217\ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ createAnInternalNode()\ \{\ nodes.emplace\_back(InternalNode());\ \}}
\DoxyCodeLine{01218\ }
\DoxyCodeLine{01222\ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ createALeafNode(\textcolor{keyword}{const}\ cmaple::NumSeqsType\ new\_seq\_name\_index)\ \{}
\DoxyCodeLine{01223\ \ \ \ \ nodes.emplace\_back(LeafNode(}
\DoxyCodeLine{01224\ \ \ \ \ \ \ \ \ new\_seq\_name\_index));\ \ \textcolor{comment}{//(PhyloNode(std::move(LeafNode(new\_seq\_name\_index))));}}
\DoxyCodeLine{01225\ \ \ \}}
\DoxyCodeLine{01226\ }
\DoxyCodeLine{01230\ \ \ std::unique\_ptr<SeqRegions>\&\ getPartialLhAtNode(\textcolor{keyword}{const}\ cmaple::Index\ index);}
\DoxyCodeLine{01231\ }
\DoxyCodeLine{01237\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01238\ \ \ \textcolor{keywordtype}{bool}\ calculateNNILh(std::stack<cmaple::Index>\&\ node\_stack\_aLRT,}
\DoxyCodeLine{01239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff,}
\DoxyCodeLine{01240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index,}
\DoxyCodeLine{01246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_at\_root,}
\DoxyCodeLine{01247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ allow\_replacing\_ML\_tree);}
\DoxyCodeLine{01248\ }
\DoxyCodeLine{01254\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01255\ \ \ \textcolor{keywordtype}{bool}\ calculateNNILhRoot(std::stack<cmaple::Index>\&\ node\_stack\_aLRT,}
\DoxyCodeLine{01256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff,}
\DoxyCodeLine{01257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ parent\_new\_lower\_lh,}
\DoxyCodeLine{01258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ child\_2\_new\_blength,}
\DoxyCodeLine{01259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index,}
\DoxyCodeLine{01265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_at\_root,}
\DoxyCodeLine{01266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ allow\_replacing\_ML\_tree);}
\DoxyCodeLine{01267\ }
\DoxyCodeLine{01274\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01275\ \ \ \textcolor{keywordtype}{bool}\ calculateNNILhNonRoot(std::stack<cmaple::Index>\&\ node\_stack\_aLRT,}
\DoxyCodeLine{01276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff,}
\DoxyCodeLine{01277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ parent\_new\_lower\_lh,}
\DoxyCodeLine{01278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ child\_2\_new\_blength,}
\DoxyCodeLine{01279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01282\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01283\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index,}
\DoxyCodeLine{01285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_at\_root,}
\DoxyCodeLine{01286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ allow\_replacing\_ML\_tree);}
\DoxyCodeLine{01287\ }
\DoxyCodeLine{01293\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01294\ \ \ \textcolor{keywordtype}{void}\ replaceMLTreebyNNIRoot(std::stack<cmaple::Index>\&\ node\_stack\_aLRT,}
\DoxyCodeLine{01295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff,}
\DoxyCodeLine{01296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_at\_root,}
\DoxyCodeLine{01302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ child\_1\_best\_blength,}
\DoxyCodeLine{01303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ child\_2\_best\_blength,}
\DoxyCodeLine{01304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ sibling\_best\_blength,}
\DoxyCodeLine{01305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ parent\_best\_blength);}
\DoxyCodeLine{01306\ }
\DoxyCodeLine{01313\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01314\ \ \ \textcolor{keywordtype}{void}\ replaceMLTreebyNNINonRoot(}
\DoxyCodeLine{01315\ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack\_aLRT,}
\DoxyCodeLine{01316\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff,}
\DoxyCodeLine{01317\ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01318\ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01319\ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01320\ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01321\ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01322\ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_at\_root,}
\DoxyCodeLine{01323\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ child\_1\_best\_blength,}
\DoxyCodeLine{01324\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ child\_2\_best\_blength,}
\DoxyCodeLine{01325\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ sibling\_best\_blength,}
\DoxyCodeLine{01326\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ parent\_best\_blength,}
\DoxyCodeLine{01327\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ new\_parent\_best\_blength);}
\DoxyCodeLine{01328\ }
\DoxyCodeLine{01336\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01337\ \ \ \textcolor{keywordtype}{void}\ updateUpperLR(std::stack<cmaple::Index>\&\ node\_stack,}
\DoxyCodeLine{01338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack\_aLRT);}
\DoxyCodeLine{01339\ }
\DoxyCodeLine{01344\ \ \ \textcolor{keywordtype}{void}\ recompute\_aLRT\_GrandChildren(PhyloNode\&\ parent,}
\DoxyCodeLine{01345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack\_aLRT);}
\DoxyCodeLine{01346\ }
\DoxyCodeLine{01354\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01355\ \ \ \textcolor{keywordtype}{void}\ calculate\_aRLT(\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ allow\_replacing\_ML\_tree);}
\DoxyCodeLine{01356\ }
\DoxyCodeLine{01362\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01363\ \ \ cmaple::RealNumType\ calculateSiteLhs(}
\DoxyCodeLine{01364\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_contributions,}
\DoxyCodeLine{01365\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_root);}
\DoxyCodeLine{01366\ }
\DoxyCodeLine{01372\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01373\ \ \ \textcolor{keywordtype}{void}\ calculate\_aRLT\_SH(}
\DoxyCodeLine{01374\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_contributions,}
\DoxyCodeLine{01375\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_root,}
\DoxyCodeLine{01376\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ LT1);}
\DoxyCodeLine{01377\ }
\DoxyCodeLine{01383\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01384\ \ \ cmaple::PositionType\ count\_aRLT\_SH\_branch(}
\DoxyCodeLine{01385\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_contributions,}
\DoxyCodeLine{01386\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_root,}
\DoxyCodeLine{01387\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01388\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ LT1);}
\DoxyCodeLine{01389\ }
\DoxyCodeLine{01396\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01397\ \ \ \textcolor{keywordtype}{void}\ calSiteLhDiffRoot(std::vector<cmaple::RealNumType>\&\ site\_lh\_diff,}
\DoxyCodeLine{01398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_root\_diff,}
\DoxyCodeLine{01399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<cmaple::RealNumType>\&\ site\_lh\_root,}
\DoxyCodeLine{01400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ parent\_new\_lower\_lh,}
\DoxyCodeLine{01401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ child\_2\_new\_blength,}
\DoxyCodeLine{01402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index);}
\DoxyCodeLine{01408\ }
\DoxyCodeLine{01415\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01416\ \ \ \textcolor{keywordtype}{void}\ calSiteLhDiffNonRoot(}
\DoxyCodeLine{01417\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_diff,}
\DoxyCodeLine{01418\ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_root\_diff,}
\DoxyCodeLine{01419\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<cmaple::RealNumType>\&\ site\_lh\_root,}
\DoxyCodeLine{01420\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ parent\_new\_lower\_lh,}
\DoxyCodeLine{01421\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\&\ child\_2\_new\_blength,}
\DoxyCodeLine{01422\ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01423\ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01424\ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01425\ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01426\ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01427\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index);}
\DoxyCodeLine{01428\ }
\DoxyCodeLine{01434\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01435\ \ \ \textcolor{keywordtype}{void}\ calSiteLhDiff(std::vector<cmaple::RealNumType>\&\ site\_lh\_diff,}
\DoxyCodeLine{01436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<cmaple::RealNumType>\&\ site\_lh\_root\_diff,}
\DoxyCodeLine{01437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<cmaple::RealNumType>\&\ site\_lh\_root,}
\DoxyCodeLine{01438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ current\_node,}
\DoxyCodeLine{01439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_1,}
\DoxyCodeLine{01440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ child\_2,}
\DoxyCodeLine{01441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ sibling,}
\DoxyCodeLine{01442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ parent,}
\DoxyCodeLine{01443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index);}
\DoxyCodeLine{01444\ }
\DoxyCodeLine{01448\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ readNextChar(std::istream\&\ in,}
\DoxyCodeLine{01449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::PositionType\&\ in\_line,}
\DoxyCodeLine{01450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::PositionType\&\ in\_column,}
\DoxyCodeLine{01451\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\&\ current\_ch\ =\ 0)\ \textcolor{keyword}{const};}
\DoxyCodeLine{01452\ }
\DoxyCodeLine{01459\ \ \ cmaple::NumSeqsType\ parseFile(}
\DoxyCodeLine{01460\ \ \ \ \ \ \ std::istream\&\ infile,}
\DoxyCodeLine{01461\ \ \ \ \ \ \ \textcolor{keywordtype}{char}\&\ ch,}
\DoxyCodeLine{01462\ \ \ \ \ \ \ cmaple::RealNumType\&\ branch\_len,}
\DoxyCodeLine{01463\ \ \ \ \ \ \ cmaple::PositionType\&\ in\_line,}
\DoxyCodeLine{01464\ \ \ \ \ \ \ cmaple::PositionType\&\ in\_column,}
\DoxyCodeLine{01465\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::map<std::string,\ cmaple::NumSeqsType>\&\ map\_seqname\_index,}
\DoxyCodeLine{01466\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ missing\_blengths);}
\DoxyCodeLine{01467\ }
\DoxyCodeLine{01472\ \ \ \textcolor{keywordtype}{void}\ collapseAllZeroLeave();}
\DoxyCodeLine{01473\ }
\DoxyCodeLine{01478\ \ \ \textcolor{keywordtype}{void}\ collapseOneZeroLeaf(PhyloNode\&\ node,}
\DoxyCodeLine{01479\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::Index\&\ node\_index,}
\DoxyCodeLine{01480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ neighbor\_1,}
\DoxyCodeLine{01481\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_1\_index,}
\DoxyCodeLine{01482\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ neighbor\_2);}
\DoxyCodeLine{01483\ }
\DoxyCodeLine{01487\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01488\ \ \ \textcolor{keywordtype}{void}\ updatePesudoCountModel(PhyloNode\&\ node,}
\DoxyCodeLine{01489\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index);}
\DoxyCodeLine{01491\ }
\DoxyCodeLine{01497\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01498\ \ \ \textcolor{keywordtype}{void}\ expandTreeByOneLessInfoSeq(PhyloNode\&\ node,}
\DoxyCodeLine{01499\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01500\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index);}
\DoxyCodeLine{01501\ }
\DoxyCodeLine{01510\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01511\ \ \ \textcolor{keywordtype}{void}\ updateBlengthReplaceMLTree(std::stack<cmaple::Index>\&\ node\_stack\_aLRT,}
\DoxyCodeLine{01512\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff,}
\DoxyCodeLine{01513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_blength);}
\DoxyCodeLine{01516\ }
\DoxyCodeLine{01524\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01525\ \ \ \textcolor{keywordtype}{void}\ addLessInfoSeqReplacingMLTree(std::stack<cmaple::Index>\&\ node\_stack\_aLRT,}
\DoxyCodeLine{01526\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ lh\_diff,}
\DoxyCodeLine{01527\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ node\_index,}
\DoxyCodeLine{01529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ parent\_index);}
\DoxyCodeLine{01530\ }
\DoxyCodeLine{01536\ \ \ std::string\ exportNodeString(\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ binary,}
\DoxyCodeLine{01537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::NumSeqsType\ node\_vec\_index,}
\DoxyCodeLine{01538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ show\_branch\_supports);}
\DoxyCodeLine{01539\ }
\DoxyCodeLine{01550\ \ \ \textcolor{keywordtype}{bool}\ readTree(std::istream\&\ tree\_stream);}
\DoxyCodeLine{01551\ }
\DoxyCodeLine{01557\ \ \ \textcolor{keywordtype}{bool}\ isComplete();}
\DoxyCodeLine{01558\ }
\DoxyCodeLine{01563\ \ \ \textcolor{keywordtype}{void}\ updateModelByAln();}
\DoxyCodeLine{01564\ }
\DoxyCodeLine{01570\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01571\ \ \ \textcolor{keywordtype}{void}\ updateModelLhAfterLoading();}
\DoxyCodeLine{01572\ }
\DoxyCodeLine{01576\ \ \ std::map<std::string,\ NumSeqsType>\ initMapSeqNameIndex();}
\DoxyCodeLine{01577\ }
\DoxyCodeLine{01584\ \ \ \textcolor{keywordtype}{void}\ remarkExistingSeqs();}
\DoxyCodeLine{01585\ }
\DoxyCodeLine{01595\ \ \ NumSeqsType\ markAnExistingSeq(}
\DoxyCodeLine{01596\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ seq\_name,}
\DoxyCodeLine{01597\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::map<std::string,\ NumSeqsType>\&\ map\_name\_index);}
\DoxyCodeLine{01598\ }
\DoxyCodeLine{01602\ \ \ \textcolor{keywordtype}{void}\ resetSeqAdded();}
\DoxyCodeLine{01603\ }
\DoxyCodeLine{01610\ \ \ \textcolor{keywordtype}{void}\ attachAlnModel(Alignment*\ aln,\ ModelBase*\ model);}
\DoxyCodeLine{01611\ }
\DoxyCodeLine{01617\ \ \ std::string\ \mbox{\hyperlink{classcmaple_1_1_tree_a8d1492f8a3291bd70af3a879b535f880}{exportNewick}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ binary,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ show\_branch\_supports);}
\DoxyCodeLine{01618\ }
\DoxyCodeLine{01623\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01624\ \ \ \textcolor{keywordtype}{void}\ updateZeroBlength(\textcolor{keyword}{const}\ cmaple::Index\ index,}
\DoxyCodeLine{01625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01626\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::stack<cmaple::Index>\&\ node\_stack);}
\DoxyCodeLine{01627\ }
\DoxyCodeLine{01635\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01636\ \ \ \textcolor{keywordtype}{void}\ updatePartialLh(std::stack<cmaple::Index>\&\ node\_stack);}
\DoxyCodeLine{01637\ }
\DoxyCodeLine{01644\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01645\ \ \ \textcolor{keywordtype}{void}\ seekSamplePlacement(\textcolor{keyword}{const}\ cmaple::Index\ start\_node\_index,}
\DoxyCodeLine{01646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{01647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample\_regions,}
\DoxyCodeLine{01648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::Index\&\ selected\_node\_index,}
\DoxyCodeLine{01649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_lh\_diff,}
\DoxyCodeLine{01650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ is\_mid\_branch,}
\DoxyCodeLine{01651\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_up\_lh\_diff,}
\DoxyCodeLine{01652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{01653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cmaple::Index\&\ best\_child\_index);}
\DoxyCodeLine{01654\ }
\DoxyCodeLine{01661\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01662\ \ \ \textcolor{keywordtype}{void}\ seekSubTreePlacement(}
\DoxyCodeLine{01663\ \ \ \ \ \ \ cmaple::Index\&\ best\_node\_index,}
\DoxyCodeLine{01664\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_lh\_diff,}
\DoxyCodeLine{01665\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\&\ is\_mid\_branch,}
\DoxyCodeLine{01666\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_up\_lh\_diff,}
\DoxyCodeLine{01667\ \ \ \ \ \ \ cmaple::RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{01668\ \ \ \ \ \ \ cmaple::Index\&\ best\_child\_index,}
\DoxyCodeLine{01669\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ short\_range\_search,}
\DoxyCodeLine{01670\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ child\_node\_index,}
\DoxyCodeLine{01671\ \ \ \ \ \ \ cmaple::RealNumType\&}
\DoxyCodeLine{01672\ \ \ \ \ \ \ \ \ \ \ removed\_blength);\ \ \textcolor{comment}{//,\ bool\ search\_subtree\_placement\ =\ true,}}
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ SeqRegions*\ sample\_regions\ =\ NULL);}}
\DoxyCodeLine{01674\ }
\DoxyCodeLine{01680\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01681\ \ \ \textcolor{keywordtype}{void}\ placeNewSampleMidBranch(\textcolor{keyword}{const}\ cmaple::Index\&\ selected\_node\_index,}
\DoxyCodeLine{01682\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{01683\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{01684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_lh\_diff);}
\DoxyCodeLine{01685\ }
\DoxyCodeLine{01691\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01692\ \ \ \textcolor{keywordtype}{void}\ placeNewSampleAtNode(\textcolor{keyword}{const}\ cmaple::Index\ selected\_node\_index,}
\DoxyCodeLine{01693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{01694\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{01695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_lh\_diff,}
\DoxyCodeLine{01696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_up\_lh\_diff,}
\DoxyCodeLine{01697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_down\_lh\_diff,}
\DoxyCodeLine{01698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ best\_child\_index);}
\DoxyCodeLine{01699\ }
\DoxyCodeLine{01706\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01707\ \ \ \textcolor{keywordtype}{void}\ applyOneSPR(\textcolor{keyword}{const}\ cmaple::Index\ subtree\_index,}
\DoxyCodeLine{01708\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ subtree,}
\DoxyCodeLine{01709\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ best\_node\_index,}
\DoxyCodeLine{01710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_mid\_branch,}
\DoxyCodeLine{01711\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ branch\_length,}
\DoxyCodeLine{01712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ best\_lh\_diff);}
\DoxyCodeLine{01713\ }
\DoxyCodeLine{01720\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01721\ \ \ \textcolor{keywordtype}{void}\ refreshAllLhs(\textcolor{keywordtype}{bool}\ avoid\_using\_upper\_lr\_lhs\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{01722\ }
\DoxyCodeLine{01729\ \ \ \textcolor{keywordtype}{void}\ resetSPRFlags(\textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ n\_SPR\_applied,}
\DoxyCodeLine{01730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ update\_outdated,}
\DoxyCodeLine{01731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ n\_outdated);}
\DoxyCodeLine{01732\ }
\DoxyCodeLine{01739\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01740\ \ \ cmaple::RealNumType\ improveEntireTree(\textcolor{keywordtype}{bool}\ short\_range\_search);}
\DoxyCodeLine{01741\ }
\DoxyCodeLine{01748\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01749\ \ \ cmaple::PositionType\ optimizeBranchIter();}
\DoxyCodeLine{01750\ }
\DoxyCodeLine{01755\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01756\ \ \ cmaple::RealNumType\ estimateBranchLength(}
\DoxyCodeLine{01757\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_regions,}
\DoxyCodeLine{01758\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ child\_regions);}
\DoxyCodeLine{01759\ }
\DoxyCodeLine{01764\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01765\ \ \ cmaple::RealNumType\ estimateBranchLengthWithCheck(}
\DoxyCodeLine{01766\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_lr\_regions,}
\DoxyCodeLine{01767\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions,}
\DoxyCodeLine{01768\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ current\_blength);}
\DoxyCodeLine{01769\ }
\DoxyCodeLine{01774\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01775\ \ \ cmaple::RealNumType\ calculateSamplePlacementCost(}
\DoxyCodeLine{01776\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_regions,}
\DoxyCodeLine{01777\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ child\_regions,}
\DoxyCodeLine{01778\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ blength);}
\DoxyCodeLine{01779\ }
\DoxyCodeLine{01784\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01785\ \ \ cmaple::RealNumType\ calculateSubTreePlacementCost(}
\DoxyCodeLine{01786\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ parent\_regions,}
\DoxyCodeLine{01787\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ child\_regions,}
\DoxyCodeLine{01788\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::RealNumType\ blength);}
\DoxyCodeLine{01789\ }
\DoxyCodeLine{01795\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01796\ \ \ \textcolor{keywordtype}{void}\ updateLowerLh(cmaple::RealNumType\&\ total\_lh,}
\DoxyCodeLine{01797\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ new\_lower\_lh,}
\DoxyCodeLine{01798\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01799\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_lh\_1,}
\DoxyCodeLine{01800\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_lh\_2,}
\DoxyCodeLine{01801\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_1\_index,}
\DoxyCodeLine{01802\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ neighbor\_1,}
\DoxyCodeLine{01803\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_2\_index,}
\DoxyCodeLine{01804\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ neighbor\_2,}
\DoxyCodeLine{01805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\&\ seq\_length);}
\DoxyCodeLine{01806\ }
\DoxyCodeLine{01814\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01815\ \ \ \textcolor{keywordtype}{void}\ updateLowerLhAvoidUsingUpperLRLh(}
\DoxyCodeLine{01816\ \ \ \ \ \ \ cmaple::RealNumType\&\ total\_lh,}
\DoxyCodeLine{01817\ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ new\_lower\_lh,}
\DoxyCodeLine{01818\ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01819\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_lh\_1,}
\DoxyCodeLine{01820\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_lh\_2,}
\DoxyCodeLine{01821\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_1\_index,}
\DoxyCodeLine{01822\ \ \ \ \ \ \ PhyloNode\&\ neighbor\_1,}
\DoxyCodeLine{01823\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_2\_index,}
\DoxyCodeLine{01824\ \ \ \ \ \ \ PhyloNode\&\ neighbor\_2,}
\DoxyCodeLine{01825\ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\&\ seq\_length);}
\DoxyCodeLine{01826\ }
\DoxyCodeLine{01832\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01833\ \ \ \textcolor{keywordtype}{void}\ computeLhContribution(cmaple::RealNumType\&\ total\_lh,}
\DoxyCodeLine{01834\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ new\_lower\_lh,}
\DoxyCodeLine{01835\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ node,}
\DoxyCodeLine{01836\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_lh\_1,}
\DoxyCodeLine{01837\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_lh\_2,}
\DoxyCodeLine{01838\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_1\_index,}
\DoxyCodeLine{01839\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ neighbor\_1,}
\DoxyCodeLine{01840\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::Index\ neighbor\_2\_index,}
\DoxyCodeLine{01841\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&\ neighbor\_2,}
\DoxyCodeLine{01842\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cmaple::PositionType\&\ seq\_length);}
\DoxyCodeLine{01843\ }
\DoxyCodeLine{01847\ \ \ \textcolor{keyword}{template}\ <void\ (Tree::*task)(cmaple::RealNumType\&,}
\DoxyCodeLine{01848\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{01849\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&,}
\DoxyCodeLine{01850\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{01851\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ std::unique\_ptr<SeqRegions>\&,}
\DoxyCodeLine{01852\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ cmaple::Index,}
\DoxyCodeLine{01853\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&,}
\DoxyCodeLine{01854\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ cmaple::Index,}
\DoxyCodeLine{01855\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PhyloNode\&,}
\DoxyCodeLine{01856\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ cmaple::PositionType\&)>}
\DoxyCodeLine{01857\ \ \ cmaple::RealNumType\ performDFS();}
\DoxyCodeLine{01858\ }
\DoxyCodeLine{01863\ \ \ \textcolor{keyword}{template}\ <const\ cmaple::StateType\ num\_states>}
\DoxyCodeLine{01864\ \ \ \textcolor{keywordtype}{void}\ updateModelParams();}
\DoxyCodeLine{01865\ }
\DoxyCodeLine{01869\ \ \ \textcolor{keyword}{template}\ <}
\DoxyCodeLine{01870\ \ \ \ \ \ \ void\ (Tree::*task)(PhyloNode\&,\ const\ cmaple::Index,\ const\ cmaple::Index)>}
\DoxyCodeLine{01871\ \ \ void\ performDFSAtLeave();}
\DoxyCodeLine{01872\ }
\DoxyCodeLine{01873\ \ \ \textcolor{comment}{//\ NHANLT:\ Debug\ aLRT}}
\DoxyCodeLine{01874\ \ \ \textcolor{comment}{//\ void\ log\_current(std::stack<cmaple::Index>\&\ node\_stack\_aLRT);}}
\DoxyCodeLine{01875\ \};}
\DoxyCodeLine{01876\ }
\DoxyCodeLine{01885\ std::ostream\&\ \mbox{\hyperlink{group__cmaple_gabf49c77ec0934b4d8750f61dd3ac6d71}{operator<<}}(std::ostream\&\ out\_stream,\ \mbox{\hyperlink{classcmaple_1_1_tree}{cmaple::Tree}}\&\ tree);}
\DoxyCodeLine{01886\ }
\DoxyCodeLine{01889\ std::istream\&\ \mbox{\hyperlink{group__cmaple_ga9f041909a438d7173dc9f15dcf20762d}{operator>>}}(std::istream\&\ in\_stream,\ \mbox{\hyperlink{classcmaple_1_1_tree}{cmaple::Tree}}\&\ tree);}
\DoxyCodeLine{01890\ }
\DoxyCodeLine{01894\ \textcolor{keyword}{template}\ <const\ StateType\ num\_states>}
\DoxyCodeLine{01895\ \textcolor{keywordtype}{void}\ cmaple::Tree::refreshAllLhs(\textcolor{keywordtype}{bool}\ avoid\_using\_upper\_lr\_lhs)\ \{}
\DoxyCodeLine{01896\ \ \ \textcolor{comment}{//\ 1.\ update\ all\ the\ lower\ lhs\ along\ the\ tree}}
\DoxyCodeLine{01897\ \ \ \textcolor{keywordflow}{if}\ (avoid\_using\_upper\_lr\_lhs)\ \{}
\DoxyCodeLine{01898\ \ \ \ \ performDFS<\&cmaple::Tree::updateLowerLhAvoidUsingUpperLRLh<num\_states>>();}
\DoxyCodeLine{01899\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01900\ \ \ \ \ performDFS<\&cmaple::Tree::updateLowerLh<num\_states>>();}
\DoxyCodeLine{01901\ \ \ \}}
\DoxyCodeLine{01902\ }
\DoxyCodeLine{01903\ \ \ \textcolor{comment}{//\ 2.\ update\ all\ the\ non-\/lower\ lhs\ along\ the\ tree}}
\DoxyCodeLine{01904\ \ \ refreshAllNonLowerLhs<num\_states>();}
\DoxyCodeLine{01905\ \}}
\DoxyCodeLine{01906\ }
\DoxyCodeLine{01907\ \textcolor{keyword}{template}\ <const\ StateType\ num\_states>}
\DoxyCodeLine{01908\ RealNumType\ cmaple::Tree::improveEntireTree(\textcolor{keywordtype}{bool}\ short\_range\_search)\ \{}
\DoxyCodeLine{01909\ \ \ \textcolor{comment}{//\ start\ from\ the\ root}}
\DoxyCodeLine{01910\ \ \ std::stack<Index>\ node\_stack;}
\DoxyCodeLine{01911\ \ \ node\_stack.push(Index(root\_vector\_index,\ TOP));}
\DoxyCodeLine{01912\ }
\DoxyCodeLine{01913\ \ \ \textcolor{comment}{//\ dummy\ variables}}
\DoxyCodeLine{01914\ \ \ RealNumType\ total\_improvement\ =\ 0;}
\DoxyCodeLine{01915\ \ \ PositionType\ num\_nodes\ =\ 0;}
\DoxyCodeLine{01916\ }
\DoxyCodeLine{01917\ \ \ \textcolor{comment}{//\ traverse\ downward\ the\ tree}}
\DoxyCodeLine{01918\ \ \ \textcolor{keywordflow}{while}\ (!node\_stack.empty())\ \{}
\DoxyCodeLine{01919\ \ \ \ \ \textcolor{comment}{//\ pick\ the\ top\ node\ from\ the\ stack}}
\DoxyCodeLine{01920\ \ \ \ \ Index\ index\ =\ node\_stack.top();}
\DoxyCodeLine{01921\ \ \ \ \ node\_stack.pop();}
\DoxyCodeLine{01922\ \ \ \ \ PhyloNode\&\ node\ =\ nodes[index.getVectorIndex()];}
\DoxyCodeLine{01923\ \ \ \ \ \textcolor{comment}{//\ MiniIndex\ mini\_index\ =\ index.getMiniIndex();}}
\DoxyCodeLine{01924\ }
\DoxyCodeLine{01925\ \ \ \ \ \textcolor{comment}{//\ add\ all\ children\ of\ the\ current\ nodes\ to\ the\ stack\ for\ further\ traversing}}
\DoxyCodeLine{01926\ \ \ \ \ \textcolor{comment}{//\ later}}
\DoxyCodeLine{01927\ \ \ \ \ \textcolor{comment}{/*for\ (Index\ neighbor\_index:node.getNeighborIndexes(mini\_index))}}
\DoxyCodeLine{01928\ \textcolor{comment}{\ \ \ \ \ \ \ \ node\_stack.push(neighbor\_index);*/}}
\DoxyCodeLine{01929\ \ \ \ \ assert(index.getMiniIndex()\ ==\ TOP);}
\DoxyCodeLine{01930\ \ \ \ \ \textcolor{keywordflow}{if}\ (node.isInternal())\ \{}
\DoxyCodeLine{01931\ \ \ \ \ \ \ node\_stack.push(node.getNeighborIndex(RIGHT));}
\DoxyCodeLine{01932\ \ \ \ \ \ \ node\_stack.push(node.getNeighborIndex(LEFT));}
\DoxyCodeLine{01933\ \ \ \ \ \}}
\DoxyCodeLine{01934\ }
\DoxyCodeLine{01935\ \ \ \ \ \textcolor{comment}{//\ only\ process\ outdated\ node\ to\ avoid\ traversing\ the\ same\ part\ of\ the\ tree}}
\DoxyCodeLine{01936\ \ \ \ \ \textcolor{comment}{//\ multiple\ times}}
\DoxyCodeLine{01937\ \ \ \ \ \textcolor{keywordflow}{if}\ (node.isOutdated()\ \&\&\ node.getSPRCount()\ <=\ 5)\ \{}
\DoxyCodeLine{01938\ \ \ \ \ \ \ node.setOutdated(\textcolor{keyword}{false});}
\DoxyCodeLine{01939\ }
\DoxyCodeLine{01940\ \ \ \ \ \ \ \textcolor{comment}{//\ if\ checkEachSPR:}}
\DoxyCodeLine{01941\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ root=node}}
\DoxyCodeLine{01942\ \ \ \ \ \ \ \textcolor{comment}{//\ \ while\ root.up!=None:}}
\DoxyCodeLine{01943\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ root=root.up}}
\DoxyCodeLine{01944\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \#print("{}Pre-\/SPR\ tree:\ "{}+createBinaryNewick(root))}}
\DoxyCodeLine{01945\ \ \ \ \ \ \ \textcolor{comment}{//\ \ oldTreeLK=calculateTreeLikelihood(root,mutMatrix,checkCorrectness=True)}}
\DoxyCodeLine{01946\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \#print("{}Pre-\/SPR\ tree\ likelihood:\ "{}+str(oldTreeLK))}}
\DoxyCodeLine{01947\ \ \ \ \ \ \ \textcolor{comment}{//\ reCalculateAllGenomeLists(root,mutMatrix,\ checkExistingAreCorrect=True)}}
\DoxyCodeLine{01948\ }
\DoxyCodeLine{01949\ \ \ \ \ \ \ \textcolor{comment}{//\ do\ SPR\ moves\ to\ improve\ the\ tree}}
\DoxyCodeLine{01950\ \ \ \ \ \ \ RealNumType\ improvement\ =}
\DoxyCodeLine{01951\ \ \ \ \ \ \ \ \ \ \ improveSubTree<num\_states>(index,\ node,\ short\_range\_search);}
\DoxyCodeLine{01952\ }
\DoxyCodeLine{01953\ \ \ \ \ \ \ \textcolor{comment}{//\ if\ checkEachSPR:}}
\DoxyCodeLine{01954\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \#print("{}\ apparent\ improvement\ "{}+str(improvement))}}
\DoxyCodeLine{01955\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ root=node}}
\DoxyCodeLine{01956\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ while\ root.up!=None:}}
\DoxyCodeLine{01957\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ root=root.up}}
\DoxyCodeLine{01958\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \#print("{}Post-\/SPR\ tree:\ "{}+createBinaryNewick(root))}}
\DoxyCodeLine{01959\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ newTreeLK=calculateTreeLikelihood(root,mutMatrix)}}
\DoxyCodeLine{01960\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ reCalculateAllGenomeLists(root,mutMatrix,}}
\DoxyCodeLine{01961\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ checkExistingAreCorrect=True)}}
\DoxyCodeLine{01962\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \#print("{}Post-\/SPR\ tree\ likelihood:\ "{}+str(newTreeLK))}}
\DoxyCodeLine{01963\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ if\ newTreeLK-\/oldTreeLK\ <\ improvement-\/1.0:}}
\DoxyCodeLine{01964\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ print("{}In\ startTopologyUpdates,\ LK\ score\ of\ improvement}}
\DoxyCodeLine{01965\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}+str(newTreeLK)+"{}\ -\/\ "{}+str(oldTreeLK)+"{}\ =}}
\DoxyCodeLine{01966\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}+str(newTreeLK-\/oldTreeLK)+"{}\ is\ less\ than\ //what\ is}}
\DoxyCodeLine{01967\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ supposd\ to\ be\ "{}+str(improvement))}}
\DoxyCodeLine{01968\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ exit()}}
\DoxyCodeLine{01969\ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01970\ }
\DoxyCodeLine{01971\ \ \ \ \ \ \ \textcolor{comment}{//\ update\ total\_improvement}}
\DoxyCodeLine{01972\ \ \ \ \ \ \ total\_improvement\ +=\ improvement;}
\DoxyCodeLine{01973\ }
\DoxyCodeLine{01974\ \ \ \ \ \ \ \textcolor{comment}{//\ NHANLT:\ LOGS\ FOR\ DEBUGGING}}
\DoxyCodeLine{01975\ \ \ \ \ \ \ \textcolor{comment}{/*if\ (params-\/>debug\ \&\&\ improvement\ >\ 0)}}
\DoxyCodeLine{01976\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ std::cout\ <<\ num\_nodes\ <<\ "{}:\ "{}\ <<\ std::setprecision(20)\ <<}}
\DoxyCodeLine{01977\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ total\_improvement\ <<\ std::endl;*/}}
\DoxyCodeLine{01978\ }
\DoxyCodeLine{01979\ \ \ \ \ \ \ \textcolor{comment}{//\ Show\ log\ every\ 1000\ nodes}}
\DoxyCodeLine{01980\ \ \ \ \ \ \ num\_nodes\ +=\ 1;}
\DoxyCodeLine{01981\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cmaple::verbose\_mode\ >=\ cmaple::VB\_DEBUG\ \&\&\ num\_nodes\ \%\ 1000\ ==\ 0)\ \{}
\DoxyCodeLine{01982\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}Processed\ topology\ for\ "{}}\ <<\ convertIntToString(num\_nodes)}
\DoxyCodeLine{01983\ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ nodes."{}}\ <<\ std::endl;}
\DoxyCodeLine{01984\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01985\ \ \ \ \ \}}
\DoxyCodeLine{01986\ \ \ \}}
\DoxyCodeLine{01987\ }
\DoxyCodeLine{01988\ \ \ \textcolor{keywordflow}{return}\ total\_improvement;}
\DoxyCodeLine{01989\ \}}
\DoxyCodeLine{01990\ }
\DoxyCodeLine{01991\ \textcolor{keyword}{template}\ <const\ StateType\ num\_states>}
\DoxyCodeLine{01992\ \textcolor{keywordtype}{void}\ cmaple::Tree::updateModelParams()\ \{}
\DoxyCodeLine{01993\ \ \ \textcolor{comment}{//\ perform\ a\ DFS\ -\/>\ at\ each\ leaf,\ update\ the\ pesudoCount\ of\ the\ model\ based\ on}}
\DoxyCodeLine{01994\ \ \ \textcolor{comment}{//\ the\ sequence\ of\ that\ leaf}}
\DoxyCodeLine{01995\ \ \ performDFSAtLeave<\&cmaple::Tree::updatePesudoCountModel<num\_states>>();}
\DoxyCodeLine{01996\ }
\DoxyCodeLine{01997\ \ \ \textcolor{comment}{//\ update\ model\ params\ based\ on\ the\ pseudo\ count}}
\DoxyCodeLine{01998\ \ \ \textcolor{keywordflow}{if}\ (model-\/>updateMutationMatEmpirical(aln))\ \{}
\DoxyCodeLine{01999\ \ \ \ \ computeCumulativeRate();}
\DoxyCodeLine{02000\ \ \ \}}
\DoxyCodeLine{02001\ \}}
\DoxyCodeLine{02002\ }
\DoxyCodeLine{02003\ \textcolor{keyword}{template}\ <const\ StateType\ num\_states>}
\DoxyCodeLine{02004\ \textcolor{keywordtype}{void}\ cmaple::Tree::seekSamplePlacement(}
\DoxyCodeLine{02005\ \ \ \ \ \textcolor{keyword}{const}\ Index\ start\_node\_index,}
\DoxyCodeLine{02006\ \ \ \ \ \textcolor{keyword}{const}\ NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{02007\ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ sample\_regions,}
\DoxyCodeLine{02008\ \ \ \ \ Index\&\ selected\_node\_index,}
\DoxyCodeLine{02009\ \ \ \ \ RealNumType\&\ best\_lh\_diff,}
\DoxyCodeLine{02010\ \ \ \ \ \textcolor{keywordtype}{bool}\&\ is\_mid\_branch,}
\DoxyCodeLine{02011\ \ \ \ \ RealNumType\&\ best\_up\_lh\_diff,}
\DoxyCodeLine{02012\ \ \ \ \ RealNumType\&\ best\_down\_lh\_diff,}
\DoxyCodeLine{02013\ \ \ \ \ Index\&\ best\_child\_index)\ \{}
\DoxyCodeLine{02014\ \ \ \textcolor{comment}{//\ init\ variables}}
\DoxyCodeLine{02015\ \ \ \textcolor{comment}{//\ output\ variables}}
\DoxyCodeLine{02016\ \ \ selected\_node\_index\ =\ start\_node\_index;}
\DoxyCodeLine{02017\ \ \ \textcolor{comment}{//\ dummy\ variables}}
\DoxyCodeLine{02018\ \ \ RealNumType\ lh\_diff\_mid\_branch\ =\ 0;}
\DoxyCodeLine{02019\ \ \ RealNumType\ lh\_diff\_at\_node\ =\ 0;}
\DoxyCodeLine{02020\ \ \ \textcolor{comment}{//\ stack\ of\ nodes\ to\ examine\ positions}}
\DoxyCodeLine{02021\ \ \ std::stack<TraversingNode>\ extended\_node\_stack;}
\DoxyCodeLine{02022\ \ \ extended\_node\_stack.push(TraversingNode(start\_node\_index,\ 0,\ MIN\_NEGATIVE));}
\DoxyCodeLine{02023\ }
\DoxyCodeLine{02024\ \ \ \textcolor{comment}{//\ recursively\ examine\ positions\ for\ placing\ the\ new\ sample}}
\DoxyCodeLine{02025\ \ \ \textcolor{keywordflow}{while}\ (!extended\_node\_stack.empty())\ \{}
\DoxyCodeLine{02026\ \ \ \ \ TraversingNode\ current\_extended\_node\ =\ std::move(extended\_node\_stack.top());}
\DoxyCodeLine{02027\ \ \ \ \ extended\_node\_stack.pop();}
\DoxyCodeLine{02028\ \ \ \ \ \textcolor{keyword}{const}\ NumSeqsType\ current\_node\_vec\ =}
\DoxyCodeLine{02029\ \ \ \ \ \ \ \ \ current\_extended\_node.getIndex().getVectorIndex();}
\DoxyCodeLine{02030\ \ \ \ \ PhyloNode\&\ current\_node\ =\ nodes[current\_node\_vec];}
\DoxyCodeLine{02031\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\&\ is\_internal\ =\ current\_node.isInternal();}
\DoxyCodeLine{02032\ }
\DoxyCodeLine{02033\ \ \ \ \ \textcolor{comment}{//\ NHANLT:\ debug}}
\DoxyCodeLine{02034\ \ \ \ \ \textcolor{comment}{//\ if\ (current\_node-\/>next\ \&\&\ ((current\_node-\/>next-\/>neighbor\ \&\&}}
\DoxyCodeLine{02035\ \ \ \ \ \textcolor{comment}{//\ current\_node-\/>next-\/>neighbor-\/>seq\_name\ ==\ "{}25"{})}}
\DoxyCodeLine{02036\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ (current\_node-\/>next-\/>next-\/>neighbor\ \&\&}}
\DoxyCodeLine{02037\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ current\_node-\/>next-\/>next-\/>neighbor-\/>seq\_name\ ==}}
\DoxyCodeLine{02038\ \ \ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ "{}25"{})))}}
\DoxyCodeLine{02039\ \ \ \ \ \textcolor{comment}{//\ cout\ <<\ "{}fdsfsd"{};}}
\DoxyCodeLine{02040\ }
\DoxyCodeLine{02041\ \ \ \ \ \textcolor{comment}{//\ if\ the\ current\ node\ is\ a\ leaf\ AND\ the\ new\ sample/sequence\ is\ strictly}}
\DoxyCodeLine{02042\ \ \ \ \ \textcolor{comment}{//\ less\ informative\ than\ the\ current\ node}}
\DoxyCodeLine{02043\ \ \ \ \ \textcolor{comment}{//\ -\/>\ add\ the\ new\ sequence\ into\ the\ list\ of\ minor\ sequences\ of\ the\ current}}
\DoxyCodeLine{02044\ \ \ \ \ \textcolor{comment}{//\ node\ +\ stop\ seeking\ the\ placement}}
\DoxyCodeLine{02045\ \ \ \ \ \textcolor{keywordflow}{if}\ ((!is\_internal)\ \&\&}
\DoxyCodeLine{02046\ \ \ \ \ \ \ \ \ (current\_node.getPartialLh(TOP)-\/>compareWithSample(}
\DoxyCodeLine{02047\ \ \ \ \ \ \ \ \ \ \ \ \ \ *sample\_regions,\ aln-\/>ref\_seq.size(),\ aln)\ ==\ 1))\ \{}
\DoxyCodeLine{02048\ \ \ \ \ \ \ current\_node.addLessInfoSeqs(seq\_name\_index);}
\DoxyCodeLine{02049\ \ \ \ \ \ \ selected\_node\_index\ =\ Index();}
\DoxyCodeLine{02050\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02051\ \ \ \ \ \}}
\DoxyCodeLine{02052\ }
\DoxyCodeLine{02053\ \ \ \ \ \textcolor{keyword}{const}\ RealNumType\ current\_node\_blength\ =\ current\_node.getUpperLength();}
\DoxyCodeLine{02054\ }
\DoxyCodeLine{02055\ \ \ \ \ \textcolor{comment}{//\ 1.\ try\ first\ placing\ as\ a\ descendant\ of\ the\ mid-\/branch\ point\ of\ the}}
\DoxyCodeLine{02056\ \ \ \ \ \textcolor{comment}{//\ branch\ above\ the\ current\ node}}
\DoxyCodeLine{02057\ \ \ \ \ \textcolor{keywordflow}{if}\ (root\_vector\_index\ !=\ current\_node\_vec\ \&\&\ current\_node\_blength\ >\ 0)\ \{}
\DoxyCodeLine{02058\ \ \ \ \ \ \ examineSamplePlacementMidBranch<num\_states>(}
\DoxyCodeLine{02059\ \ \ \ \ \ \ \ \ \ \ selected\_node\_index,\ current\_node.getMidBranchLh(),\ best\_lh\_diff,}
\DoxyCodeLine{02060\ \ \ \ \ \ \ \ \ \ \ is\_mid\_branch,\ lh\_diff\_mid\_branch,\ current\_extended\_node,}
\DoxyCodeLine{02061\ \ \ \ \ \ \ \ \ \ \ sample\_regions);}
\DoxyCodeLine{02062\ \ \ \ \ \}}
\DoxyCodeLine{02063\ \ \ \ \ \textcolor{comment}{//\ otherwise,\ don't\ consider\ mid-\/branch\ point}}
\DoxyCodeLine{02064\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02065\ \ \ \ \ \ \ lh\_diff\_mid\_branch\ =\ MIN\_NEGATIVE;}
\DoxyCodeLine{02066\ \ \ \ \ \}}
\DoxyCodeLine{02067\ }
\DoxyCodeLine{02068\ \ \ \ \ \textcolor{comment}{//\ 2.\ try\ to\ place\ as\ descendant\ of\ the\ current\ node\ (this\ is\ skipped\ if\ the}}
\DoxyCodeLine{02069\ \ \ \ \ \textcolor{comment}{//\ node\ has\ top\ branch\ length\ 0\ and\ so\ is\ part\ of\ a\ polytomy).}}
\DoxyCodeLine{02070\ \ \ \ \ \textcolor{keywordflow}{if}\ (root\_vector\_index\ ==\ current\_node\_vec\ ||\ current\_node\_blength\ >\ 0)\ \{}
\DoxyCodeLine{02071\ \ \ \ \ \ \ examineSamplePlacementAtNode<num\_states>(}
\DoxyCodeLine{02072\ \ \ \ \ \ \ \ \ \ \ selected\_node\_index,\ current\_node.getTotalLh(),\ best\_lh\_diff,}
\DoxyCodeLine{02073\ \ \ \ \ \ \ \ \ \ \ is\_mid\_branch,\ lh\_diff\_at\_node,\ lh\_diff\_mid\_branch,\ best\_up\_lh\_diff,}
\DoxyCodeLine{02074\ \ \ \ \ \ \ \ \ \ \ best\_down\_lh\_diff,\ best\_child\_index,\ current\_extended\_node,}
\DoxyCodeLine{02075\ \ \ \ \ \ \ \ \ \ \ sample\_regions);}
\DoxyCodeLine{02076\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02077\ \ \ \ \ \ \ lh\_diff\_at\_node\ =\ current\_extended\_node.getLhDiff();}
\DoxyCodeLine{02078\ \ \ \ \ \}}
\DoxyCodeLine{02079\ }
\DoxyCodeLine{02080\ \ \ \ \ \textcolor{comment}{//\ keep\ trying\ to\ place\ at\ children\ nodes,\ unless\ the\ number\ of\ attempts\ has}}
\DoxyCodeLine{02081\ \ \ \ \ \textcolor{comment}{//\ reaches\ the\ failure\ limit}}
\DoxyCodeLine{02082\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{short}\ \textcolor{keywordtype}{int}\ failure\_count\ =\ current\_extended\_node.getFailureCount();}
\DoxyCodeLine{02083\ \ \ \ \ \textcolor{keywordflow}{if}\ ((params-\/>strict\_stop\_seeking\_placement\_sample\ \&\&}
\DoxyCodeLine{02084\ \ \ \ \ \ \ \ \ \ failure\_count\ <=\ params-\/>failure\_limit\_sample\ \&\&}
\DoxyCodeLine{02085\ \ \ \ \ \ \ \ \ \ lh\_diff\_at\_node\ >\ (best\_lh\_diff\ -\/\ params-\/>thresh\_log\_lh\_sample))\ ||}
\DoxyCodeLine{02086\ \ \ \ \ \ \ \ \ (!params-\/>strict\_stop\_seeking\_placement\_sample\ \&\&}
\DoxyCodeLine{02087\ \ \ \ \ \ \ \ \ \ (failure\_count\ <=\ params-\/>failure\_limit\_sample\ ||}
\DoxyCodeLine{02088\ \ \ \ \ \ \ \ \ \ \ lh\_diff\_at\_node\ >\ (best\_lh\_diff\ -\/\ params-\/>thresh\_log\_lh\_sample))))\ \{}
\DoxyCodeLine{02089\ \ \ \ \ \ \ \textcolor{comment}{/*for\ (Index\ neighbor\_index:current\_node.getNeighborIndexes(TOP))}}
\DoxyCodeLine{02090\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ extended\_node\_stack.push(TraversingNode(neighbor\_index,}}
\DoxyCodeLine{02091\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ current\_extended\_node.getFailureCount(),\ lh\_diff\_at\_node));*/}}
\DoxyCodeLine{02092\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_internal)\ \{}
\DoxyCodeLine{02093\ \ \ \ \ \ \ \ \ extended\_node\_stack.push(}
\DoxyCodeLine{02094\ \ \ \ \ \ \ \ \ \ \ \ \ TraversingNode(current\_node.getNeighborIndex(RIGHT),\ failure\_count,}
\DoxyCodeLine{02095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lh\_diff\_at\_node));}
\DoxyCodeLine{02096\ \ \ \ \ \ \ \ \ extended\_node\_stack.push(}
\DoxyCodeLine{02097\ \ \ \ \ \ \ \ \ \ \ \ \ TraversingNode(current\_node.getNeighborIndex(LEFT),\ failure\_count,}
\DoxyCodeLine{02098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lh\_diff\_at\_node));}
\DoxyCodeLine{02099\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02100\ \ \ \ \ \}}
\DoxyCodeLine{02101\ \ \ \}}
\DoxyCodeLine{02102\ }
\DoxyCodeLine{02103\ \ \ \textcolor{comment}{//\ exploration\ of\ the\ tree\ is\ finished,\ and\ we\ are\ left\ with\ the\ node\ found\ so}}
\DoxyCodeLine{02104\ \ \ \textcolor{comment}{//\ far\ with\ the\ best\ appending\ likelihood\ cost.\ Now\ we\ explore\ placement\ just}}
\DoxyCodeLine{02105\ \ \ \textcolor{comment}{//\ below\ this\ node\ for\ more\ fine-\/grained\ placement\ within\ its\ descendant}}
\DoxyCodeLine{02106\ \ \ \textcolor{comment}{//\ branches.}}
\DoxyCodeLine{02107\ \ \ best\_down\_lh\_diff\ =\ MIN\_NEGATIVE;}
\DoxyCodeLine{02108\ \ \ best\_child\_index\ =\ Index();}
\DoxyCodeLine{02109\ \ \ ;}
\DoxyCodeLine{02110\ }
\DoxyCodeLine{02111\ \ \ \textcolor{comment}{//\ if\ best\ position\ so\ far\ is\ the\ descendant\ of\ a\ node\ -\/>\ explore\ further\ at}}
\DoxyCodeLine{02112\ \ \ \textcolor{comment}{//\ its\ children}}
\DoxyCodeLine{02113\ \ \ \textcolor{keywordflow}{if}\ (!is\_mid\_branch)\ \{}
\DoxyCodeLine{02114\ \ \ \ \ finetuneSamplePlacementAtNode<num\_states>(}
\DoxyCodeLine{02115\ \ \ \ \ \ \ \ \ nodes[selected\_node\_index.getVectorIndex()],\ best\_down\_lh\_diff,}
\DoxyCodeLine{02116\ \ \ \ \ \ \ \ \ best\_child\_index,\ sample\_regions);}
\DoxyCodeLine{02117\ \ \ \}}
\DoxyCodeLine{02118\ \}}
\DoxyCodeLine{02119\ }
\DoxyCodeLine{02120\ \textcolor{keyword}{template}\ <const\ StateType\ num\_states>}
\DoxyCodeLine{02121\ \textcolor{keywordtype}{void}\ cmaple::Tree::placeNewSampleAtNode(\textcolor{keyword}{const}\ Index\ selected\_node\_index,}
\DoxyCodeLine{02122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{02123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{02124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ RealNumType\ best\_lh\_diff,}
\DoxyCodeLine{02125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ RealNumType\ best\_up\_lh\_diff,}
\DoxyCodeLine{02126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ RealNumType\ best\_down\_lh\_diff,}
\DoxyCodeLine{02127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Index\ best\_child\_index)\ \{}
\DoxyCodeLine{02128\ \ \ \textcolor{comment}{//\ dummy\ variables}}
\DoxyCodeLine{02129\ \ \ RealNumType\ best\_child\_lh\ =\ MIN\_NEGATIVE;}
\DoxyCodeLine{02130\ \ \ RealNumType\ best\_child\_blength\_split\ =\ 0;}
\DoxyCodeLine{02131\ \ \ RealNumType\ best\_parent\_lh;}
\DoxyCodeLine{02132\ \ \ RealNumType\ best\_parent\_blength\_split\ =\ 0;}
\DoxyCodeLine{02133\ \ \ RealNumType\ best\_root\_blength\ =\ -\/1;}
\DoxyCodeLine{02134\ \ \ \textcolor{keyword}{const}\ RealNumType\ threshold\_prob\ =\ params-\/>threshold\_prob;}
\DoxyCodeLine{02135\ \ \ std::unique\_ptr<SeqRegions>\ best\_parent\_regions\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02136\ \ \ std::unique\_ptr<SeqRegions>\ best\_child\_regions\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02137\ }
\DoxyCodeLine{02138\ \ \ assert(selected\_node\_index.getMiniIndex()\ ==\ TOP);}
\DoxyCodeLine{02139\ \ \ \textcolor{keyword}{const}\ NumSeqsType\ selected\_node\_vec\_index\ =}
\DoxyCodeLine{02140\ \ \ \ \ \ \ selected\_node\_index.getVectorIndex();}
\DoxyCodeLine{02141\ \ \ PhyloNode\&\ selected\_node\ =\ nodes[selected\_node\_vec\_index];}
\DoxyCodeLine{02142\ }
\DoxyCodeLine{02143\ \ \ \textcolor{comment}{//\ place\ the\ new\ sample\ as\ a\ descendant\ of\ an\ existing\ node}}
\DoxyCodeLine{02144\ \ \ \textcolor{keywordflow}{if}\ (best\_child\_index.getMiniIndex()\ !=\ UNDEFINED)\ \{}
\DoxyCodeLine{02145\ \ \ \ \ PhyloNode\&\ best\_child\ =\ nodes[best\_child\_index.getVectorIndex()];}
\DoxyCodeLine{02146\ \ \ \ \ best\_child\_lh\ =\ best\_down\_lh\_diff;}
\DoxyCodeLine{02147\ \ \ \ \ assert(best\_child\_index.getMiniIndex()\ ==\ TOP);}
\DoxyCodeLine{02148\ \ \ \ \ best\_child\_blength\_split\ =}
\DoxyCodeLine{02149\ \ \ \ \ \ \ \ \ 0.5\ *\ best\_child.getUpperLength();\ \ \textcolor{comment}{//\ best\_child-\/>length;}}
\DoxyCodeLine{02150\ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions\ =}
\DoxyCodeLine{02151\ \ \ \ \ \ \ \ \ getPartialLhAtNode(best\_child.getNeighborIndex(}
\DoxyCodeLine{02152\ \ \ \ \ \ \ \ \ \ \ \ \ TOP));\ \ \textcolor{comment}{//\ best\_child-\/>neighbor-\/>getPartialLhAtNode(aln,}}
\DoxyCodeLine{02153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ model,\ threshold\_prob);}}
\DoxyCodeLine{02154\ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions\ =\ best\_child.getPartialLh(}
\DoxyCodeLine{02155\ \ \ \ \ \ \ \ \ TOP);\ \ \textcolor{comment}{//\ -\/>getPartialLhAtNode(aln,\ model,\ threshold\_prob);}}
\DoxyCodeLine{02156\ \ \ \ \ \textcolor{comment}{//\ best\_child\_regions\ =\ new\ SeqRegions(best\_child-\/>mid\_branch\_lh);}}
\DoxyCodeLine{02157\ \ \ \ \ \textcolor{comment}{//\ SeqRegions\ best\_child\_mid\_clone\ =}}
\DoxyCodeLine{02158\ \ \ \ \ \textcolor{comment}{//\ SeqRegions(best\_child.getMidBranchLh());}}
\DoxyCodeLine{02159\ \ \ \ \ best\_child\_regions\ =}
\DoxyCodeLine{02160\ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr};\ \ \textcolor{comment}{//\ std::make\_unique<SeqRegions>(std::move(best\_child\_mid\_clone));}}
\DoxyCodeLine{02161\ }
\DoxyCodeLine{02162\ \ \ \ \ \textcolor{comment}{//\ try\ a\ shorter\ split}}
\DoxyCodeLine{02163\ \ \ \ \ \textcolor{comment}{//\ tryShorterBranch<\&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(best\_child-\/>length,}}
\DoxyCodeLine{02164\ \ \ \ \ \textcolor{comment}{//\ best\_child\_regions,\ sample,\ upper\_left\_right\_regions,\ lower\_regions,}}
\DoxyCodeLine{02165\ \ \ \ \ \textcolor{comment}{//\ best\_child\_lh,\ best\_child\_blength\_split,\ default\_blength,\ true);}}
\DoxyCodeLine{02166\ \ \ \ \ tryShorterBranch<num\_states,}
\DoxyCodeLine{02167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(}
\DoxyCodeLine{02168\ \ \ \ \ \ \ \ \ best\_child.getUpperLength(),\ best\_child\_regions,\ sample,}
\DoxyCodeLine{02169\ \ \ \ \ \ \ \ \ upper\_left\_right\_regions,\ lower\_regions,\ best\_child\_lh,}
\DoxyCodeLine{02170\ \ \ \ \ \ \ \ \ best\_child\_blength\_split,\ default\_blength,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02171\ }
\DoxyCodeLine{02172\ \ \ \ \ \textcolor{comment}{//\ Delay\ cloning\ SeqRegions}}
\DoxyCodeLine{02173\ \ \ \ \ \textcolor{keywordflow}{if}\ (!best\_child\_regions)\ \{}
\DoxyCodeLine{02174\ \ \ \ \ \ \ best\_child\_regions\ =}
\DoxyCodeLine{02175\ \ \ \ \ \ \ \ \ \ \ std::make\_unique<SeqRegions>(SeqRegions(best\_child.getMidBranchLh()));}
\DoxyCodeLine{02176\ \ \ \ \ \}}
\DoxyCodeLine{02177\ \ \ \}}
\DoxyCodeLine{02178\ }
\DoxyCodeLine{02179\ \ \ \textcolor{comment}{//\ if\ node\ is\ root,\ try\ to\ place\ as\ sibling\ of\ the\ current\ root.}}
\DoxyCodeLine{02180\ \ \ RealNumType\ old\_root\_lh\ =\ MIN\_NEGATIVE;}
\DoxyCodeLine{02181\ \ \ \textcolor{keywordflow}{if}\ (root\_vector\_index\ ==\ selected\_node\_vec\_index)\ \{}
\DoxyCodeLine{02182\ \ \ \ \ \textcolor{comment}{/*old\_root\_lh\ =\ selected\_node-\/>getPartialLhAtNode(aln,\ model,}}
\DoxyCodeLine{02183\ \textcolor{comment}{\ \ \ \ threshold\_prob)-\/>computeAbsoluteLhAtRoot(num\_states,\ model);\ SeqRegions*}}
\DoxyCodeLine{02184\ \textcolor{comment}{\ \ \ \ lower\_regions\ =\ selected\_node-\/>getPartialLhAtNode(aln,\ model,}}
\DoxyCodeLine{02185\ \textcolor{comment}{\ \ \ \ threshold\_prob);*/}}
\DoxyCodeLine{02186\ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions\ =}
\DoxyCodeLine{02187\ \ \ \ \ \ \ \ \ selected\_node.getPartialLh(TOP);}
\DoxyCodeLine{02188\ \ \ \ \ old\_root\_lh\ =\ lower\_regions-\/>computeAbsoluteLhAtRoot<num\_states>(}
\DoxyCodeLine{02189\ \ \ \ \ \ \ \ \ model,\ cumulative\_base);}
\DoxyCodeLine{02190\ }
\DoxyCodeLine{02191\ \ \ \ \ \textcolor{comment}{//\ merge\ 2\ lower\ vector\ into\ one}}
\DoxyCodeLine{02192\ \ \ \ \ RealNumType\ new\_root\_lh\ =\ lower\_regions-\/>mergeTwoLowers<num\_states>(}
\DoxyCodeLine{02193\ \ \ \ \ \ \ \ \ best\_parent\_regions,\ default\_blength,\ *sample,\ default\_blength,\ aln,}
\DoxyCodeLine{02194\ \ \ \ \ \ \ \ \ model,\ cumulative\_rate,\ threshold\_prob,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02195\ }
\DoxyCodeLine{02196\ \ \ \ \ new\_root\_lh\ +=\ best\_parent\_regions-\/>computeAbsoluteLhAtRoot<num\_states>(}
\DoxyCodeLine{02197\ \ \ \ \ \ \ \ \ model,\ cumulative\_base);}
\DoxyCodeLine{02198\ \ \ \ \ best\_parent\_lh\ =\ new\_root\_lh;}
\DoxyCodeLine{02199\ }
\DoxyCodeLine{02200\ \ \ \ \ \textcolor{comment}{//\ try\ shorter\ branch\ lengths}}
\DoxyCodeLine{02201\ \ \ \ \ best\_root\_blength\ =\ default\_blength;}
\DoxyCodeLine{02202\ \ \ \ \ tryShorterBranchAtRoot<num\_states>(sample,\ lower\_regions,}
\DoxyCodeLine{02203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ best\_parent\_regions,\ best\_root\_blength,}
\DoxyCodeLine{02204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ best\_parent\_lh,\ default\_blength);}
\DoxyCodeLine{02205\ }
\DoxyCodeLine{02206\ \ \ \ \ \textcolor{comment}{//\ update\ best\_parent\_lh\ (taking\ into\ account\ old\_root\_lh)}}
\DoxyCodeLine{02207\ \ \ \ \ best\_parent\_lh\ -\/=\ old\_root\_lh;}
\DoxyCodeLine{02208\ \ \ \}}
\DoxyCodeLine{02209\ \ \ \textcolor{comment}{//\ selected\_node\ is\ not\ root}}
\DoxyCodeLine{02210\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02211\ \ \ \ \ best\_parent\_lh\ =\ best\_up\_lh\_diff;}
\DoxyCodeLine{02212\ \ \ \ \ best\_parent\_blength\_split\ =}
\DoxyCodeLine{02213\ \ \ \ \ \ \ \ \ 0.5\ *\ selected\_node.getUpperLength();\ \ \textcolor{comment}{//\ selected\_node-\/>length;}}
\DoxyCodeLine{02214\ \ \ \ \ \textcolor{comment}{/*SeqRegions*\ upper\_left\_right\_regions\ =}}
\DoxyCodeLine{02215\ \textcolor{comment}{\ \ \ \ selected\_node-\/>neighbor-\/>getPartialLhAtNode(aln,\ model,\ threshold\_prob);}}
\DoxyCodeLine{02216\ \textcolor{comment}{\ \ \ \ SeqRegions*\ lower\_regions\ =\ selected\_node-\/>getPartialLhAtNode(aln,\ model,}}
\DoxyCodeLine{02217\ \textcolor{comment}{\ \ \ \ threshold\_prob);\ best\_parent\_regions\ =\ new}}
\DoxyCodeLine{02218\ \textcolor{comment}{\ \ \ \ SeqRegions(selected\_node-\/>mid\_branch\_lh);*/}}
\DoxyCodeLine{02219\ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions\ =}
\DoxyCodeLine{02220\ \ \ \ \ \ \ \ \ getPartialLhAtNode(selected\_node.getNeighborIndex(TOP));}
\DoxyCodeLine{02221\ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions\ =}
\DoxyCodeLine{02222\ \ \ \ \ \ \ \ \ selected\_node.getPartialLh(TOP);}
\DoxyCodeLine{02223\ \ \ \ \ \textcolor{comment}{//\ SeqRegions\ seq\_regions\_clone\ =}}
\DoxyCodeLine{02224\ \ \ \ \ \textcolor{comment}{//\ SeqRegions(selected\_node.getMidBranchLh());}}
\DoxyCodeLine{02225\ \ \ \ \ best\_parent\_regions\ =}
\DoxyCodeLine{02226\ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr};\ \ \textcolor{comment}{//\ std::make\_unique<SeqRegions>(std::move(seq\_regions\_clone));}}
\DoxyCodeLine{02227\ }
\DoxyCodeLine{02228\ \ \ \ \ \textcolor{comment}{//\ try\ a\ shorter\ split}}
\DoxyCodeLine{02229\ \ \ \ \ \textcolor{comment}{//\ tryShorterBranch<\&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(selected\_node-\/>length,}}
\DoxyCodeLine{02230\ \ \ \ \ \textcolor{comment}{//\ best\_parent\_regions,\ sample,\ upper\_left\_right\_regions,\ lower\_regions,}}
\DoxyCodeLine{02231\ \ \ \ \ \textcolor{comment}{//\ best\_parent\_lh,\ best\_parent\_blength\_split,\ default\_blength,\ false);}}
\DoxyCodeLine{02232\ \ \ \ \ tryShorterBranch<num\_states,}
\DoxyCodeLine{02233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(}
\DoxyCodeLine{02234\ \ \ \ \ \ \ \ \ selected\_node.getUpperLength(),\ best\_parent\_regions,\ sample,}
\DoxyCodeLine{02235\ \ \ \ \ \ \ \ \ upper\_left\_right\_regions,\ lower\_regions,\ best\_parent\_lh,}
\DoxyCodeLine{02236\ \ \ \ \ \ \ \ \ best\_parent\_blength\_split,\ default\_blength,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02237\ }
\DoxyCodeLine{02238\ \ \ \ \ \textcolor{comment}{//\ Delay\ cloning\ SeqRegions}}
\DoxyCodeLine{02239\ \ \ \ \ \textcolor{keywordflow}{if}\ (!best\_parent\_regions)\ \{}
\DoxyCodeLine{02240\ \ \ \ \ \ \ best\_parent\_regions\ =\ std::make\_unique<SeqRegions>(}
\DoxyCodeLine{02241\ \ \ \ \ \ \ \ \ \ \ SeqRegions(selected\_node.getMidBranchLh()));}
\DoxyCodeLine{02242\ \ \ \ \ \}}
\DoxyCodeLine{02243\ \ \ \}}
\DoxyCodeLine{02244\ }
\DoxyCodeLine{02245\ \ \ \textcolor{comment}{//\ if\ the\ best\ placement\ is\ below\ the\ selected\_node\ =>\ add\ an\ internal\ node}}
\DoxyCodeLine{02246\ \ \ \textcolor{comment}{//\ below\ the\ selected\_node}}
\DoxyCodeLine{02247\ \ \ \textcolor{keywordflow}{if}\ (best\_child\_lh\ >=\ best\_parent\_lh\ \&\&\ best\_child\_lh\ >=\ best\_lh\_diff)\ \{}
\DoxyCodeLine{02248\ \ \ \ \ assert(best\_child\_index.getMiniIndex()\ ==\ TOP);}
\DoxyCodeLine{02249\ \ \ \ \ PhyloNode\&\ best\_child\ =\ nodes[best\_child\_index.getVectorIndex()];}
\DoxyCodeLine{02250\ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions\ =}
\DoxyCodeLine{02251\ \ \ \ \ \ \ \ \ getPartialLhAtNode(best\_child.getNeighborIndex(}
\DoxyCodeLine{02252\ \ \ \ \ \ \ \ \ \ \ \ \ TOP));\ \ \textcolor{comment}{//\ best\_child-\/>neighbor-\/>getPartialLhAtNode(aln,}}
\DoxyCodeLine{02253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ model,\ threshold\_prob);}}
\DoxyCodeLine{02254\ }
\DoxyCodeLine{02255\ \ \ \ \ \textcolor{comment}{//\ Estimate\ the\ length\ for\ the\ new\ branch}}
\DoxyCodeLine{02256\ \ \ \ \ RealNumType\ best\_length\ =\ default\_blength;}
\DoxyCodeLine{02257\ \ \ \ \ estimateLengthNewBranch<}
\DoxyCodeLine{02258\ \ \ \ \ \ \ \ \ \&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(}
\DoxyCodeLine{02259\ \ \ \ \ \ \ \ \ best\_child\_lh,\ best\_child\_regions,\ sample,\ best\_length,\ max\_blength,}
\DoxyCodeLine{02260\ \ \ \ \ \ \ \ \ min\_blength,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02261\ }
\DoxyCodeLine{02262\ \ \ \ \ \textcolor{comment}{//\ create\ new\ internal\ node\ and\ append\ child\ to\ it}}
\DoxyCodeLine{02263\ \ \ \ \ \textcolor{comment}{//\ connectNewSample2Branch(sample,\ seq\_name\_index,\ best\_child,}}
\DoxyCodeLine{02264\ \ \ \ \ \textcolor{comment}{//\ best\_child\_blength\_split,\ best\_child-\/>length\ -\/\ best\_child\_blength\_split,}}
\DoxyCodeLine{02265\ \ \ \ \ \textcolor{comment}{//\ best\_length,\ best\_child\_regions,\ upper\_left\_right\_regions);}}
\DoxyCodeLine{02266\ \ \ \ \ connectNewSample2Branch<num\_states>(}
\DoxyCodeLine{02267\ \ \ \ \ \ \ \ \ sample,\ seq\_name\_index,\ best\_child\_index,\ best\_child,}
\DoxyCodeLine{02268\ \ \ \ \ \ \ \ \ best\_child\_blength\_split,}
\DoxyCodeLine{02269\ \ \ \ \ \ \ \ \ best\_child.getUpperLength()\ -\/\ best\_child\_blength\_split,\ best\_length,}
\DoxyCodeLine{02270\ \ \ \ \ \ \ \ \ best\_child\_regions,\ upper\_left\_right\_regions);}
\DoxyCodeLine{02271\ \ \ \}}
\DoxyCodeLine{02272\ \ \ \textcolor{comment}{//\ otherwise,\ add\ new\ parent\ to\ the\ selected\_node}}
\DoxyCodeLine{02273\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02274\ \ \ \ \ \textcolor{comment}{//\ new\ parent\ is\ actually\ part\ of\ a\ polytomy\ since\ best\ placement\ is\ exactly}}
\DoxyCodeLine{02275\ \ \ \ \ \textcolor{comment}{//\ at\ the\ node}}
\DoxyCodeLine{02276\ \ \ \ \ \textcolor{keywordflow}{if}\ (best\_lh\_diff\ >=\ best\_parent\_lh)\ \{}
\DoxyCodeLine{02277\ \ \ \ \ \ \ best\_root\_blength\ =\ -\/1;}
\DoxyCodeLine{02278\ \ \ \ \ \ \ best\_parent\_blength\_split\ =\ -\/1;}
\DoxyCodeLine{02279\ \ \ \ \ \ \ best\_parent\_lh\ =\ best\_lh\_diff;}
\DoxyCodeLine{02280\ \ \ \ \ \ \ \textcolor{comment}{/*if\ (best\_parent\_regions)\ delete\ best\_parent\_regions;}}
\DoxyCodeLine{02281\ \textcolor{comment}{\ \ \ \ \ \ best\_parent\_regions\ =\ NULL;*/}}
\DoxyCodeLine{02282\ \ \ \ \ \ \ best\_parent\_regions\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02283\ }
\DoxyCodeLine{02284\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (root\_vector\_index\ ==\ selected\_node\_vec\_index)\ \{}
\DoxyCodeLine{02285\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ selected\_node-\/>getPartialLhAtNode(aln,\ model,}}
\DoxyCodeLine{02286\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ threshold\_prob)-\/>mergeTwoLowers<num\_states>(best\_parent\_regions,}}
\DoxyCodeLine{02287\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ -\/1,\ *sample,\ default\_blength,\ aln,\ model,\ threshold\_prob);}}
\DoxyCodeLine{02288\ \ \ \ \ \ \ \ \ selected\_node.getPartialLh(TOP)-\/>mergeTwoLowers<num\_states>(}
\DoxyCodeLine{02289\ \ \ \ \ \ \ \ \ \ \ \ \ best\_parent\_regions,\ -\/1,\ *sample,\ default\_blength,\ aln,\ model,}
\DoxyCodeLine{02290\ \ \ \ \ \ \ \ \ \ \ \ \ cumulative\_rate,\ threshold\_prob);}
\DoxyCodeLine{02291\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02292\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ best\_parent\_regions\ =\ new\ SeqRegions(selected\_node-\/>total\_lh);}}
\DoxyCodeLine{02293\ \ \ \ \ \ \ \ \ SeqRegions\ seq\_regions\_clone\ =\ SeqRegions(selected\_node.getTotalLh());}
\DoxyCodeLine{02294\ \ \ \ \ \ \ \ \ best\_parent\_regions\ =}
\DoxyCodeLine{02295\ \ \ \ \ \ \ \ \ \ \ \ \ std::make\_unique<SeqRegions>(std::move(seq\_regions\_clone));}
\DoxyCodeLine{02296\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02297\ \ \ \ \ \}}
\DoxyCodeLine{02298\ }
\DoxyCodeLine{02299\ \ \ \ \ \textcolor{comment}{//\ add\ parent\ to\ the\ root}}
\DoxyCodeLine{02300\ \ \ \ \ \textcolor{keywordflow}{if}\ (root\_vector\_index\ ==\ selected\_node\_vec\_index)\ \{}
\DoxyCodeLine{02301\ \ \ \ \ \ \ \textcolor{comment}{//\ now\ try\ different\ lengths\ for\ right\ branch}}
\DoxyCodeLine{02302\ \ \ \ \ \ \ best\_parent\_lh\ +=\ old\_root\_lh;}
\DoxyCodeLine{02303\ \ \ \ \ \ \ RealNumType\ best\_length2\ =\ default\_blength;}
\DoxyCodeLine{02304\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions\ =}
\DoxyCodeLine{02305\ \ \ \ \ \ \ \ \ \ \ selected\_node.getPartialLh(}
\DoxyCodeLine{02306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TOP);\ \ \textcolor{comment}{//\ -\/>getPartialLhAtNode(aln,\ model,\ threshold\_prob);}}
\DoxyCodeLine{02307\ }
\DoxyCodeLine{02308\ \ \ \ \ \ \ estimateLengthNewBranchAtRoot<num\_states>(}
\DoxyCodeLine{02309\ \ \ \ \ \ \ \ \ \ \ sample,\ lower\_regions,\ best\_parent\_regions,\ best\_length2,}
\DoxyCodeLine{02310\ \ \ \ \ \ \ \ \ \ \ best\_parent\_lh,\ best\_root\_blength,\ min\_blength,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02311\ }
\DoxyCodeLine{02312\ \ \ \ \ \ \ \textcolor{comment}{//\ update\ best\_parent\_lh\ (taking\ into\ account\ old\_root\_lh)}}
\DoxyCodeLine{02313\ \ \ \ \ \ \ best\_parent\_lh\ -\/=\ old\_root\_lh;}
\DoxyCodeLine{02314\ }
\DoxyCodeLine{02315\ \ \ \ \ \ \ \textcolor{comment}{//\ add\ new\ sample\ to\ a\ new\ root}}
\DoxyCodeLine{02316\ \ \ \ \ \ \ connectNewSample2Root<num\_states>(}
\DoxyCodeLine{02317\ \ \ \ \ \ \ \ \ \ \ sample,\ seq\_name\_index,\ selected\_node\_index,\ selected\_node,}
\DoxyCodeLine{02318\ \ \ \ \ \ \ \ \ \ \ best\_root\_blength,\ best\_length2,\ best\_parent\_regions);}
\DoxyCodeLine{02319\ \ \ \ \ \}}
\DoxyCodeLine{02320\ \ \ \ \ \textcolor{comment}{//\ add\ parent\ to\ non-\/root\ node}}
\DoxyCodeLine{02321\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02322\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions\ =}
\DoxyCodeLine{02323\ \ \ \ \ \ \ \ \ \ \ getPartialLhAtNode(selected\_node.getNeighborIndex(}
\DoxyCodeLine{02324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TOP));\ \ \textcolor{comment}{//\ selected\_node-\/>neighbor-\/>getPartialLhAtNode(aln,}}
\DoxyCodeLine{02325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ model,\ threshold\_prob);}}
\DoxyCodeLine{02326\ }
\DoxyCodeLine{02327\ \ \ \ \ \ \ \textcolor{comment}{//\ now\ try\ different\ lengths\ for\ the\ new\ branch}}
\DoxyCodeLine{02328\ \ \ \ \ \ \ RealNumType\ new\_branch\_length\_lh\ =\ best\_parent\_lh;}
\DoxyCodeLine{02329\ \ \ \ \ \ \ RealNumType\ best\_length\ =\ default\_blength;}
\DoxyCodeLine{02330\ \ \ \ \ \ \ estimateLengthNewBranch<}
\DoxyCodeLine{02331\ \ \ \ \ \ \ \ \ \ \ \&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(}
\DoxyCodeLine{02332\ \ \ \ \ \ \ \ \ \ \ best\_parent\_lh,\ best\_parent\_regions,\ sample,\ best\_length,\ max\_blength,}
\DoxyCodeLine{02333\ \ \ \ \ \ \ \ \ \ \ min\_blength,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02334\ }
\DoxyCodeLine{02335\ \ \ \ \ \ \ \textcolor{comment}{//\ now\ create\ new\ internal\ node\ and\ append\ child\ to\ it}}
\DoxyCodeLine{02336\ \ \ \ \ \ \ RealNumType\ down\_distance\ =\ best\_parent\_blength\_split;}
\DoxyCodeLine{02337\ \ \ \ \ \ \ RealNumType\ top\_distance\ =}
\DoxyCodeLine{02338\ \ \ \ \ \ \ \ \ \ \ selected\_node.getUpperLength()\ -\/}
\DoxyCodeLine{02339\ \ \ \ \ \ \ \ \ \ \ down\_distance;\ \ \textcolor{comment}{//\ selected\_node-\/>length\ -\/\ down\_distance;}}
\DoxyCodeLine{02340\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (best\_parent\_blength\_split\ <\ 0)\ \{}
\DoxyCodeLine{02341\ \ \ \ \ \ \ \ \ down\_distance\ =\ -\/1;}
\DoxyCodeLine{02342\ \ \ \ \ \ \ \ \ top\_distance\ =}
\DoxyCodeLine{02343\ \ \ \ \ \ \ \ \ \ \ \ \ selected\_node.getUpperLength();\ \ \textcolor{comment}{//\ selected\_node-\/>length;}}
\DoxyCodeLine{02344\ }
\DoxyCodeLine{02345\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*if\ (selected\_node-\/>total\_lh)\ delete\ selected\_node-\/>total\_lh;}}
\DoxyCodeLine{02346\ \textcolor{comment}{\ \ \ \ \ \ \ \ selected\_node-\/>total\_lh\ =\ NULL;}}
\DoxyCodeLine{02347\ \textcolor{comment}{}}
\DoxyCodeLine{02348\ \textcolor{comment}{\ \ \ \ \ \ \ \ if\ (selected\_node-\/>mid\_branch\_lh)\ delete\ selected\_node-\/>mid\_branch\_lh;}}
\DoxyCodeLine{02349\ \textcolor{comment}{\ \ \ \ \ \ \ \ selected\_node-\/>mid\_branch\_lh\ =\ NULL;*/}}
\DoxyCodeLine{02350\ \ \ \ \ \ \ \ \ selected\_node.setTotalLh(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{02351\ \ \ \ \ \ \ \ \ selected\_node.setMidBranchLh(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{02352\ }
\DoxyCodeLine{02353\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ node.furtherMidNodes=None}}
\DoxyCodeLine{02354\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02355\ \ \ \ \ \ \ connectNewSample2Branch<num\_states>(}
\DoxyCodeLine{02356\ \ \ \ \ \ \ \ \ \ \ sample,\ seq\_name\_index,\ selected\_node\_index,\ selected\_node,}
\DoxyCodeLine{02357\ \ \ \ \ \ \ \ \ \ \ top\_distance,\ down\_distance,\ best\_length,\ best\_parent\_regions,}
\DoxyCodeLine{02358\ \ \ \ \ \ \ \ \ \ \ upper\_left\_right\_regions);}
\DoxyCodeLine{02359\ \ \ \ \ \}}
\DoxyCodeLine{02360\ \ \ \}}
\DoxyCodeLine{02361\ }
\DoxyCodeLine{02362\ \ \ \textcolor{comment}{//\ delete\ best\_parent\_regions\ and\ best\_child\_regions}}
\DoxyCodeLine{02363\ \ \ \textcolor{comment}{/*if\ (best\_parent\_regions)}}
\DoxyCodeLine{02364\ \textcolor{comment}{\ \ \ \ \ \ delete\ best\_parent\_regions;}}
\DoxyCodeLine{02365\ \textcolor{comment}{\ \ if\ (best\_child\_regions)}}
\DoxyCodeLine{02366\ \textcolor{comment}{\ \ \ \ \ \ delete\ best\_child\_regions;*/}}
\DoxyCodeLine{02367\ \}}
\DoxyCodeLine{02368\ }
\DoxyCodeLine{02369\ \textcolor{keyword}{template}\ <const\ StateType\ num\_states>}
\DoxyCodeLine{02370\ \textcolor{keywordtype}{void}\ cmaple::Tree::placeNewSampleMidBranch(\textcolor{keyword}{const}\ Index\&\ selected\_node\_index,}
\DoxyCodeLine{02371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::unique\_ptr<SeqRegions>\&\ sample,}
\DoxyCodeLine{02372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ NumSeqsType\ seq\_name\_index,}
\DoxyCodeLine{02373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ RealNumType\ best\_lh\_diff)\ \{}
\DoxyCodeLine{02374\ \ \ \textcolor{comment}{//\ dummy\ variables}}
\DoxyCodeLine{02375\ \ \ \textcolor{comment}{//\ const\ RealNumType\ threshold\_prob\ =\ params-\/>threshold\_prob;}}
\DoxyCodeLine{02376\ \ \ std::unique\_ptr<SeqRegions>\ best\_child\_regions\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02377\ }
\DoxyCodeLine{02378\ \ \ \textcolor{comment}{//\ selected\_node-\/>neighbor-\/>getPartialLhAtNode(aln,\ model,\ threshold\_prob);}}
\DoxyCodeLine{02379\ \ \ \textcolor{comment}{//\ const\ MiniIndex\ seleted\_node\_mini\_index\ =}}
\DoxyCodeLine{02380\ \ \ \textcolor{comment}{//\ selected\_node\_index.getMiniIndex();}}
\DoxyCodeLine{02381\ \ \ assert(selected\_node\_index.getMiniIndex()\ ==\ TOP);}
\DoxyCodeLine{02382\ \ \ PhyloNode\&\ selected\_node\ =\ nodes[selected\_node\_index.getVectorIndex()];}
\DoxyCodeLine{02383\ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ upper\_left\_right\_regions\ =}
\DoxyCodeLine{02384\ \ \ \ \ \ \ getPartialLhAtNode(selected\_node.getNeighborIndex(TOP));}
\DoxyCodeLine{02385\ \ \ RealNumType\ best\_split\_lh\ =\ best\_lh\_diff;}
\DoxyCodeLine{02386\ \ \ \textcolor{keyword}{const}\ RealNumType\ selected\_node\_blength\ =\ selected\_node.getUpperLength();}
\DoxyCodeLine{02387\ \ \ RealNumType\ best\_branch\_length\_split\ =\ 0.5\ *\ selected\_node\_blength;}
\DoxyCodeLine{02388\ \ \ best\_child\_regions\ =}
\DoxyCodeLine{02389\ \ \ \ \ \ \ \textcolor{keyword}{nullptr};\ \ \textcolor{comment}{//\ std::make\_unique<SeqRegions>(SeqRegions(selected\_node.getMidBranchLh()));}}
\DoxyCodeLine{02390\ \ \ \textcolor{comment}{//\ selected\_node-\/>getPartialLhAtNode(aln,\ model,\ threshold\_prob);}}
\DoxyCodeLine{02391\ \ \ \textcolor{keyword}{const}\ std::unique\_ptr<SeqRegions>\&\ lower\_regions\ =}
\DoxyCodeLine{02392\ \ \ \ \ \ \ selected\_node.getPartialLh(TOP);}
\DoxyCodeLine{02393\ }
\DoxyCodeLine{02394\ \ \ \textcolor{comment}{//\ try\ different\ positions\ on\ the\ existing\ branch}}
\DoxyCodeLine{02395\ \ \ \textcolor{keywordtype}{bool}\ found\_new\_split\ =}
\DoxyCodeLine{02396\ \ \ \ \ \ \ tryShorterBranch<num\_states,}
\DoxyCodeLine{02397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(}
\DoxyCodeLine{02398\ \ \ \ \ \ \ \ \ \ \ selected\_node\_blength,\ best\_child\_regions,\ sample,}
\DoxyCodeLine{02399\ \ \ \ \ \ \ \ \ \ \ upper\_left\_right\_regions,\ lower\_regions,\ best\_split\_lh,}
\DoxyCodeLine{02400\ \ \ \ \ \ \ \ \ \ \ best\_branch\_length\_split,\ default\_blength,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02401\ }
\DoxyCodeLine{02402\ \ \ \textcolor{keywordflow}{if}\ (!found\_new\_split)\ \{}
\DoxyCodeLine{02403\ \ \ \ \ \textcolor{comment}{//\ try\ on\ the\ second\ branch}}
\DoxyCodeLine{02404\ \ \ \ \ found\_new\_split\ =\ tryShorterBranch<}
\DoxyCodeLine{02405\ \ \ \ \ \ \ \ \ num\_states,\ \&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(}
\DoxyCodeLine{02406\ \ \ \ \ \ \ \ \ selected\_node\_blength,\ best\_child\_regions,\ sample,}
\DoxyCodeLine{02407\ \ \ \ \ \ \ \ \ upper\_left\_right\_regions,\ lower\_regions,\ best\_split\_lh,}
\DoxyCodeLine{02408\ \ \ \ \ \ \ \ \ best\_branch\_length\_split,\ default\_blength,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02409\ }
\DoxyCodeLine{02410\ \ \ \ \ \textcolor{keywordflow}{if}\ (found\_new\_split)\ \{}
\DoxyCodeLine{02411\ \ \ \ \ \ \ best\_branch\_length\_split\ =}
\DoxyCodeLine{02412\ \ \ \ \ \ \ \ \ \ \ selected\_node\_blength\ -\/\ best\_branch\_length\_split;}
\DoxyCodeLine{02413\ \ \ \ \ \}}
\DoxyCodeLine{02414\ \ \ \}}
\DoxyCodeLine{02415\ }
\DoxyCodeLine{02416\ \ \ \textcolor{comment}{//\ Delay\ cloning\ SeqRegions}}
\DoxyCodeLine{02417\ \ \ \textcolor{keywordflow}{if}\ (!best\_child\_regions)\ \{}
\DoxyCodeLine{02418\ \ \ \ \ best\_child\_regions\ =\ std::make\_unique<SeqRegions>(}
\DoxyCodeLine{02419\ \ \ \ \ \ \ \ \ SeqRegions(selected\_node.getMidBranchLh()));}
\DoxyCodeLine{02420\ \ \ \}}
\DoxyCodeLine{02421\ }
\DoxyCodeLine{02422\ \ \ \textcolor{comment}{//\ now\ try\ different\ lengths\ for\ the\ new\ branch}}
\DoxyCodeLine{02423\ \ \ RealNumType\ best\_blength\ =\ default\_blength;}
\DoxyCodeLine{02424\ \ \ estimateLengthNewBranch<}
\DoxyCodeLine{02425\ \ \ \ \ \ \ \&cmaple::Tree::calculateSamplePlacementCost<num\_states>>(}
\DoxyCodeLine{02426\ \ \ \ \ \ \ best\_split\_lh,\ best\_child\_regions,\ sample,\ best\_blength,\ max\_blength,}
\DoxyCodeLine{02427\ \ \ \ \ \ \ min\_blength,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02428\ }
\DoxyCodeLine{02429\ \ \ \textcolor{comment}{//\ create\ new\ internal\ node\ and\ append\ child\ to\ it}}
\DoxyCodeLine{02430\ \ \ connectNewSample2Branch<num\_states>(}
\DoxyCodeLine{02431\ \ \ \ \ \ \ sample,\ seq\_name\_index,\ selected\_node\_index,\ selected\_node,}
\DoxyCodeLine{02432\ \ \ \ \ \ \ best\_branch\_length\_split,}
\DoxyCodeLine{02433\ \ \ \ \ \ \ selected\_node\_blength\ -\/\ best\_branch\_length\_split,\ best\_blength,}
\DoxyCodeLine{02434\ \ \ \ \ \ \ best\_child\_regions,\ upper\_left\_right\_regions);}
\DoxyCodeLine{02435\ \}}
\DoxyCodeLine{02437\ \}\ \ \textcolor{comment}{//\ namespace\ cmaple}}

\end{DoxyCode}
